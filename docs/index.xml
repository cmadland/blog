<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Learning | Assessment | Technology</title>
<link>https://cmadland.github.io/blog/</link>
<atom:link href="https://cmadland.github.io/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Colin Madland thinks in public.</description>
<generator>quarto-1.6.8</generator>
<lastBuildDate>Sun, 18 May 2025 07:00:00 GMT</lastBuildDate>
<item>
  <title>SIDS Ch 3 - Data Wrangling</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/sids-02/</link>
  <description><![CDATA[ 





<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Ismay, C., Kim, A. Y., &amp; Valdivia, A. (2025). <a href="https://moderndive.com/v2/">Statistical Inference via Data Science: A ModernDive into R and the Tidyverse (2nd ed.)</a>. Chapman and Hall/CRC.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(nycflights23)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(moderndive)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(viridis)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<section id="components-of-the-grammar-or-graphiics" class="level2">
<h2 class="anchored" data-anchor-id="components-of-the-grammar-or-graphiics">3 components of the Grammar or Graphiics</h2>
<ul>
<li><code>data</code>: the dataset containing the variables of interest.</li>
<li><code>geom</code>: the geometric object in question. This refers to the type of object we can observe in a plot. For example: points, lines, and bars.</li>
<li><code>aes</code>: aesthetic attributes of the geometric object. For example, x/y position, color, shape, and size. Aesthetic attributes are mapped to variables in the dataset.</li>
</ul>
<section id="other-components" class="level3">
<h3 class="anchored" data-anchor-id="other-components">Other components</h3>
<ul>
<li><code>facet</code> to break up a plot into several plots split by the values of another variable (Section 2.6)</li>
<li>position adjustments for barplots (Section 2.8)</li>
</ul>
</section>
<section id="five-named-graphs---5ng" class="level3">
<h3 class="anchored" data-anchor-id="five-named-graphs---5ng">Five Named graphs - 5NG</h3>
<ol type="1">
<li>Scatterplots</li>
<li>line graphs</li>
<li>bar graphs</li>
<li>histograms</li>
<li>boxplots</li>
</ol>
<section id="scatterplots" class="level4">
<h4 class="anchored" data-anchor-id="scatterplots">Scatterplots</h4>
<p>Used to see the relationship between two numerical variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(envoy_flights)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> envoy_flights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> dep_delay, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> arr_delay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>there is a problem of the points overlapping
<ul>
<li>change transparency with <code>alpha</code> argument</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> envoy_flights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> dep_delay, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> arr_delay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>add jitter</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> envoy_flights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> dep_delay, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> arr_delay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linegraphs" class="level4">
<h4 class="anchored" data-anchor-id="linegraphs">Linegraphs</h4>
<p>Show the relationship between two variables when the x-axis (explanatory variable) is sequential.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(weather)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(weather)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 26,207
Columns: 15
$ origin     &lt;chr&gt; "JFK", "JFK", "JFK", "JFK", "JFK", "JFK", "JFK", "JFK", "JF…
$ year       &lt;int&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023,…
$ month      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ day        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ hour       &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ temp       &lt;dbl&gt; 48.0, 48.2, 49.0, 49.0, 49.0, 48.0, 46.4, 46.0, 48.0, 47.0,…
$ dewp       &lt;dbl&gt; 48.0, 48.2, 49.0, 49.0, 49.0, 48.0, 46.4, 46.0, 48.0, 47.0,…
$ humid      &lt;dbl&gt; 100.00, 100.00, 100.00, 100.00, 100.00, 100.00, 100.00, 100…
$ wind_dir   &lt;dbl&gt; 0, 190, 190, 250, 170, 0, 250, 230, 260, 250, 240, 260, 260…
$ wind_speed &lt;dbl&gt; 0.00000, 4.60312, 5.75390, 5.75390, 8.05546, 0.00000, 9.206…
$ wind_gust  &lt;dbl&gt; 0.000000, 5.297178, 6.621473, 6.621473, 9.270062, 0.000000,…
$ precip     &lt;dbl&gt; 1e-02, 1e-02, 1e-04, 2e-02, 1e-04, 1e-04, 0e+00, 0e+00, 0e+…
$ pressure   &lt;dbl&gt; 1010.2, 1009.2, 1009.0, 1008.0, 1007.8, 1007.6, 1007.3, 100…
$ visib      &lt;dbl&gt; 0.25, 2.50, 0.25, 4.00, 0.75, 0.75, 0.24, 0.50, 8.00, 5.00,…
$ time_hour  &lt;dttm&gt; 2023-01-01 00:00:00, 2023-01-01 01:00:00, 2023-01-01 02:00…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> early_january_2023_weather, </span>
<span id="cb17-2">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time_hour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms" class="level4">
<h4 class="anchored" data-anchor-id="histograms">Histograms</h4>
<p>Shows the distribution of a variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="adjusting-bins" class="level5">
<h5 class="anchored" data-anchor-id="adjusting-bins">adjusting bins</h5>
<ul>
<li>number of bins</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>binwidth</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="facets" class="level4">
<h4 class="anchored" data-anchor-id="facets">Facets</h4>
<p>Dividing plots by subcategories in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> month)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplots" class="level4">
<h4 class="anchored" data-anchor-id="boxplots">Boxplots</h4>
<p>Display the distribution of data and include five numbers to summarize the data:</p>
<ul>
<li>minimum</li>
<li>first quartile (25th percentile)</li>
<li>median (2nd quartile, 50th percentile)</li>
<li>third quartile (75th percentile)</li>
<li>maximum</li>
<li>also shows the IQR (middle 50%)
<ul>
<li>whiskers extend no more than 1.5 IQR units beyond 25th and 75 percentile.</li>
<li>points beyond 1.5 IQR units may be considered outliers.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> month, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Continuous x aesthetic
ℹ did you forget `aes(group = ...)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Returns an invalid plot and a warning.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> month, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> wind_speed, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> month)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>OR</p>
<ul>
<li>represent months as factors and use <code>geom(violin)</code> for a more detailed plot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> weather, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(month), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> wind_speed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1041 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="barplots" class="level4">
<h4 class="anchored" data-anchor-id="barplots">Barplots</h4>
<p>Simpler representation of the distribution known as <code>frequencxies</code> - depends on whether the items are counted or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">fruits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fruit =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>))</span>
<span id="cb37-2">fruits_counted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb37-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fruit =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>),</span>
<span id="cb37-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> fruits, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> fruit)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> fruits_counted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> fruit)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> fruits_counted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> fruit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> number)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>when items are not counted, use <code>geom_bar()</code> with <code>fruit</code> mapped to the x <code>aes</code></li>
<li>when items are counted, we add <code>number</code> to the y <code>aes</code> and use <code>geom_col()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(flights,  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> carrier)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>geom_histogram()</code> has bars that touch, but <code>geom_bar()</code> has bars with white space between</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(airlines)</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://moderndive.com/v2/viz.html#must-avoid-pie-charts">The best pie-chart is a bar-chart.</a></p>
</div>
</div>
<section id="stacked-barplot" class="level5">
<h5 class="anchored" data-anchor-id="stacked-barplot">Stacked Barplot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> flights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> carrier, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> origin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dodged-barplot" class="level5">
<h5 class="anchored" data-anchor-id="dodged-barplot">Dodged Barplot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> flights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> carrier, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> origin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodge"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plasma"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/sids-02/index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Named graph</th>
<th style="text-align: center;">Shows</th>
<th>Geometric object</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Scatterplot</td>
<td>Relationship between 2 numerical variables geom_point()</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Linegraph</td>
<td>Relationship between 2 numerical variables geom_line()</td>
<td>Used when there is a sequential order to x-variable, e.g., time</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Histogram</td>
<td>Distribution of 1 numerical variable geom_histogram()</td>
<td>Facetted histograms show the distribution of 1 numerical variable split by the values of another variable</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">Boxplot</td>
<td>Distribution of 1 numerical variable split by the values of another variable geom_boxplot()</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">Barplot</td>
<td>Distribution of 1 categorical variable geom_bar() when counts are not pre-counted, geom_col() when counts are pre-counted</td>
<td>Stacked, side-by-side, and faceted barplots show the joint distribution of 2 categorical variables</td>
</tr>
</tbody>
</table>
<!-- ```{r viz-summary-table, echo=FALSE, message=FALSE, purl=FALSE}
# The following Google Doc is published to CSV and loaded using read_csv():
# https://docs.google.com/spreadsheets/d/1vzqlFiT6qm5wzy_L_0nL7EWAd6jiUZmLSCFhDhztDSg/edit#gid=0

if (!file.exists("rds/summary_table_ch2-v2.rds")) {
  summary_table_ch3 <-
    "https://docs.google.com/spreadsheets/d/e/2PACX-1vRGaUW6EMIGPhg2V7CahoSdVi_JCcESFRYV5tov6bjcwOcn7DZDzfpZgrvjfFG6PV57gcJYIrwl_Q2c/pub?gid=0&single=true&output=csv" |>
    read_csv(na = "")
  summary_table_ch3$Notes[2] <- "Used when there is a sequential order to x-variable, e.g., time"
  write_rds(summary_table_ch3, "rds/summary_table_ch2-v2.rds")
} else {
  summary_table_ch2 <- read_rds("rds/summary_table_ch2-v2.rds") |>
    rename(` ` = `...1`)
}

if (is_latex_output()) {
  summary_table_ch2 |>
    # Weird tick marks show up in PDF:
    mutate(`Geometric object` = str_replace_all(`Geometric object`, "`", "")) |>
    kbl(
      caption = "Summary of Five Named Graphs",
      booktabs = TRUE,
      format = "latex",
      linesep = ""
    ) |>
    kable_styling(font_size = 10) |>
    column_spec(3, width = "1.1in") |>
    column_spec(4, width = "1.2in") |>
    column_spec(5, width = "1.6in")
} else {
  summary_table_ch2 |>
    kable(
      caption = "Summary of Five Named Graphs",
      booktabs = TRUE,
      format = "html"
    )
}
``` -->


</section>

 ]]></description>
  <category>tidyverse</category>
  <category>R</category>
  <guid>https://cmadland.github.io/blog/posts/sids-02/</guid>
  <pubDate>Sun, 18 May 2025 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/sids-02/gloom.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>SIDS Ch 2 - Data Viz</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/sids-03/</link>
  <description><![CDATA[ 





<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Ismay, C., Kim, A. Y., &amp; Valdivia, A. (2025). <a href="https://moderndive.com/v2/">Statistical Inference via Data Science: A ModernDive into R and the Tidyverse (2nd ed.)</a>. Chapman and Hall/CRC.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(nycflights23)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(viridis)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<section id="wrangling-data" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-data">Wrangling data</h2>
<ul>
<li><code>filter()</code> a data frame’s existing rows to only pick out a subset of them. For example, the alaska_flights data frame.</li>
<li><code>summarize()</code> one or more of its columns/variables with a summary statistic. Examples of summary statistics include the median and interquartile range of temperatures as we saw in Section 2.7 on boxplots.</li>
<li><code>group_by()</code> its rows. In other words, assign different rows to be part of the same group. We can then combine <code>group_by()</code> with <code>summarize()</code> to report summary statistics for each group separately. For example, say you don’t want a single overall average departure delay <code>dep_delay</code> for all three origin airports combined, but rather three separate average departure delays, one computed for each of the three origin airports.</li>
<li><code>mutate()</code> its existing columns/variables to create new ones. For example, convert hourly temperature readings from Fahrenheit to Celsius.</li>
<li><code>arrange()</code> its rows. For example, sort the rows of weather in ascending or descending order of temp.</li>
<li><code>join()</code> it with another data frame by matching along a “key” variable. In other words, merge these two data frames together.</li>
</ul>
</section>
<section id="piper-down-r-down" class="level2">
<h2 class="anchored" data-anchor-id="piper-down-r-down">Piper DOWN!! <code>|&gt;r</code> DOWN!</h2>
<ul>
<li>the <code>|&gt;</code> was introduced to R in 2021 to replace the clumsy <code>%&gt;%</code></li>
<li>allows users to create a sequence of operations within one set of instructions</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>Take x then</li>
<li>Use x as an input to a function f() then</li>
<li>Use the output of f(x) as an input to a function g() then</li>
<li>Use the output of g(f(x)) as an input to a function h()</li>
</ul>
</div>
</div>
</div>
<p>One way is to nest parentheses…</p>
<p><code>h(g(f(x)))</code></p>
<p>Not hard to read as there are only 3 simple arguments, but this quickly gets out of hand with many complex arguments…so…</p>
<pre><code>x |&gt; 
  f() |&gt; 
  g() |&gt; 
  h()</code></pre>
<p>The pipe takes the output of one function an ‘pipes’ it into the next function as an argument.</p>


</section>

 ]]></description>
  <category>tidyverse</category>
  <category>R</category>
  <guid>https://cmadland.github.io/blog/posts/sids-03/</guid>
  <pubDate>Sun, 18 May 2025 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/sids-03/sails.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>SIDS Ch 1</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/sids-01/</link>
  <description><![CDATA[ 





<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Ismay, C., Kim, A. Y., &amp; Valdivia, A. (2025). <a href="https://moderndive.com/v2/">Statistical Inference via Data Science: A ModernDive into R and the Tidyverse (2nd ed.)</a>. Chapman and Hall/CRC.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(nycflights23)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">flights</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 435,352 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2023     1     1        1           2038       203      328              3
 2  2023     1     1       18           2300        78      228            135
 3  2023     1     1       31           2344        47      500            426
 4  2023     1     1       33           2140       173      238           2352
 5  2023     1     1       36           2048       228      223           2252
 6  2023     1     1      503            500         3      808            815
 7  2023     1     1      520            510        10      948            949
 8  2023     1     1      524            530        -6      645            710
 9  2023     1     1      537            520        17      926            818
10  2023     1     1      547            545         2      845            852
# ℹ 435,342 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(flights)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 435,352
Columns: 19
$ year           &lt;int&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2…
$ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ dep_time       &lt;int&gt; 1, 18, 31, 33, 36, 503, 520, 524, 537, 547, 549, 551, 5…
$ sched_dep_time &lt;int&gt; 2038, 2300, 2344, 2140, 2048, 500, 510, 530, 520, 545, …
$ dep_delay      &lt;dbl&gt; 203, 78, 47, 173, 228, 3, 10, -6, 17, 2, -10, -9, -7, -…
$ arr_time       &lt;int&gt; 328, 228, 500, 238, 223, 808, 948, 645, 926, 845, 905, …
$ sched_arr_time &lt;int&gt; 3, 135, 426, 2352, 2252, 815, 949, 710, 818, 852, 901, …
$ arr_delay      &lt;dbl&gt; 205, 53, 34, 166, 211, -7, -1, -25, 68, -7, 4, -13, -14…
$ carrier        &lt;chr&gt; "UA", "DL", "B6", "B6", "UA", "AA", "B6", "AA", "UA", "…
$ flight         &lt;int&gt; 628, 393, 371, 1053, 219, 499, 996, 981, 206, 225, 800,…
$ tailnum        &lt;chr&gt; "N25201", "N830DN", "N807JB", "N265JB", "N17730", "N925…
$ origin         &lt;chr&gt; "EWR", "JFK", "JFK", "JFK", "EWR", "EWR", "JFK", "EWR",…
$ dest           &lt;chr&gt; "SMF", "ATL", "BQN", "CHS", "DTW", "MIA", "BQN", "ORD",…
$ air_time       &lt;dbl&gt; 367, 108, 190, 108, 80, 154, 192, 119, 258, 157, 164, 1…
$ distance       &lt;dbl&gt; 2500, 760, 1576, 636, 488, 1085, 1576, 719, 1400, 1065,…
$ hour           &lt;dbl&gt; 20, 23, 23, 21, 20, 5, 5, 5, 5, 5, 5, 6, 5, 6, 6, 6, 6,…
$ minute         &lt;dbl&gt; 38, 0, 44, 40, 48, 0, 10, 30, 20, 45, 59, 0, 59, 0, 0, …
$ time_hour      &lt;dttm&gt; 2023-01-01 20:00:00, 2023-01-01 23:00:00, 2023-01-01 2…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">airlines</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
   carrier name                  
   &lt;chr&gt;   &lt;chr&gt;                 
 1 9E      Endeavor Air Inc.     
 2 AA      American Airlines Inc.
 3 AS      Alaska Airlines Inc.  
 4 B6      JetBlue Airways       
 5 DL      Delta Air Lines Inc.  
 6 F9      Frontier Airlines Inc.
 7 G4      Allegiant Air         
 8 HA      Hawaiian Airlines Inc.
 9 MQ      Envoy Air             
10 NK      Spirit Air Lines      
11 OO      SkyWest Airlines Inc. 
12 UA      United Air Lines Inc. 
13 WN      Southwest Airlines Co.
14 YX      Republic Airline      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(airlines)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">9E</td>
<td style="text-align: left;">Endeavor Air Inc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">AA</td>
<td style="text-align: left;">American Airlines Inc.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AS</td>
<td style="text-align: left;">Alaska Airlines Inc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">B6</td>
<td style="text-align: left;">JetBlue Airways</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DL</td>
<td style="text-align: left;">Delta Air Lines Inc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">F9</td>
<td style="text-align: left;">Frontier Airlines Inc.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">G4</td>
<td style="text-align: left;">Allegiant Air</td>
</tr>
<tr class="even">
<td style="text-align: left;">HA</td>
<td style="text-align: left;">Hawaiian Airlines Inc.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MQ</td>
<td style="text-align: left;">Envoy Air</td>
</tr>
<tr class="even">
<td style="text-align: left;">NK</td>
<td style="text-align: left;">Spirit Air Lines</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OO</td>
<td style="text-align: left;">SkyWest Airlines Inc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">UA</td>
<td style="text-align: left;">United Air Lines Inc.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WN</td>
<td style="text-align: left;">Southwest Airlines Co.</td>
</tr>
<tr class="even">
<td style="text-align: left;">YX</td>
<td style="text-align: left;">Republic Airline</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">airlines<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Endeavor Air Inc."      "American Airlines Inc." "Alaska Airlines Inc."  
 [4] "JetBlue Airways"        "Delta Air Lines Inc."   "Frontier Airlines Inc."
 [7] "Allegiant Air"          "Hawaiian Airlines Inc." "Envoy Air"             
[10] "Spirit Air Lines"       "SkyWest Airlines Inc."  "United Air Lines Inc." 
[13] "Southwest Airlines Co." "Republic Airline"      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(airports)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,255
Columns: 8
$ faa   &lt;chr&gt; "AAF", "AAP", "ABE", "ABI", "ABL", "ABQ", "ABR", "ABY", "ACK", "…
$ name  &lt;chr&gt; "Apalachicola Regional Airport", "Andrau Airpark", "Lehigh Valle…
$ lat   &lt;dbl&gt; 29.72750, 29.72250, 40.65210, 32.41130, 67.10630, 35.04020, 45.4…
$ lon   &lt;dbl&gt; -85.02750, -95.58830, -75.44080, -99.68190, -157.85699, -106.609…
$ alt   &lt;dbl&gt; 20, 79, 393, 1791, 334, 5355, 1302, 197, 47, 516, 221, 75, 18, 7…
$ tz    &lt;dbl&gt; -5, -6, -5, -6, -9, -7, -6, -5, -5, -6, -8, -5, -10, -6, -9, -6,…
$ dst   &lt;chr&gt; "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A",…
$ tzone &lt;chr&gt; "America/New_York", "America/Chicago", "America/New_York", "Amer…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">?flights</span></code></pre></div>
</div>



 ]]></description>
  <category>tidyverse</category>
  <category>R</category>
  <guid>https://cmadland.github.io/blog/posts/sids-01/</guid>
  <pubDate>Fri, 16 May 2025 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/sids-01/sunrise.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Colo(u)rs &amp; Themes</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-06/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 6</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)  </span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install &amp; load ggthemes</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.4     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create example data</span></span>
<span id="cb4-2">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)),</span>
<span id="cb4-3">                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)),</span>
<span id="cb4-4">                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)),</span>
<span id="cb4-5">                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)),</span>
<span id="cb4-6">                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>))),</span>
<span id="cb4-7">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(my_data)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot without color</span></span>
<span id="cb6-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb6-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb6-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">my_ggp1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Default colors</span></span>
<span id="cb7-2">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb7-3">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb7-4">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-6">my_ggp1</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change colors</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, </span>
<span id="cb8-3">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, </span>
<span id="cb8-4">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, </span>
<span id="cb8-5">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F0E442"</span>, </span>
<span id="cb8-6">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#D55E00"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Discrete color palettes</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set2"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set3"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">my_ggp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Default scatter plot</span></span>
<span id="cb12-2">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb12-3">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb12-4">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb12-6">my_ggp2 </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Continuous color palettes</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom color ranges</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, </span>
<span id="cb16-3">                                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#D55E00"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, </span>
<span id="cb17-3">                                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F0E442"</span>, </span>
<span id="cb17-4">                                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#D55E00"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change theme colors</span></span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgray"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panel background</span></span>
<span id="cb18-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aliceblue"</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot background</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Border color</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deepskyblue3"</span>,</span>
<span id="cb19-3">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot2 themes</span></span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dark</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Themes by ggthemes</span></span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_calc</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gdocs</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_economist</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-06/index_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Exercises In this module, we will work with the CO2 data set, which contains measurements of carbon dioxide uptake in grass plants under different conditions. To prepare, we will install and load the ggplot2 package and load the CO2 data set. This data set provides both numeric and categorical variables, making it ideal for exploring different colors and themes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(CO2)             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load example data</span></span></code></pre></div>
</div>
<p>Now, let’s move on to the exercises for this module:</p>
<ul>
<li>Create a bar plot mapping Plant to the x-axis and uptake to the y-axis, using the fill aesthetic to assign default colors for each plant. Save the plot as my_ggp1 and display it.</li>
<li>Modify the bar plot my_ggp1 by changing the fill colors manually using scale_fill_manual(). Note that, in contrast to the lecture script, we use scale_fill_manual() instead of scale_color_manual() as we are now using the fill argument within the aes() function. Assign “orange” to Qn1 and “red” to Mn1.</li>
<li>Apply a discrete color palette using scale_fill_brewer() with the palette Set3.</li>
<li>Create a scatter plot mapping conc to the x-axis and uptake to the y-axis, using color to represent conc. Save the plot as my_ggp2 and display it.</li>
<li>Modify the scatter plot my_ggp2 by applying a continuous color palette using scale_color_viridis_c() with the option C.</li>
<li>Enhance the scatter plot my_ggp2 by applying the theme_bw() theme.</li>
<li>Install and load the ggthemes package, then apply the theme_economist() to my_ggp2.</li>
</ul>



 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <category>colour</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-06/</guid>
  <pubDate>Sat, 08 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-06/cold-lake.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Multiplot Layouts Using Facets</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-05/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 5</a></p>
<ul>
<li>Load ggplot2 and set a random seed</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.4     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">91755</span>)                                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seed for reproducibility</span></span></code></pre></div>
</div>
<ul>
<li>Generate synthetic dataset</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create synthetic data</span></span>
<span id="cb4-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb4-3">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb4-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-5">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x</span></code></pre></div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create dataframe called <code>my_data</code> and create 3 groups and 4 subgroups</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb5-2">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb5-3">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb5-4">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subgroup =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(letters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(my_data)</span></code></pre></div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create scatterplot with each group a different colour</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatterplot without facets</span></span>
<span id="cb6-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb6-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb6-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create multiplot with each group as a facet and displayed in a different subplot,</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Multiplot using facet_wrap</span></span>
<span id="cb7-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb7-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create multiplot with groups and subgroups as facets.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Two grouping variables</span></span>
<span id="cb8-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb8-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> subgroup)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create multiplot using the <code>facet_grid</code> function</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using facet_grid</span></span>
<span id="cb9-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb9-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> subgroup)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Same, but switch <code>group</code> and <code>subgroup</code> in the function.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using facet_grid</span></span>
<span id="cb10-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb10-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(subgroup <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Add colour</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapping colors</span></span>
<span id="cb11-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb11-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb11-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(subgroup <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Add regression lines</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add layers to facets</span></span>
<span id="cb12-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb12-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb12-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(subgroup <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>In this module, we will continue working with the airquality data set and introduce a new variable for grouping days into specific ranges. To prepare, we will install and load the <code>dplyr</code> and <code>ggplot2</code> packages, convert the <code>Month</code> column to a <code>factor</code> class, and create a new factor variable <code>DayRange</code> that categorizes the <code>Day</code> column into ranges: &lt;=10, 11-20, and &gt;20.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(airquality)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load example data</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert Month to factor</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">airquality <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> airquality <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Day ranges</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">DayRange =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(Day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;=10"</span>,</span>
<span id="cb16-3">                                     Day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"11-20"</span>,</span>
<span id="cb16-4">                                     Day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;20"</span>)))</span></code></pre></div>
</div>
<p>Let’s now proceed with the exercises for this module:</p>
<ul>
<li>Create a scatter plot mapping Wind to the x-axis and Temp to the y-axis. Use facet_wrap() to create separate panels for each Month.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb17-2">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Wind,</span>
<span id="cb17-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Month)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Extend the scatter plot by using facet_grid() to create a grid of plots with DayRange on the rows and Month on the columns.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb18-2">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Wind,</span>
<span id="cb18-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(DayRange <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Month)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Add the col aesthetic to map Month to colors in the scatter plot, while maintaining the grid layout with facet_grid().</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb19-2">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Wind,</span>
<span id="cb19-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp,</span>
<span id="cb19-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Month)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(DayRange <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Month)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-05/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <category>facets</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-05/</guid>
  <pubDate>Sat, 18 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-05/kigali-family.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Validity is more important than cheating</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/cheating-validity/</link>
  <description><![CDATA[ 





<p>Philip Dawson, Margaret Bearman, Mollie Dollinger, and David Boud <span class="citation" data-cites="dawsonValidityMattersMore2024">(Dawson et al., 2024)</span> recently published an excellent article addressing cheating in higher education assessment. The main premiss is that modern conceptualizations of cheating, namely that cheating is unfair and that it harms learning, are inadequate to justify the measures we take to prevent cheating. The ‘unfairness’ argument is essentially that cheating is wrong because the cheater gains an unfair advantage over their peers. This argument doesn’t add up to much because most HEI don’t use norm-referenced grading where learners are compared to each other, so grades are not a zero-sum game. One learner’s achievement does not affect another’s. The other argument, that cheating harms the cheater’s learning is inadequate because cheating is only one of myriad actions learners take that harm their learning without the threat of significant sanction from the university or instructor. For example, we don’t assign failing grades to learners who are not adequately rested, fed, and hydrated, all of which can harm a learner’s ability to learn.</p>
<p>Further, the authors argue that modern approaches to responding to cheating (cop shit) inappropriately centre the locus of the problem on learners and impugn their character, rather than seeking to frame cheating as an issue with multiple sources of control.</p>
<p>Instead of the typical approach and framing, the authors argue that cheating is problematic primarily because it harms assessment validity. In the common understanding of validity, that the assessment task measures what it is intended to measure, cheating results in the loss of confidence that an assessment task has measured, or says anything at all, about a learner’s ability in relation to an outcome. What follows from this is that the appropriate response to the learner is that they have not yet demonstrated their ability to meet the outcome, therefore cannot receive credit. The remedy, then is that they need to provide evidence that they have met the outcome. The authors explain that this approach removes the impetus to assign moral blame to the learner, leading to punishment. Rather this approach is simply the work of assessment, at least initially. If it becomes clear that there is a pattern of repeated behaviour, sanctions may become necessary.</p>
<hr>
<section id="conversations" class="level4">
<h4 class="anchored" data-anchor-id="conversations">Conversations</h4>
<bluesky-comments-section post="{https://bsky.app/profile/cmad.land/post/3lfphteqqck2d}"></bluesky-comments-section>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-dawsonValidityMattersMore2024" class="csl-entry">
Dawson, P., Bearman, M., Dollinger, M., &amp; Boud, D. (2024). Validity matters more than cheating. <em>Assessment &amp; Evaluation in Higher Education</em>, 1–12. <a href="https://doi.org/10.1080/02602938.2024.2386662">https://doi.org/10.1080/02602938.2024.2386662</a>
</div>
</div></section></div> ]]></description>
  <category>cheating</category>
  <category>acadmic integrity</category>
  <category>validity</category>
  <category>standards-based-grading</category>
  <guid>https://cmadland.github.io/blog/posts/cheating-validity/</guid>
  <pubDate>Tue, 14 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/cheating-validity/japanese-garden.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>layered plotting</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-04/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 4</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(ToothGrowth) </span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(ToothGrowth)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   60 obs. of  3 variables:
 $ len : num  4.2 11.5 7.3 5.8 6.4 10 11.2 11.2 5.2 7 ...
 $ supp: Factor w/ 2 levels "OJ","VC": 2 2 2 2 2 2 2 2 2 2 ...
 $ dose: num  0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(airquality)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(ToothGrowth)                                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load example data</span></span>
<span id="cb4-2"> </span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic Boxplot</span></span>
<span id="cb4-4">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp,</span>
<span id="cb4-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Add a layer of data points to the boxplot layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overlay jittered points</span></span>
<span id="cb5-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp,</span>
<span id="cb5-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-6">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1b98e0"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">my_ggp1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save plot in data object</span></span>
<span id="cb6-2">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp,</span>
<span id="cb6-3">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span>
<span id="cb6-5">my_ggp1                                                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw plot in data object</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Add a layer to the plot object…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add layer to data object</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb7-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1b98e0"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Save as new object…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">my_ggp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_ggp1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create new data object</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb8-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1b98e0"</span>)</span>
<span id="cb8-4">my_ggp2   </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Adding different layer types</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">my_ggp2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Different layer types</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean, </span>
<span id="cb9-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>, </span>
<span id="cb9-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, </span>
<span id="cb9-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb9-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb9-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb9-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">34</span>,</span>
<span id="cb9-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plot with different layer types!"</span>,</span>
<span id="cb9-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>In this module, we will build on the airquality data set introduced earlier. To prepare, we will install and load the ggplot2 package, convert the Month column to a factor class to use it as a categorical variable, and set a random seed for reproducibility.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert Month to factor</span></span></code></pre></div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Create a boxplot mapping the Month column to the x-axis and the Temp column to the y-axis. Save the plot as a data object named my_ggp3 and display the plot.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">my_ggp3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(airquality,</span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Month,</span>
<span id="cb11-3">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span>
<span id="cb11-5">my_ggp3</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Enhance the plot stored in my_ggp3 by adding a jitter layer with a width of 0.1. Save the enhanced plot as my_ggp4 and display it.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">my_ggp4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_ggp3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create new data object</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb12-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1b98e0"</span>)</span>
<span id="cb12-4">my_ggp4</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Modify the plot stored in my_ggp4 by applying the theme_classic(). Save the modified plot as my_ggp5 and display it.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">my_ggp5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_ggp4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>()</span>
<span id="cb13-3">my_ggp5</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-04/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <category>layers</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-04/</guid>
  <pubDate>Mon, 06 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-04/ubumuntu.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>grammar of graphics</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-02/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 2</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(PlantGrowth) </span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(airquality)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PlantGrowth,                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data              </span></span>
<span id="cb2-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> weight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># aesthetics</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geometry</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># facets</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># statistics</span></span>
<span id="cb2-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean,</span>
<span id="cb2-7">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>,</span>
<span id="cb2-8">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb2-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># coordinates</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()                                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># theme</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-02/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>Below are the exercises for this module.</p>
<ul>
<li>Install and load the ggplot2 package.</li>
<li>Load the airquality data set using the data() function.</li>
<li>Draw an empty plot using the ggplot() function, only specifying the data argument with the airquality data set.</li>
<li>Specify the aes() function within the ggplot() function so that y = Temp, and add a geom_boxplot() layer to draw a boxplot.</li>
<li>Create a facet boxplot for the Temp column, grouped by the Month column using the facet_wrap() function. How does the temperature distribution vary by month?</li>
<li>Apply the theme_light() to the facet boxplot you created in the previous exercise.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Month) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-02/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <category>grammar</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-02/</guid>
  <pubDate>Thu, 02 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-02/bouganvillea.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>aesthetic mapping</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-03/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 3</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(ToothGrowth) </span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(ToothGrowth)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   60 obs. of  3 variables:
 $ len : num  4.2 11.5 7.3 5.8 6.4 10 11.2 11.2 5.2 7 ...
 $ supp: Factor w/ 2 levels "OJ","VC": 2 2 2 2 2 2 2 2 2 2 ...
 $ dose: num  0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(airquality)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ToothGrowth,</span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp, </span>
<span id="cb4-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len, </span>
<span id="cb4-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> supp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54698</span>)                                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seed for reproducibility</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapping supp to color</span></span>
<span id="cb6-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp, </span>
<span id="cb6-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len, </span>
<span id="cb6-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> supp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb6-6">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can move the <code>size</code> argument to be within the <code>aes()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapping dose to size</span></span>
<span id="cb7-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp, </span>
<span id="cb7-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len, </span>
<span id="cb7-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> dose)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Also possible to combine <code>aes()</code> mapping…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combined aesthetic mapping</span></span>
<span id="cb8-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp, </span>
<span id="cb8-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len, </span>
<span id="cb8-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> supp, </span>
<span id="cb8-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> supp, </span>
<span id="cb8-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> dose)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or, map the <code>aes()</code> within the <code>geom()</code> function…note the second call to <code>aes()</code> within <code>geom_jitter()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ToothGrowth,                                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapping inside geom</span></span>
<span id="cb9-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> supp, </span>
<span id="cb9-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> len)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> supp, </span>
<span id="cb9-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> supp, </span>
<span id="cb9-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> dose), </span>
<span id="cb9-7">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>In this module, we continue working with the ggplot2 package and the airquality data set used in the previous module. To ensure accurate visualization, we first need to install and load the ggplot2 package. Additionally, we will convert the Month column in the airquality data set to a factor class to treat it as a categorical variable for visualizations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages()("ggplot2")                             Install &amp; load ggplot2</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb10-4"> </span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(airquality)                                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load example data</span></span>
<span id="cb10-6"> </span>
<span id="cb10-7">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert Month to factor</span></span></code></pre></div>
</div>
<p>Now, we can move on to the exercises of this module:</p>
<ul>
<li>Set a random seed using set.seed(75188) for reproducibility.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(airquality)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   153 obs. of  6 variables:
 $ Ozone  : int  41 36 12 18 NA 28 23 19 8 NA ...
 $ Solar.R: int  190 118 149 313 NA NA 299 99 19 194 ...
 $ Wind   : num  7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...
 $ Temp   : int  67 72 74 62 56 66 65 59 61 69 ...
 $ Month  : Factor w/ 5 levels "5","6","7","8",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Day    : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
</div>
</div>
<section id="exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2">Exercise 2</h3>
<ul>
<li>Map the Month column to the x-axis and the Temp column to the y-axis. Use a geom_boxplot() layer to create a boxplot.</li>
<li>Add the fill aesthetic mapping to the Month column in the boxplot created in the previous exercise.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)    </span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Month,</span>
<span id="cb13-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp,</span>
<span id="cb13-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Month)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-4" class="level3">
<h3 class="anchored" data-anchor-id="exercise-4">Exercise 4</h3>
<ul>
<li>Map the Month column to the color aesthetic, and use geom_jitter() to create a jitter plot. Adjust the width to 0.2 and the size to 3.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)    </span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Month,</span>
<span id="cb14-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp,</span>
<span id="cb14-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Month)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb14-7">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-5" class="level3">
<h3 class="anchored" data-anchor-id="exercise-5">Exercise 5</h3>
<ul>
<li>Combine multiple aesthetic mappings: map Month to color and shape, and map Day to size. Use geom_jitter() with a width of 0.2.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(airquality<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Month)    </span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> airquality,</span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Month,</span>
<span id="cb15-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Temp,</span>
<span id="cb15-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Month,</span>
<span id="cb15-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> Month,</span>
<span id="cb15-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> Day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-03/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <category>aes</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-03/</guid>
  <pubDate>Thu, 02 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-03/giraffe.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>ggplot &amp; the tidyverse</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dataviz-01/</link>
  <description><![CDATA[ 





<p><a href="https://statisticsglobe.com/online-course-data-visualization-ggplot2-r">Data Visualization in R Using ggplot2 - Module 1</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(PlantGrowth) </span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(PlantGrowth)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   30 obs. of  2 variables:
 $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 3 levels "ctrl","trt1",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(PlantGrowth)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(PlantGrowth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight))                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Density plot using base R</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PlantGrowth,</span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> weight,</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PlantGrowth,</span>
<span id="cb8-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> weight,</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PlantGrowth,</span>
<span id="cb9-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> weight,</span>
<span id="cb9-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">  PlantGrowth_grouped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> PlantGrowth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group data using dplyr</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_weight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(weight))</span>
<span id="cb10-4">PlantGrowth_grouped</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  group mean_weight
  &lt;fct&gt;       &lt;dbl&gt;
1 ctrl         5.03
2 trt1         4.66
3 trt2         5.53</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PlantGrowth_grouped,                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot2 bar chart</span></span>
<span id="cb12-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> group,</span>
<span id="cb12-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mean_weight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">PlantGrowth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manipulation &amp; visualization</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_weight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(weight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> group,</span>
<span id="cb13-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mean_weight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dataviz-01/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



 ]]></description>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>statsglobe</category>
  <category>R</category>
  <guid>https://cmadland.github.io/blog/posts/dataviz-01/</guid>
  <pubDate>Fri, 20 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dataviz-01/rainbow-yeti.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title></title>
  <dc:creator>Colin Madland&lt;sup&gt;1&lt;/sup&gt;, Valerie Irvine&lt;sup&gt;1&lt;/sup&gt;, Christopher DeLuca&lt;sup&gt;2&lt;/sup&gt;, and Okan Bulut&lt;sup&gt;3&lt;/sup&gt;</dc:creator>
  <link>https://cmadland.github.io/blog/posts/deck-otessa24/</link>
  <description><![CDATA[ undefined ]]></description>
  <guid>https://cmadland.github.io/blog/posts/deck-otessa24/</guid>
  <pubDate>Thu, 20 Jun 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Technology-Integrated Assessment in BC Higher Education</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/fellowship/</link>
  <description><![CDATA[ 





<p>In the fall of 2021, I embarked on the BCcampus Student Research Fellowship, a project funded by BCcampus intended to promote research on teaching and learning in BC. My project aimed at technology-integrated assessment practices in higher education. Assessment is already a contentious and high-stakes topic in higher education; however, concern around assessment escalated due to the COVID-19 pandemic, and also in light of generative AI models. The fellowship provided funding and support for a component of my PhD dissertation research at the University of Victoria, where I am supervised by Dr.&nbsp;Valerie Irvine.</p>
<p>My research is ongoing, and I am pleased to report that I have hit a milestone in completing and publishing the first two of three papers that will form my dissertation. <a href="https://doi.org/10.18357/otessaj.2024.4.1.57">The first paper is a literature review</a> exploring how higher education instructors integrate technology and assessment <span class="citation" data-cites="madlandTechnologyIntegratedAssessmentLiterature2024">(Madland et al., 2024b)</span>. We purposely explored papers written by those who do not study assessment as a disciplinary area, but who are instructors in a wide variety of disciplines and who are compelled for one reason or another to use technology when they assess learning. We explored these articles through the lens of the assessment design in a digital world framework published by <span class="citation" data-cites="bearman2022">Bearman et al. (2022)</span>. While there were areas of overlap between the literature and the Bearman et al.&nbsp;framework (primarily the importance of understanding the different purposes of assessment), there were also themes that emerged in the literature that are not modeled in the framework (e.g., instructor workload, academic integrity), and there were components of the framework that were not evident in the literature (e.g., digital literacies). These points of incongruity suggested a need for revisions to the model which led to a process of envisioning what a model of technology-integrated assessment might look like.</p>
<p>The development of the <a href="https://doi.org/10.18357/otessaj.2024.4.1.63">technology-integrated assessment framework, described in the second paper</a> <span class="citation" data-cites="madlandDevelopingTechnologyIntegratedAssessment2024">(Madland et al., 2024a)</span>, is the result of this envisioning process and serves as a good anchor point in beginning to understand how to improve technology-integrated assessment practices in higher education in British Columbia and beyond. The technology-integrated assessment framework consists of four components, which might be considered to be four factors that instructors consider when planning assessment. The four factors and their sub-factors are:</p>
<ol type="1">
<li>The purposes of assessment
<ol type="1">
<li>Assessment <em>of</em> Learning</li>
<li>Assessment <em>for</em> Learning</li>
<li>Assessment <em>as</em> Learning</li>
</ol></li>
<li>Duty of Care
<ol type="1">
<li>Bias</li>
<li>Inclusion</li>
<li>Relationships</li>
<li>Ethical EdTech</li>
</ol></li>
<li>Technology Acceptance
<ol type="1">
<li>Performance Expectancy</li>
<li>Effort Expectancy</li>
<li>Social Influences</li>
<li>Facilitating Conditions</li>
</ol></li>
<li>Assessment Design
<ol type="1">
<li>Measurement Theory</li>
<li>Academic Integrity</li>
<li>Relevance</li>
<li>Reciprocity</li>
</ol></li>
</ol>
<p>Figure 1 is a theoretical conceptualization of the model and its sub-components.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/fellowship/tiaf-q-full.png" class="img-fluid figure-img"></p>
<figcaption>A diagram of concentric circles showing the components of the technology-integrated assessment framework. Starting from the inside, the circles are labeled ‘assessment purpose,’ ‘duty of care,’ ‘technology acceptance,’ and ‘assessment design.’</figcaption>
</figure>
</div>
<p><em>Note:</em> Licensed <a href="https://creativecommons.org/licenses/by/4.0/">(CC-BY)</a>, from Madland, C., Irvine, V., DeLuca, C., &amp; Bulut, O. (2024). Developing the Technology-Integrated Assessment Framework. <em>The Open/Technology in Education, Society, and Scholarship Association Journal, 4</em>(1), 1–19. <a href="https://doi.org/10.18357/otessaj.2024.4.1.63" class="uri">https://doi.org/10.18357/otessaj.2024.4.1.63</a>.</p>
<p>We were intentional about considering the framework in light of the 5Rs of Indigenous education: respect, relevance, reciprocity, responsibility, and relationships <span class="citation" data-cites="tessaro2018 kirkness1991">(Kirkness &amp; Barnhardt, 1991; Tessaro et al., 2018)</span>. Respect and responsibility are embedded in the ‘Duty of Care’ component while relationships, reciprocity, and relevance are explicit in the framework. Further work is coming and will focus on exploring the relationships between the factors and sub-factors in the framework.</p>
<p>I am grateful to my supervisor, Dr.&nbsp;Valerie Irvine, for her keen insight and expert contributions, as well as my committee members, Dr.&nbsp;Chris DeLuca (Queen’s University), and Dr.&nbsp;Okan Bulut (University of Alberta) whose diverse wisdom around assessment were invaluable.</p>
<p>I am also appreciative to BCcampus, especially Leva Lee, Britt Dzioba, Rebecca Shortt, and Gwen Nguyen for their support through the BCcampus Student Fellowship program, which provides B.C. post-secondary educators and students with funding to conduct research on teaching and learning, as well as explore evidence-based teaching practices that focus on student success and learning.</p>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-bearman2022" class="csl-entry">
Bearman, M., Nieminen, J., &amp; Ajjawi, R. (2022). Designing assessment in a digital world: An organising framework. <em>Assessment &amp; Evaluation in Higher Education</em>, <em>48</em>(3). <a href="https://doi.org/10.1080/02602938.2022.2069674">https://doi.org/10.1080/02602938.2022.2069674</a>
</div>
<div id="ref-kirkness1991" class="csl-entry">
Kirkness, V. J., &amp; Barnhardt, R. (1991). First nations and higher education: The four r’s– respect, relevance, reciprocity, responsibility. <em>Journal of American Indian Education</em>, <em>30</em>(3), 1–15. <a href="https://eric.ed.gov/?id=EJ438242">https://eric.ed.gov/?id=EJ438242</a>
</div>
<div id="ref-madlandDevelopingTechnologyIntegratedAssessment2024" class="csl-entry">
Madland, C., Irvine, V., DeLuca, C., &amp; Bulut, O. (2024a). Developing the <span>Technology-Integrated Assessment Framework</span>. <em>The Open/Technology in Education, Society, and Scholarship Association Journal</em>, <em>4</em>(1), 1–19. <a href="https://doi.org/10.18357/otessaj.2024.4.1.63">https://doi.org/10.18357/otessaj.2024.4.1.63</a>
</div>
<div id="ref-madlandTechnologyIntegratedAssessmentLiterature2024" class="csl-entry">
Madland, C., Irvine, V., DeLuca, C., &amp; Bulut, O. (2024b). Technology-<span>Integrated Assessment</span>: <span>A Literature Review</span>. <em>The Open/Technology in Education, Society, and Scholarship Association Journal</em>, <em>4</em>(1), 1–48. <a href="https://doi.org/10.18357/otessaj.2024.4.1.57">https://doi.org/10.18357/otessaj.2024.4.1.57</a>
</div>
<div id="ref-tessaro2018" class="csl-entry">
Tessaro, D., Restoule, J.-P., Gaviria, P., Flessa, J., Lindeman, C., &amp; Scully-Stewart, C. (2018). The five r’s for indigenizing online learning: A case study of the first nations schools’ principals course. <em>Canadian Journal of Native Education</em>, <em>40</em>(1), 125–143. <a href="https://www.researchgate.net/publication/328289320_The_Five_R%27s_for_Indigenizing_Online_Learning_A_Case_Study_of_the_First_Nations_Schools%27_Principals_Course">https://www.researchgate.net/publication/328289320_The_Five_R%27s_for_Indigenizing_Online_Learning_A_Case_Study_of_the_First_Nations_Schools%27_Principals_Course</a>
</div>
</div></section></div> ]]></description>
  <category>BCcampus</category>
  <category>fellowship</category>
  <guid>https://cmadland.github.io/blog/posts/fellowship/</guid>
  <pubDate>Thu, 02 May 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/fellowship/lake.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>dsus_18 - Exploratory Factor Analysis</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/dsur_ch18_efa/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, knitr)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2, ggfortify, robust)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(viridis)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GPArotation)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">raq_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/raq.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2571 Columns: 24
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): id
dbl (23): raq_01, raq_02, raq_03, raq_04, raq_05, raq_06, raq_07, raq_08, ra...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Notes here are from</p>
<p>Field, A. P. (2018). <em>Discovering statistics using IBM SPSS statistics</em> (5th edition, North American edition). Sage Publications Inc.&nbsp;-&gt; <code>DSuS</code></p>
<p>Code examples will be from:</p>
<p>Field, A. (2023). discovr: Interactive tutorials and data for “Discovering Statistics Using R and RStudio” [Manual]. -&gt; <code>discovr</code></p>
<p>R Core Team. (2023). R: A language and environment for statistical computing [Manual]. R Foundation for Statistical Computing. https://www.R-project.org/</p>
<section id="when-to-use-factor-analysis-p.-571" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-factor-analysis-p.-571">When to use factor analysis (p.&nbsp;571)</h2>
<ul>
<li>when attempting to measure latent variables</li>
<li>factor analysis and principal component analysis are used to identify clusters of variables</li>
<li>3 main uses
<ul>
<li>understand the structure of a set of variables</li>
<li>to construct a questionnaire to measure an underlying variable</li>
<li>reduce the size of a data set while retaining as much of the original information as possible
<ul>
<li>(FA can be used to solve the problem of multicollinearity by combining factors that are collinear)</li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt><code>multicollinearity</code></dt>
<dd>
<p>exists when there is a strong correlation between two factors</p>
</dd>
<dd>
<p>multicollinearity makes it difficult or impossible to determine the amount of variance accounted for by one of two correlated factors</p>
</dd>
<dd>
<p>e.g., if a factor predicts the outcome variable with <img src="https://latex.codecogs.com/png.latex?R=0.80"> and a second variable accounts for <em>the same variance</em> (i.e., it is highly correlated to the first variable) then it is only contributing to a very small amount of the unique variance in outcome and we might see <img src="https://latex.codecogs.com/png.latex?R=0.82">. If the two predictor variables are uncorrelated, then the second variable is contributing more unique variance and we might see <img src="https://latex.codecogs.com/png.latex?R=0.95"></p>
</dd>
<dd>
<p>multicollinearity leads to interchangable predictors</p>
</dd>
</dl>
</div>
</div>
</div>
<section id="examples-of-factor-analysis" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-factor-analysis">Examples of factor analysis</h3>
<ul>
<li>extroversion, introversion, neuroticism traits</li>
<li>personality questionnaires</li>
<li>in economics to see whether productivity, profits, and workforce contribute to the underlying dimension of company growth</li>
</ul>
</section>
<section id="efa-and-pca" class="level3">
<h3 class="anchored" data-anchor-id="efa-and-pca">EFA and PCA</h3>
<ul>
<li>they are not the same thing</li>
<li>but they both are used to reduce a set of variables into a smaller set of dimensions (factors in EFA, and components in PCA)</li>
</ul>
</section>
</section>
<section id="factors-and-components" class="level2">
<h2 class="anchored" data-anchor-id="factors-and-components">Factors and Components</h2>
<ul>
<li><p>measuring several variables with several questions gives us data that can be arranged in a correlation matrix (R matrix) as below. <img src="https://cmadland.github.io/blog/posts/dsur_ch18_efa/cor-matrix.png" class="img-fluid" alt="Example of a correlation matrix"></p>
<p><em>Note:</em> Created with the <code>ggplot2</code> R package <span class="citation" data-cites="wickham2016">(Wickham 2016)</span> with data from the <code>discovr</code> package <span class="citation" data-cites="field2023">(Field 2023.)</span></p></li>
<li><p>factor analysis tries to explain the maximum amount of <em>common variance</em> in the matrix using the least number of explanatory constructs (latent variables), which represent clusters of variables that correlate highly with each other.</p></li>
<li><p>PCA differs in that it tries to explain the maximum amount of <em>total variance</em> in a correlation matrix by transforming the original variables into linear components</p></li>
</ul>
</section>
<section id="example---induced-anxiety-discovr_18-field2023" class="level2">
<h2 class="anchored" data-anchor-id="example---induced-anxiety-discovr_18-field2023">Example - Induced Anxiety (<code>discovr_18</code> <span class="citation" data-cites="field2023">Field (2023)</span>)</h2>
<ul>
<li>questionnaire developed to measure anxiety related to using R</li>
<li>questions developed from interviews with anxious and non-anxious students</li>
<li>23 questions; 5-point likert (strongly disagree -&gt; strongly agree)
<ul>
<li>raq_01: Statistics make me cry</li>
<li>raq_02: My friends will think I’m stupid for not being able to cope with R</li>
<li>raq_03: Standard deviations excite me</li>
<li>raq_04: I dream that Pearson is attacking me with correlation coefficients</li>
<li>raq_05: I don’t understand statistics</li>
<li>raq_06: I have little experience of computers</li>
<li>raq_07: All computers hate me</li>
<li>raq_08: I have never been good at mathematics</li>
<li>raq_09: My friends are better at statistics than me</li>
<li>raq_10: Computers are useful only for playing games</li>
<li>raq_11: I did badly at mathematics at school</li>
<li>raq_12: People try to tell you that R makes statistics easier to understand but it doesn’t</li>
<li>raq_13: I worry that I will cause irreparable damage because of my incompetence with computers</li>
<li>raq_14: Computers have minds of their own and deliberately go wrong whenever I use them</li>
<li>raq_15: Computers are out to get me</li>
<li>raq_16: I weep openly at the mention of central tendency</li>
<li>raq_17: I slip into a coma whenever I see an equation</li>
<li>raq_18: R always crashes when I try to use it</li>
<li>raq_19: Everybody looks at me when I use R</li>
<li>raq_20: I can’t sleep for thoughts of eigenvectors</li>
<li>raq_21: I wake up under my duvet thinking that I am trapped under a normal distribution</li>
<li>raq_22: My friends are better at R than I am</li>
<li>raq_23: If I am good at statistics people will think I am a nerd</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">raq_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,571 × 24
   id    raq_01 raq_02 raq_03 raq_04 raq_05 raq_06 raq_07 raq_08 raq_09 raq_10
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 157lk      3      1      3      4      2      4      3      3      3      2
 2 k3xjh      2      5      3      3      4      4      5      4      4      3
 3 832x6      4      5      3      3      3      4      5      4      3      4
 4 6dyt5      4      4      4      3      4      4      4      3      2      2
 5 w4upu      4      2      5      4      2      3      2      5      4      5
 6 9432i      2      3      4      3      4      2      3      2      3      2
 7 x03sh      2      4      5      5      3      3      4      3      3      3
 8 12v15      4      3      4      3      5      4      5      4      3      5
 9 46y22      3      5      5      1      3      4      4      3      5      3
10 1iqc4      2      5      3      2      4      5      5      5      4      4
# ℹ 2,561 more rows
# ℹ 13 more variables: raq_11 &lt;dbl&gt;, raq_12 &lt;dbl&gt;, raq_13 &lt;dbl&gt;, raq_14 &lt;dbl&gt;,
#   raq_15 &lt;dbl&gt;, raq_16 &lt;dbl&gt;, raq_17 &lt;dbl&gt;, raq_18 &lt;dbl&gt;, raq_19 &lt;dbl&gt;,
#   raq_20 &lt;dbl&gt;, raq_21 &lt;dbl&gt;, raq_22 &lt;dbl&gt;, raq_23 &lt;dbl&gt;</code></pre>
</div>
</div>
<ul>
<li>24 variables including the ID</li>
<li>we don’t need the <code>id</code> in analyses so create a new tib without it</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">raq_items_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> raq_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id)</span>
<span id="cb10-3">raq_items_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,571 × 23
   raq_01 raq_02 raq_03 raq_04 raq_05 raq_06 raq_07 raq_08 raq_09 raq_10 raq_11
    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1      3      1      3      4      2      4      3      3      3      2      2
 2      2      5      3      3      4      4      5      4      4      3      4
 3      4      5      3      3      3      4      5      4      3      4      4
 4      4      4      4      3      4      4      4      3      2      2      2
 5      4      2      5      4      2      3      2      5      4      5      4
 6      2      3      4      3      4      2      3      2      3      2      1
 7      2      4      5      5      3      3      4      3      3      3      3
 8      4      3      4      3      5      4      5      4      3      5      3
 9      3      5      5      1      3      4      4      3      5      3      3
10      2      5      3      2      4      5      5      5      4      4      4
# ℹ 2,561 more rows
# ℹ 12 more variables: raq_12 &lt;dbl&gt;, raq_13 &lt;dbl&gt;, raq_14 &lt;dbl&gt;, raq_15 &lt;dbl&gt;,
#   raq_16 &lt;dbl&gt;, raq_17 &lt;dbl&gt;, raq_18 &lt;dbl&gt;, raq_19 &lt;dbl&gt;, raq_20 &lt;dbl&gt;,
#   raq_21 &lt;dbl&gt;, raq_22 &lt;dbl&gt;, raq_23 &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix">Correlation matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># feed the tibble with only the RAQ items into the correlation() function</span></span>
<span id="cb12-2">correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(raq_items_tib)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Correlation Matrix (pearson-method)

Parameter1 | Parameter2 |     r |         95% CI | t(2569) |         p
----------------------------------------------------------------------
raq_01     |     raq_02 |  0.11 | [ 0.07,  0.15] |    5.47 | &lt; .001***
raq_01     |     raq_03 | -0.18 | [-0.22, -0.14] |   -9.21 | &lt; .001***
raq_01     |     raq_04 |  0.22 | [ 0.18,  0.25] |   11.26 | &lt; .001***
raq_01     |     raq_05 |  0.22 | [ 0.19,  0.26] |   11.60 | &lt; .001***
raq_01     |     raq_06 |  0.16 | [ 0.12,  0.20] |    8.17 | &lt; .001***
raq_01     |     raq_07 |  0.11 | [ 0.07,  0.14] |    5.41 | &lt; .001***
raq_01     |     raq_08 |  0.22 | [ 0.18,  0.26] |   11.53 | &lt; .001***
raq_01     |     raq_09 |  0.08 | [ 0.05,  0.12] |    4.26 | &lt; .001***
raq_01     |     raq_10 |  0.11 | [ 0.07,  0.15] |    5.70 | &lt; .001***
raq_01     |     raq_11 |  0.19 | [ 0.15,  0.23] |    9.76 | &lt; .001***
raq_01     |     raq_12 |  0.15 | [ 0.11,  0.19] |    7.67 | &lt; .001***
raq_01     |     raq_13 |  0.11 | [ 0.07,  0.15] |    5.55 | &lt; .001***
raq_01     |     raq_14 |  0.12 | [ 0.08,  0.15] |    5.87 | &lt; .001***
raq_01     |     raq_15 |  0.11 | [ 0.07,  0.15] |    5.61 | &lt; .001***
raq_01     |     raq_16 |  0.18 | [ 0.14,  0.21] |    9.04 | &lt; .001***
raq_01     |     raq_17 |  0.17 | [ 0.13,  0.20] |    8.52 | &lt; .001***
raq_01     |     raq_18 |  0.12 | [ 0.08,  0.16] |    6.06 | &lt; .001***
raq_01     |     raq_19 |  0.11 | [ 0.07,  0.14] |    5.45 | &lt; .001***
raq_01     |     raq_20 |  0.21 | [ 0.17,  0.24] |   10.73 | &lt; .001***
raq_01     |     raq_21 |  0.23 | [ 0.19,  0.26] |   11.81 | &lt; .001***
raq_01     |     raq_22 |  0.12 | [ 0.09,  0.16] |    6.30 | &lt; .001***
raq_01     |     raq_23 |  0.08 | [ 0.04,  0.12] |    3.93 | &lt; .001***
raq_02     |     raq_03 | -0.12 | [-0.16, -0.08] |   -6.14 | &lt; .001***
raq_02     |     raq_04 |  0.12 | [ 0.09,  0.16] |    6.31 | &lt; .001***
raq_02     |     raq_05 |  0.28 | [ 0.24,  0.31] |   14.71 | &lt; .001***
raq_02     |     raq_06 |  0.34 | [ 0.30,  0.37] |   18.19 | &lt; .001***
raq_02     |     raq_07 |  0.26 | [ 0.22,  0.29] |   13.44 | &lt; .001***
raq_02     |     raq_08 |  0.18 | [ 0.14,  0.22] |    9.16 | &lt; .001***
raq_02     |     raq_09 |  0.39 | [ 0.36,  0.42] |   21.50 | &lt; .001***
raq_02     |     raq_10 |  0.18 | [ 0.15,  0.22] |    9.48 | &lt; .001***
raq_02     |     raq_11 |  0.15 | [ 0.11,  0.19] |    7.82 | &lt; .001***
raq_02     |     raq_12 |  0.09 | [ 0.05,  0.13] |    4.58 | &lt; .001***
raq_02     |     raq_13 |  0.23 | [ 0.19,  0.27] |   11.96 | &lt; .001***
raq_02     |     raq_14 |  0.20 | [ 0.16,  0.23] |   10.21 | &lt; .001***
raq_02     |     raq_15 |  0.19 | [ 0.15,  0.22] |    9.64 | &lt; .001***
raq_02     |     raq_16 |  0.10 | [ 0.06,  0.13] |    4.92 | &lt; .001***
raq_02     |     raq_17 |  0.17 | [ 0.14,  0.21] |    8.94 | &lt; .001***
raq_02     |     raq_18 |  0.26 | [ 0.23,  0.30] |   13.87 | &lt; .001***
raq_02     |     raq_19 |  0.39 | [ 0.36,  0.42] |   21.50 | &lt; .001***
raq_02     |     raq_20 |  0.13 | [ 0.09,  0.17] |    6.55 | &lt; .001***
raq_02     |     raq_21 |  0.16 | [ 0.12,  0.20] |    8.26 | &lt; .001***
raq_02     |     raq_22 |  0.34 | [ 0.30,  0.37] |   18.28 | &lt; .001***
raq_02     |     raq_23 |  0.39 | [ 0.36,  0.42] |   21.56 | &lt; .001***
raq_03     |     raq_04 | -0.19 | [-0.23, -0.16] |  -10.01 | &lt; .001***
raq_03     |     raq_05 | -0.25 | [-0.29, -0.22] |  -13.34 | &lt; .001***
raq_03     |     raq_06 | -0.17 | [-0.20, -0.13] |   -8.51 | &lt; .001***
raq_03     |     raq_07 | -0.13 | [-0.16, -0.09] |   -6.45 | &lt; .001***
raq_03     |     raq_08 | -0.22 | [-0.25, -0.18] |  -11.33 | &lt; .001***
raq_03     |     raq_09 | -0.08 | [-0.12, -0.04] |   -4.14 | &lt; .001***
raq_03     |     raq_10 | -0.10 | [-0.14, -0.06] |   -5.18 | &lt; .001***
raq_03     |     raq_11 | -0.19 | [-0.23, -0.15] |   -9.81 | &lt; .001***
raq_03     |     raq_12 | -0.15 | [-0.19, -0.11] |   -7.58 | &lt; .001***
raq_03     |     raq_13 | -0.13 | [-0.17, -0.09] |   -6.71 | &lt; .001***
raq_03     |     raq_14 | -0.09 | [-0.13, -0.05] |   -4.45 | &lt; .001***
raq_03     |     raq_15 | -0.15 | [-0.19, -0.11] |   -7.57 | &lt; .001***
raq_03     |     raq_16 | -0.20 | [-0.24, -0.17] |  -10.56 | &lt; .001***
raq_03     |     raq_17 | -0.18 | [-0.21, -0.14] |   -9.01 | &lt; .001***
raq_03     |     raq_18 | -0.15 | [-0.19, -0.11] |   -7.78 | &lt; .001***
raq_03     |     raq_19 | -0.12 | [-0.15, -0.08] |   -5.96 | &lt; .001***
raq_03     |     raq_20 | -0.23 | [-0.27, -0.20] |  -12.20 | &lt; .001***
raq_03     |     raq_21 | -0.26 | [-0.30, -0.22] |  -13.62 | &lt; .001***
raq_03     |     raq_22 | -0.12 | [-0.16, -0.08] |   -6.00 | &lt; .001***
raq_03     |     raq_23 | -0.05 | [-0.09, -0.01] |   -2.65 | 0.014*   
raq_04     |     raq_05 |  0.32 | [ 0.28,  0.35] |   17.08 | &lt; .001***
raq_04     |     raq_06 |  0.23 | [ 0.20,  0.27] |   12.21 | &lt; .001***
raq_04     |     raq_07 |  0.17 | [ 0.13,  0.20] |    8.56 | &lt; .001***
raq_04     |     raq_08 |  0.25 | [ 0.21,  0.28] |   12.96 | &lt; .001***
raq_04     |     raq_09 |  0.10 | [ 0.06,  0.14] |    4.98 | &lt; .001***
raq_04     |     raq_10 |  0.18 | [ 0.14,  0.21] |    9.11 | &lt; .001***
raq_04     |     raq_11 |  0.22 | [ 0.18,  0.26] |   11.54 | &lt; .001***
raq_04     |     raq_12 |  0.20 | [ 0.16,  0.23] |   10.12 | &lt; .001***
raq_04     |     raq_13 |  0.16 | [ 0.13,  0.20] |    8.42 | &lt; .001***
raq_04     |     raq_14 |  0.15 | [ 0.11,  0.18] |    7.55 | &lt; .001***
raq_04     |     raq_15 |  0.18 | [ 0.15,  0.22] |    9.50 | &lt; .001***
raq_04     |     raq_16 |  0.27 | [ 0.23,  0.31] |   14.25 | &lt; .001***
raq_04     |     raq_17 |  0.24 | [ 0.20,  0.27] |   12.36 | &lt; .001***
raq_04     |     raq_18 |  0.17 | [ 0.13,  0.21] |    8.81 | &lt; .001***
raq_04     |     raq_19 |  0.14 | [ 0.10,  0.18] |    7.24 | &lt; .001***
raq_04     |     raq_20 |  0.28 | [ 0.25,  0.32] |   15.00 | &lt; .001***
raq_04     |     raq_21 |  0.32 | [ 0.28,  0.35] |   17.12 | &lt; .001***
raq_04     |     raq_22 |  0.16 | [ 0.12,  0.19] |    8.07 | &lt; .001***
raq_04     |     raq_23 |  0.08 | [ 0.04,  0.12] |    4.22 | &lt; .001***
raq_05     |     raq_06 |  0.51 | [ 0.48,  0.54] |   30.26 | &lt; .001***
raq_05     |     raq_07 |  0.36 | [ 0.33,  0.40] |   19.79 | &lt; .001***
raq_05     |     raq_08 |  0.36 | [ 0.32,  0.39] |   19.39 | &lt; .001***
raq_05     |     raq_09 |  0.16 | [ 0.12,  0.20] |    8.28 | &lt; .001***
raq_05     |     raq_10 |  0.31 | [ 0.28,  0.35] |   16.67 | &lt; .001***
raq_05     |     raq_11 |  0.31 | [ 0.28,  0.35] |   16.61 | &lt; .001***
raq_05     |     raq_12 |  0.19 | [ 0.15,  0.22] |    9.66 | &lt; .001***
raq_05     |     raq_13 |  0.35 | [ 0.32,  0.38] |   19.00 | &lt; .001***
raq_05     |     raq_14 |  0.27 | [ 0.23,  0.30] |   14.05 | &lt; .001***
raq_05     |     raq_15 |  0.33 | [ 0.29,  0.36] |   17.54 | &lt; .001***
raq_05     |     raq_16 |  0.24 | [ 0.20,  0.28] |   12.53 | &lt; .001***
raq_05     |     raq_17 |  0.30 | [ 0.27,  0.34] |   16.01 | &lt; .001***
raq_05     |     raq_18 |  0.38 | [ 0.35,  0.41] |   20.97 | &lt; .001***
raq_05     |     raq_19 |  0.29 | [ 0.26,  0.33] |   15.50 | &lt; .001***
raq_05     |     raq_20 |  0.34 | [ 0.31,  0.37] |   18.36 | &lt; .001***
raq_05     |     raq_21 |  0.37 | [ 0.34,  0.40] |   20.24 | &lt; .001***
raq_05     |     raq_22 |  0.27 | [ 0.23,  0.31] |   14.26 | &lt; .001***
raq_05     |     raq_23 |  0.17 | [ 0.13,  0.21] |    8.70 | &lt; .001***
raq_06     |     raq_07 |  0.45 | [ 0.42,  0.48] |   25.68 | &lt; .001***
raq_06     |     raq_08 |  0.34 | [ 0.31,  0.37] |   18.36 | &lt; .001***
raq_06     |     raq_09 |  0.20 | [ 0.16,  0.24] |   10.40 | &lt; .001***
raq_06     |     raq_10 |  0.40 | [ 0.36,  0.43] |   21.93 | &lt; .001***
raq_06     |     raq_11 |  0.29 | [ 0.26,  0.33] |   15.55 | &lt; .001***
raq_06     |     raq_12 |  0.11 | [ 0.07,  0.15] |    5.74 | &lt; .001***
raq_06     |     raq_13 |  0.46 | [ 0.42,  0.49] |   25.90 | &lt; .001***
raq_06     |     raq_14 |  0.36 | [ 0.32,  0.39] |   19.25 | &lt; .001***
raq_06     |     raq_15 |  0.40 | [ 0.37,  0.43] |   22.20 | &lt; .001***
raq_06     |     raq_16 |  0.16 | [ 0.12,  0.20] |    8.21 | &lt; .001***
raq_06     |     raq_17 |  0.28 | [ 0.24,  0.32] |   14.83 | &lt; .001***
raq_06     |     raq_18 |  0.51 | [ 0.48,  0.54] |   30.01 | &lt; .001***
raq_06     |     raq_19 |  0.38 | [ 0.34,  0.41] |   20.64 | &lt; .001***
raq_06     |     raq_20 |  0.23 | [ 0.19,  0.26] |   11.74 | &lt; .001***
raq_06     |     raq_21 |  0.26 | [ 0.23,  0.30] |   13.86 | &lt; .001***
raq_06     |     raq_22 |  0.33 | [ 0.29,  0.36] |   17.48 | &lt; .001***
raq_06     |     raq_23 |  0.17 | [ 0.13,  0.21] |    8.85 | &lt; .001***
raq_07     |     raq_08 |  0.25 | [ 0.21,  0.28] |   13.03 | &lt; .001***
raq_07     |     raq_09 |  0.17 | [ 0.13,  0.20] |    8.48 | &lt; .001***
raq_07     |     raq_10 |  0.28 | [ 0.25,  0.32] |   14.94 | &lt; .001***
raq_07     |     raq_11 |  0.21 | [ 0.18,  0.25] |   11.02 | &lt; .001***
raq_07     |     raq_12 |  0.10 | [ 0.06,  0.13] |    4.89 | &lt; .001***
raq_07     |     raq_13 |  0.31 | [ 0.28,  0.35] |   16.58 | &lt; .001***
raq_07     |     raq_14 |  0.25 | [ 0.21,  0.29] |   13.16 | &lt; .001***
raq_07     |     raq_15 |  0.29 | [ 0.25,  0.32] |   15.28 | &lt; .001***
raq_07     |     raq_16 |  0.12 | [ 0.08,  0.16] |    6.21 | &lt; .001***
raq_07     |     raq_17 |  0.21 | [ 0.17,  0.25] |   10.94 | &lt; .001***
raq_07     |     raq_18 |  0.35 | [ 0.32,  0.38] |   18.93 | &lt; .001***
raq_07     |     raq_19 |  0.26 | [ 0.22,  0.29] |   13.41 | &lt; .001***
raq_07     |     raq_20 |  0.14 | [ 0.10,  0.18] |    7.17 | &lt; .001***
raq_07     |     raq_21 |  0.20 | [ 0.16,  0.23] |   10.19 | &lt; .001***
raq_07     |     raq_22 |  0.22 | [ 0.19,  0.26] |   11.69 | &lt; .001***
raq_07     |     raq_23 |  0.16 | [ 0.12,  0.20] |    8.24 | &lt; .001***
raq_08     |     raq_09 |  0.16 | [ 0.13,  0.20] |    8.45 | &lt; .001***
raq_08     |     raq_10 |  0.19 | [ 0.15,  0.22] |    9.58 | &lt; .001***
raq_08     |     raq_11 |  0.58 | [ 0.56,  0.61] |   36.28 | &lt; .001***
raq_08     |     raq_12 |  0.13 | [ 0.09,  0.17] |    6.58 | &lt; .001***
raq_08     |     raq_13 |  0.20 | [ 0.16,  0.24] |   10.38 | &lt; .001***
raq_08     |     raq_14 |  0.23 | [ 0.19,  0.27] |   12.01 | &lt; .001***
raq_08     |     raq_15 |  0.23 | [ 0.19,  0.27] |   11.97 | &lt; .001***
raq_08     |     raq_16 |  0.21 | [ 0.17,  0.24] |   10.69 | &lt; .001***
raq_08     |     raq_17 |  0.55 | [ 0.52,  0.57] |   33.20 | &lt; .001***
raq_08     |     raq_18 |  0.28 | [ 0.24,  0.31] |   14.68 | &lt; .001***
raq_08     |     raq_19 |  0.21 | [ 0.17,  0.25] |   10.86 | &lt; .001***
raq_08     |     raq_20 |  0.26 | [ 0.23,  0.30] |   13.76 | &lt; .001***
raq_08     |     raq_21 |  0.30 | [ 0.27,  0.34] |   16.15 | &lt; .001***
raq_08     |     raq_22 |  0.22 | [ 0.19,  0.26] |   11.68 | &lt; .001***
raq_08     |     raq_23 |  0.14 | [ 0.10,  0.18] |    7.25 | &lt; .001***
raq_09     |     raq_10 |  0.11 | [ 0.07,  0.14] |    5.38 | &lt; .001***
raq_09     |     raq_11 |  0.17 | [ 0.14,  0.21] |    9.01 | &lt; .001***
raq_09     |     raq_12 |  0.06 | [ 0.02,  0.10] |    3.07 | 0.007**  
raq_09     |     raq_13 |  0.15 | [ 0.11,  0.19] |    7.84 | &lt; .001***
raq_09     |     raq_14 |  0.12 | [ 0.09,  0.16] |    6.30 | &lt; .001***
raq_09     |     raq_15 |  0.15 | [ 0.11,  0.19] |    7.60 | &lt; .001***
raq_09     |     raq_16 |  0.08 | [ 0.04,  0.12] |    4.19 | &lt; .001***
raq_09     |     raq_17 |  0.14 | [ 0.10,  0.18] |    7.32 | &lt; .001***
raq_09     |     raq_18 |  0.15 | [ 0.11,  0.18] |    7.52 | &lt; .001***
raq_09     |     raq_19 |  0.46 | [ 0.43,  0.49] |   26.59 | &lt; .001***
raq_09     |     raq_20 |  0.10 | [ 0.06,  0.14] |    5.08 | &lt; .001***
raq_09     |     raq_21 |  0.17 | [ 0.13,  0.20] |    8.61 | &lt; .001***
raq_09     |     raq_22 |  0.43 | [ 0.40,  0.46] |   23.95 | &lt; .001***
raq_09     |     raq_23 |  0.55 | [ 0.52,  0.57] |   33.09 | &lt; .001***
raq_10     |     raq_11 |  0.17 | [ 0.13,  0.21] |    8.68 | &lt; .001***
raq_10     |     raq_12 |  0.08 | [ 0.04,  0.11] |    3.85 | 0.001**  
raq_10     |     raq_13 |  0.25 | [ 0.21,  0.28] |   12.99 | &lt; .001***
raq_10     |     raq_14 |  0.22 | [ 0.18,  0.26] |   11.38 | &lt; .001***
raq_10     |     raq_15 |  0.24 | [ 0.21,  0.28] |   12.68 | &lt; .001***
raq_10     |     raq_16 |  0.13 | [ 0.09,  0.17] |    6.59 | &lt; .001***
raq_10     |     raq_17 |  0.18 | [ 0.14,  0.21] |    9.12 | &lt; .001***
raq_10     |     raq_18 |  0.29 | [ 0.26,  0.33] |   15.43 | &lt; .001***
raq_10     |     raq_19 |  0.21 | [ 0.17,  0.25] |   10.97 | &lt; .001***
raq_10     |     raq_20 |  0.18 | [ 0.14,  0.22] |    9.23 | &lt; .001***
raq_10     |     raq_21 |  0.16 | [ 0.12,  0.20] |    8.34 | &lt; .001***
raq_10     |     raq_22 |  0.16 | [ 0.12,  0.19] |    7.98 | &lt; .001***
raq_10     |     raq_23 |  0.07 | [ 0.03,  0.11] |    3.53 | 0.003**  
raq_11     |     raq_12 |  0.10 | [ 0.07,  0.14] |    5.27 | &lt; .001***
raq_11     |     raq_13 |  0.20 | [ 0.16,  0.24] |   10.40 | &lt; .001***
raq_11     |     raq_14 |  0.19 | [ 0.15,  0.22] |    9.59 | &lt; .001***
raq_11     |     raq_15 |  0.20 | [ 0.16,  0.24] |   10.42 | &lt; .001***
raq_11     |     raq_16 |  0.17 | [ 0.14,  0.21] |    9.00 | &lt; .001***
raq_11     |     raq_17 |  0.47 | [ 0.43,  0.49] |   26.63 | &lt; .001***
raq_11     |     raq_18 |  0.24 | [ 0.20,  0.28] |   12.48 | &lt; .001***
raq_11     |     raq_19 |  0.19 | [ 0.16,  0.23] |   10.04 | &lt; .001***
raq_11     |     raq_20 |  0.27 | [ 0.23,  0.31] |   14.19 | &lt; .001***
raq_11     |     raq_21 |  0.29 | [ 0.25,  0.32] |   15.15 | &lt; .001***
raq_11     |     raq_22 |  0.20 | [ 0.16,  0.24] |   10.44 | &lt; .001***
raq_11     |     raq_23 |  0.13 | [ 0.09,  0.17] |    6.56 | &lt; .001***
raq_12     |     raq_13 |  0.07 | [ 0.03,  0.11] |    3.48 | 0.003**  
raq_12     |     raq_14 |  0.07 | [ 0.03,  0.11] |    3.50 | 0.003**  
raq_12     |     raq_15 |  0.07 | [ 0.03,  0.11] |    3.63 | 0.002**  
raq_12     |     raq_16 |  0.15 | [ 0.12,  0.19] |    7.87 | &lt; .001***
raq_12     |     raq_17 |  0.07 | [ 0.03,  0.11] |    3.71 | 0.002**  
raq_12     |     raq_18 |  0.10 | [ 0.06,  0.14] |    5.00 | &lt; .001***
raq_12     |     raq_19 |  0.07 | [ 0.03,  0.11] |    3.40 | 0.003**  
raq_12     |     raq_20 |  0.12 | [ 0.08,  0.16] |    6.27 | &lt; .001***
raq_12     |     raq_21 |  0.16 | [ 0.13,  0.20] |    8.42 | &lt; .001***
raq_12     |     raq_22 |  0.08 | [ 0.04,  0.12] |    4.05 | &lt; .001***
raq_12     |     raq_23 |  0.05 | [ 0.01,  0.09] |    2.70 | 0.014*   
raq_13     |     raq_14 |  0.27 | [ 0.24,  0.31] |   14.44 | &lt; .001***
raq_13     |     raq_15 |  0.29 | [ 0.25,  0.32] |   15.31 | &lt; .001***
raq_13     |     raq_16 |  0.15 | [ 0.11,  0.19] |    7.66 | &lt; .001***
raq_13     |     raq_17 |  0.18 | [ 0.14,  0.21] |    9.12 | &lt; .001***
raq_13     |     raq_18 |  0.34 | [ 0.31,  0.37] |   18.35 | &lt; .001***
raq_13     |     raq_19 |  0.26 | [ 0.22,  0.30] |   13.64 | &lt; .001***
raq_13     |     raq_20 |  0.16 | [ 0.12,  0.20] |    8.32 | &lt; .001***
raq_13     |     raq_21 |  0.17 | [ 0.14,  0.21] |    8.98 | &lt; .001***
raq_13     |     raq_22 |  0.23 | [ 0.19,  0.27] |   11.97 | &lt; .001***
raq_13     |     raq_23 |  0.14 | [ 0.10,  0.18] |    7.15 | &lt; .001***
raq_14     |     raq_15 |  0.23 | [ 0.20,  0.27] |   12.20 | &lt; .001***
raq_14     |     raq_16 |  0.08 | [ 0.05,  0.12] |    4.29 | &lt; .001***
raq_14     |     raq_17 |  0.17 | [ 0.13,  0.20] |    8.61 | &lt; .001***
raq_14     |     raq_18 |  0.26 | [ 0.22,  0.29] |   13.40 | &lt; .001***
raq_14     |     raq_19 |  0.22 | [ 0.18,  0.26] |   11.49 | &lt; .001***
raq_14     |     raq_20 |  0.15 | [ 0.11,  0.19] |    7.60 | &lt; .001***
raq_14     |     raq_21 |  0.17 | [ 0.13,  0.20] |    8.57 | &lt; .001***
raq_14     |     raq_22 |  0.22 | [ 0.18,  0.26] |   11.43 | &lt; .001***
raq_14     |     raq_23 |  0.13 | [ 0.09,  0.16] |    6.47 | &lt; .001***
raq_15     |     raq_16 |  0.11 | [ 0.07,  0.15] |    5.59 | &lt; .001***
raq_15     |     raq_17 |  0.21 | [ 0.18,  0.25] |   11.06 | &lt; .001***
raq_15     |     raq_18 |  0.32 | [ 0.29,  0.35] |   17.13 | &lt; .001***
raq_15     |     raq_19 |  0.23 | [ 0.19,  0.27] |   11.99 | &lt; .001***
raq_15     |     raq_20 |  0.16 | [ 0.12,  0.20] |    8.12 | &lt; .001***
raq_15     |     raq_21 |  0.17 | [ 0.13,  0.20] |    8.50 | &lt; .001***
raq_15     |     raq_22 |  0.24 | [ 0.20,  0.27] |   12.38 | &lt; .001***
raq_15     |     raq_23 |  0.15 | [ 0.11,  0.19] |    7.71 | &lt; .001***
raq_16     |     raq_17 |  0.18 | [ 0.14,  0.21] |    9.10 | &lt; .001***
raq_16     |     raq_18 |  0.12 | [ 0.09,  0.16] |    6.36 | &lt; .001***
raq_16     |     raq_19 |  0.14 | [ 0.10,  0.17] |    6.93 | &lt; .001***
raq_16     |     raq_20 |  0.23 | [ 0.20,  0.27] |   12.11 | &lt; .001***
raq_16     |     raq_21 |  0.26 | [ 0.23,  0.30] |   13.87 | &lt; .001***
raq_16     |     raq_22 |  0.11 | [ 0.07,  0.15] |    5.58 | &lt; .001***
raq_16     |     raq_23 |  0.10 | [ 0.06,  0.14] |    5.10 | &lt; .001***
raq_17     |     raq_18 |  0.25 | [ 0.22,  0.29] |   13.31 | &lt; .001***
raq_17     |     raq_19 |  0.20 | [ 0.16,  0.23] |   10.17 | &lt; .001***
raq_17     |     raq_20 |  0.22 | [ 0.18,  0.26] |   11.38 | &lt; .001***
raq_17     |     raq_21 |  0.26 | [ 0.22,  0.29] |   13.54 | &lt; .001***
raq_17     |     raq_22 |  0.21 | [ 0.17,  0.24] |   10.71 | &lt; .001***
raq_17     |     raq_23 |  0.14 | [ 0.10,  0.17] |    7.01 | &lt; .001***
raq_18     |     raq_19 |  0.30 | [ 0.26,  0.33] |   15.91 | &lt; .001***
raq_18     |     raq_20 |  0.18 | [ 0.14,  0.22] |    9.24 | &lt; .001***
raq_18     |     raq_21 |  0.19 | [ 0.16,  0.23] |    9.97 | &lt; .001***
raq_18     |     raq_22 |  0.27 | [ 0.23,  0.30] |   14.08 | &lt; .001***
raq_18     |     raq_23 |  0.13 | [ 0.09,  0.17] |    6.65 | &lt; .001***
raq_19     |     raq_20 |  0.16 | [ 0.13,  0.20] |    8.43 | &lt; .001***
raq_19     |     raq_21 |  0.18 | [ 0.15,  0.22] |    9.47 | &lt; .001***
raq_19     |     raq_22 |  0.42 | [ 0.39,  0.45] |   23.34 | &lt; .001***
raq_19     |     raq_23 |  0.44 | [ 0.41,  0.47] |   24.85 | &lt; .001***
raq_20     |     raq_21 |  0.35 | [ 0.31,  0.38] |   18.85 | &lt; .001***
raq_20     |     raq_22 |  0.17 | [ 0.13,  0.21] |    8.65 | &lt; .001***
raq_20     |     raq_23 |  0.11 | [ 0.08,  0.15] |    5.82 | &lt; .001***
raq_21     |     raq_22 |  0.18 | [ 0.14,  0.21] |    9.16 | &lt; .001***
raq_21     |     raq_23 |  0.14 | [ 0.10,  0.18] |    7.28 | &lt; .001***
raq_22     |     raq_23 |  0.40 | [ 0.37,  0.43] |   22.17 | &lt; .001***

p-value adjustment method: Holm (1979)
Observations: 2571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pipe into summary() to get a condensed table of correlations:</span></span>
<span id="cb14-2">correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(raq_items_tib) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">raq_23</th>
<th style="text-align: right;">raq_22</th>
<th style="text-align: right;">raq_21</th>
<th style="text-align: right;">raq_20</th>
<th style="text-align: right;">raq_19</th>
<th style="text-align: right;">raq_18</th>
<th style="text-align: right;">raq_17</th>
<th style="text-align: right;">raq_16</th>
<th style="text-align: right;">raq_15</th>
<th style="text-align: right;">raq_14</th>
<th style="text-align: right;">raq_13</th>
<th style="text-align: right;">raq_12</th>
<th style="text-align: right;">raq_11</th>
<th style="text-align: right;">raq_10</th>
<th style="text-align: right;">raq_09</th>
<th style="text-align: right;">raq_08</th>
<th style="text-align: right;">raq_07</th>
<th style="text-align: right;">raq_06</th>
<th style="text-align: right;">raq_05</th>
<th style="text-align: right;">raq_04</th>
<th style="text-align: right;">raq_03</th>
<th style="text-align: right;">raq_02</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">raq_01</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_02</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_03</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_05</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_06</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_07</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_08</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_09</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_10</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_11</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_12</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_13</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_14</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_15</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_16</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_17</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_18</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_19</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_20</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_21</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_22</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>because the items use Likert scales, should use <code>polychoric()</code> function from the <code>psych</code> package</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">raq_poly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">polychoric</span>(raq_items_tib)</span>
<span id="cb15-2">raq_poly</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: psych::polychoric(x = raq_items_tib)
Polychoric correlations 
       rq_01 rq_02 rq_03 rq_04 rq_05 rq_06 rq_07 rq_08 rq_09 rq_10 rq_11
raq_01  1.00                                                            
raq_02  0.12  1.00                                                      
raq_03 -0.20 -0.13  1.00                                                
raq_04  0.24  0.14 -0.22  1.00                                          
raq_05  0.25  0.31 -0.28  0.35  1.00                                    
raq_06  0.18  0.37 -0.18  0.26  0.57  1.00                              
raq_07  0.12  0.28 -0.14  0.18  0.40  0.50  1.00                        
raq_08  0.25  0.20 -0.24  0.28  0.40  0.38  0.28  1.00                  
raq_09  0.09  0.43 -0.09  0.11  0.18  0.22  0.18  0.18  1.00            
raq_10  0.12  0.20 -0.11  0.20  0.35  0.44  0.31  0.20  0.12  1.00      
raq_11  0.21  0.17 -0.21  0.25  0.35  0.33  0.24  0.64  0.19  0.19  1.00
raq_12  0.17  0.10 -0.16  0.21  0.21  0.13  0.10  0.14  0.07  0.08  0.11
raq_13  0.12  0.25 -0.14  0.18  0.39  0.50  0.34  0.22  0.17  0.27  0.22
raq_14  0.13  0.22 -0.10  0.16  0.30  0.39  0.28  0.25  0.14  0.24  0.20
raq_15  0.12  0.21 -0.17  0.21  0.36  0.45  0.32  0.25  0.16  0.27  0.22
raq_16  0.19  0.11 -0.22  0.30  0.27  0.18  0.13  0.23  0.09  0.14  0.19
raq_17  0.18  0.19 -0.19  0.26  0.33  0.31  0.23  0.61  0.16  0.20  0.51
raq_18  0.13  0.29 -0.17  0.19  0.42  0.56  0.39  0.31  0.16  0.32  0.27
raq_19  0.12  0.43 -0.13  0.16  0.32  0.42  0.28  0.23  0.51  0.23  0.21
raq_20  0.23  0.14 -0.26  0.32  0.38  0.25  0.16  0.29  0.11  0.20  0.30
raq_21  0.25  0.18 -0.29  0.36  0.41  0.29  0.22  0.33  0.19  0.18  0.32
raq_22  0.14  0.38 -0.13  0.17  0.30  0.36  0.25  0.25  0.48  0.17  0.22
raq_23  0.09  0.43 -0.06  0.09  0.19  0.19  0.18  0.16  0.60  0.08  0.14
       rq_12 rq_13 rq_14 rq_15 rq_16 rq_17 rq_18 rq_19 rq_20 rq_21 rq_22
raq_12  1.00                                                            
raq_13  0.08  1.00                                                      
raq_14  0.08  0.30  1.00                                                
raq_15  0.08  0.32  0.26  1.00                                          
raq_16  0.17  0.17  0.09  0.12  1.00                                    
raq_17  0.08  0.20  0.19  0.24  0.20  1.00                              
raq_18  0.11  0.38  0.28  0.35  0.14  0.28  1.00                        
raq_19  0.08  0.29  0.24  0.26  0.15  0.22  0.33  1.00                  
raq_20  0.14  0.18  0.16  0.18  0.26  0.24  0.20  0.18  1.00            
raq_21  0.18  0.19  0.18  0.18  0.29  0.29  0.21  0.20  0.39  1.00      
raq_22  0.09  0.26  0.25  0.26  0.12  0.23  0.30  0.46  0.19  0.20  1.00
raq_23  0.06  0.15  0.14  0.17  0.11  0.15  0.14  0.49  0.13  0.16  0.45
[1]  1.00

 with tau of 
          1     2       3    4
raq_01 -2.0 -0.99 -0.0229 1.01
raq_02 -2.0 -1.03  0.0532 1.03
raq_03 -2.0 -0.99 -0.0093 0.99
raq_04 -2.0 -0.99  0.0044 1.00
raq_05 -1.9 -1.00  0.0356 0.97
raq_06 -2.0 -0.99  0.0132 0.97
raq_07 -2.0 -1.01 -0.0278 0.95
raq_08 -2.0 -1.00 -0.0239 1.01
raq_09 -2.1 -1.02 -0.0288 0.97
raq_10 -2.0 -0.98  0.0307 0.97
raq_11 -2.0 -0.98 -0.0219 1.04
raq_12 -2.0 -1.04 -0.0219 1.00
raq_13 -2.0 -1.00 -0.0180 1.02
raq_14 -2.0 -1.00 -0.0424 0.95
raq_15 -2.0 -1.03 -0.0678 0.95
raq_16 -2.0 -0.99  0.0063 1.01
raq_17 -2.0 -1.02  0.0122 1.02
raq_18 -2.0 -1.03  0.0015 1.02
raq_19 -2.0 -0.98  0.0112 0.99
raq_20 -2.0 -0.99 -0.0336 0.96
raq_21 -2.1 -0.99 -0.0073 1.02
raq_22 -2.1 -1.05  0.0210 1.03
raq_23 -2.1 -1.01 -0.0015 1.01</code></pre>
</div>
</div>
<ul>
<li>matrix of correlations is stored in in a variable called <code>rho</code>, accessible with <code>raq_poly$rho</code> but we can store it in an object</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">raq_cor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> raq_poly<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rho</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.plot</span>(raq_cor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dsur_ch18_efa/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>note items close to 0 - no correlation</p></li>
<li><p>note items between $+/-$0.3</p></li>
<li><p>note items greater than <img src="https://latex.codecogs.com/png.latex?+/-"> 0.9 as those may be collinear or singular</p></li>
<li><p>in this case, all questions correlate reasonably well and none are excessively large</p></li>
</ul>
</section>
</section>
<section id="bartletts-test-and-kmo-test" class="level2">
<h2 class="anchored" data-anchor-id="bartletts-test-and-kmo-test">Bartlett’s test and KMO test</h2>
<section id="bartletts-test-of-sphericity" class="level3">
<h3 class="anchored" data-anchor-id="bartletts-test-of-sphericity">Bartlett’s test of Sphericity</h3>
<ul>
<li><p>tests whether the correlation matrix is significantly different from an identity matrix (whether the correlations are all 0</p>
<ul>
<li>in FA, sample sizes are large, so the test will almost always be significant, but if it is not, then there is a problem</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cortest.bartlett</span>(raq_cor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2571</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 17387.52

$p.value
[1] 0

$df
[1] 253</code></pre>
</div>
</div>
<ul>
<li>given large sample size, Bartlett’s test is highly significant, indicating there is not a significant problem</li>
</ul>
</section>
<section id="kaiser-meyer-olkin-kmo" class="level3">
<h3 class="anchored" data-anchor-id="kaiser-meyer-olkin-kmo">Kaiser-Meyer-Olkin (KMO)</h3>
<ul>
<li><p>check for sampling adequacy</p></li>
<li><p>KMO varies between 0 and 1 with 0 indicating FA is not appropriate</p></li>
<li><p>values closer to 1 indicate compact patterns of correlations and FA should reveal distinct and reliable factors</p>
<ul>
<li><p>Marvellous: values in the 0.90s</p></li>
<li><p>Meritorious: values in the 0.80s</p></li>
<li><p>Middling: values in the 0.70s</p></li>
<li><p>Mediocre: values in the 0.60s</p></li>
<li><p>Miserable: values in the 0.50s</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">KMO</span>(raq_cor)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: psych::KMO(r = raq_cor)
Overall MSA =  0.92
MSA for each item = 
raq_01 raq_02 raq_03 raq_04 raq_05 raq_06 raq_07 raq_08 raq_09 raq_10 raq_11 
  0.95   0.94   0.93   0.93   0.95   0.91   0.96   0.86   0.84   0.95   0.89 
raq_12 raq_13 raq_14 raq_15 raq_16 raq_17 raq_18 raq_19 raq_20 raq_21 raq_22 
  0.90   0.95   0.96   0.96   0.92   0.90   0.95   0.93   0.93   0.93   0.94 
raq_23 
  0.84 </code></pre>
</div>
</div>
<ul>
<li><p>KMO statistic (Overall MSA) is 0.92 - well above the threshold of 0.5</p></li>
<li><p>MSA for each individual item ranges from 0.84 - 0.96</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you find KMO values below 0.5, consider removing that variable, but be sure to run the KMO statistic again without the removed variable. Also run the analysis with and without the variable to compare</p>
</div>
</div>
</section>
</section>
<section id="parallel-analysis" class="level2">
<h2 class="anchored" data-anchor-id="parallel-analysis">Parallel analysis</h2>
<ul>
<li><p>to determine how many factors to extract, run <code>psych::fa.parallel()</code></p></li>
<li><p>most likely arguments</p>
<ul>
<li><p><code>n.obs() - need to tell the function the sample size (`n.obs = 2571`)</code></p></li>
<li><p><code>fm = “minres”</code> - <code>psych</code> packages uses minimum residual (minres) by default</p>
<ul>
<li>other options include principal axes (<code>pa</code>), alpha factoring (<code>alpha</code>), weighted least squares <code>wls</code>, minimum rank (<code>minrank</code>), or maximum likelihood (<code>ml</code>). Match this option to the one you’re going to use in the main factor analysis</li>
</ul></li>
<li><p><code>fa = "both"</code> - by default the function will tell the number of factors to extract, but also the number of components for PCA.</p>
<ul>
<li>can change to <code>fa = "fa</code>” to see only the number of factors to extract. It is useful to look at both methods</li>
</ul></li>
<li><p><code>use = “pairwise”</code> - by default, missing data are handled using all complete pairwise observations to calculate the correlation coefficients</p></li>
<li><p><code>cor</code> - default is the function assumes you are providing Pearson correlation coefficients, however, with ordinal variables (likert), use <code>cor = "poly"</code> (polychoric) and for binary, use tetrachoric <code>cor = "tet"</code>; with a mix of variable types, use <code>cor ="mixed"</code></p></li>
</ul></li>
</ul>
<section id="code-example" class="level3">
<h3 class="anchored" data-anchor-id="code-example">Code example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa.parallel</span>(raq_items_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cor =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dsur_ch18_efa/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  4 </code></pre>
</div>
</div>
<ul>
<li>or since we already stored polychoric correlations in <code>raq_cor</code>, we can just apply the function to that correlation matrix and specify the sample size</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa.parallel</span>(raq_cor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.obs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2571</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fa =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fa"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dsur_ch18_efa/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  NA </code></pre>
</div>
</div>
<ul>
<li><p>eigenvalues represent the size of the factor</p></li>
<li><p>factors are plotted on the x-axis with the eigenvalues on the y-axis</p></li>
<li><p>each eigenvalue is compared to an eigenvalue from a simulated data set that has no underlying factors</p>
<ul>
<li><p>essentially, we are asking if the factors are bigger than imaginary factor</p></li>
<li><p>factors that are bigger than their imaginary counterparts are retained</p></li>
</ul></li>
<li><p>eigenvalues for the observed factors are blue triangles connected by a blue line.</p></li>
<li><p>the red line shows corresponding simulated data.</p></li>
<li><p>we keep the number of factors that are above the red line, in this case, four</p></li>
</ul>
</section>
<section id="quiz" class="level3">
<h3 class="anchored" data-anchor-id="quiz">Quiz</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Based on the parallel analysis that used principal components to compute the eiegenvalues, how many factors should be extracted?</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>4</li>
</ul>
<p>Yes, fortunately this analysis agrees with the parallel analysis based on eigenvalues from factor analysis.</p>
</div>
</div>
</div>
</section>
</section>
<section id="factor-analysis" class="level2">
<h2 class="anchored" data-anchor-id="factor-analysis">Factor Analysis</h2>
<ul>
<li>we are now ready to run the FA, extracting four factors, using the <code>psych::fa()</code> function</li>
</ul>
<pre><code>my_fa_object &lt;- psych::fa(r,    
                          n.obs = 2571,  
                          nfactors = 1,  
                          fm = "minres", 
                          rotate = "oblimin", 
                          scores = "regression", 
                          max.iter = 50, 
                          use = "pairwise", 
                          cor = "cor" 
                          )</code></pre>
<ul>
<li><code>r</code> -&gt; the data being fed into the function (<code>raq_items_tib</code> or <code>raq_cor</code>)</li>
<li><code>n.obs = 2571</code> as with parallel analysis, if we run the FA from the correlation matrix instead of the raw data, we must tell the function the sample size</li>
<li><code>nfactors = 1</code> the number of factors to extract (default is 1)</li>
<li><code>fm = "minres"</code> method of factor analysis, typically leave the default</li>
<li><code>rotate = "oblimin"</code> method of factor rotation</li>
<li><code>scores = "regression"</code> method of computing factor scores. because we should use oblique rotation, change this argument to <code>scores = "tenBerge"</code></li>
<li><code>max.iter = 50</code> number of iterations. If you get a n error message about convergence, increase this number</li>
<li><code>use = "pairwise"</code> determines how missing values are treated, default is fine</li>
<li><code>cor = "cor"</code> same as defined for <code>fa.parallel()</code></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Factor rotation
</div>
</div>
<div class="callout-body-container callout-body">
<p>factor rotation requires <code>GPArotation</code> package loaded</p>
</div>
</div>
<section id="code-example-1" class="level3">
<h3 class="anchored" data-anchor-id="code-example-1">Code Example</h3>
<ul>
<li>as with parallel analysis we can either feed the raw data into the function remembering to set <code>cor = "poly"</code> so the analysis is based on polychoric correlations</li>
<li>or we can feed in the correlation matrix and sample size</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">raq_fa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(raq_items_tib, </span>
<span id="cb28-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb28-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scores =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tenBerge"</span>, </span>
<span id="cb28-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cor =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span></span>
<span id="cb28-5">  )</span>
<span id="cb28-6">  raq_fa </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: psych::fa(r = raq_items_tib, nfactors = 4, scores = "tenBerge", 
    cor = "poly")
Standardized loadings (pattern matrix) based upon correlation matrix
         MR1   MR2   MR4   MR3   h2   u2 com
raq_01 -0.03  0.01  0.39  0.06 0.17 0.83 1.1
raq_02  0.25  0.48  0.02 -0.03 0.38 0.62 1.5
raq_03  0.00  0.01 -0.43 -0.03 0.20 0.80 1.0
raq_04  0.03 -0.02  0.56  0.00 0.33 0.67 1.0
raq_05  0.45 -0.01  0.39  0.02 0.54 0.46 2.0
raq_06  0.84  0.00 -0.01  0.03 0.73 0.27 1.0
raq_07  0.56  0.04  0.00  0.04 0.35 0.65 1.0
raq_08  0.00 -0.01 -0.01  0.88 0.75 0.25 1.0
raq_09 -0.07  0.81  0.00  0.03 0.62 0.38 1.0
raq_10  0.49 -0.05  0.09 -0.02 0.26 0.74 1.1
raq_11 -0.01  0.01  0.03  0.72 0.55 0.45 1.0
raq_12 -0.01  0.01  0.37 -0.07 0.11 0.89 1.1
raq_13  0.57  0.03  0.04 -0.03 0.34 0.66 1.0
raq_14  0.42  0.04  0.01  0.06 0.22 0.78 1.1
raq_15  0.48  0.03  0.03  0.05 0.29 0.71 1.0
raq_16 -0.05  0.02  0.51 -0.01 0.23 0.77 1.0
raq_17  0.03  0.02  0.00  0.68 0.49 0.51 1.0
raq_18  0.63  0.01 -0.02  0.07 0.43 0.57 1.0
raq_19  0.26  0.56  0.00 -0.01 0.50 0.50 1.4
raq_20  0.00  0.01  0.54  0.05 0.32 0.68 1.0
raq_21 -0.02  0.05  0.59  0.06 0.40 0.60 1.0
raq_22  0.19  0.52  0.03  0.05 0.41 0.59 1.3
raq_23 -0.08  0.79  0.02 -0.01 0.59 0.41 1.0

                       MR1  MR2  MR4  MR3
SS loadings           3.04 2.24 2.03 1.91
Proportion Var        0.13 0.10 0.09 0.08
Cumulative Var        0.13 0.23 0.32 0.40
Proportion Explained  0.33 0.24 0.22 0.21
Cumulative Proportion 0.33 0.57 0.79 1.00

 With factor correlations of 
     MR1  MR2  MR4  MR3
MR1 1.00 0.38 0.50 0.48
MR2 0.38 1.00 0.28 0.28
MR4 0.50 0.28 1.00 0.57
MR3 0.48 0.28 0.57 1.00

Mean item complexity =  1.1
Test of the hypothesis that 4 factors are sufficient.

df null model =  253  with the objective function =  6.79 with Chi Square =  17387.52
df of  the model are 167  and the objective function was  0.1 

The root mean square of the residuals (RMSR) is  0.01 
The df corrected root mean square of the residuals is  0.02 

The harmonic n.obs is  2571 with the empirical chi square  205.03  with prob &lt;  0.024 
The total n.obs was  2571  with Likelihood Chi Square =  267.21  with prob &lt;  1.3e-06 

Tucker Lewis Index of factoring reliability =  0.991
RMSEA index =  0.015  and the 90 % confidence intervals are  0.012 0.019
BIC =  -1044.08
Fit based upon off diagonal values = 1
Measures of factor score adequacy             
                                                   MR1  MR2  MR4  MR3
Correlation of (regression) scores with factors   0.93 0.91 0.88 0.92
Multiple R square of scores with factors          0.87 0.83 0.77 0.85
Minimum correlation of possible factor scores     0.73 0.66 0.54 0.70</code></pre>
</div>
</div>
<ul>
<li>factors are labeled <code>MR1</code>, <code>MR2</code>, <code>MR3</code>, and <code>MR4</code></li>
<li>below the pattern matrix is information about how much variance each factor accounts for
<ul>
<li><code>Proportion var</code> - <code>MR1</code> accounts for 0.13 of the overall variance (13%), etc</li>
<li><code>Cumulative var</code> is the proportion of the variance explained cumulatively by the factors - <code>MR1</code> accounts for 0.13 and <code>MR1</code> + <code>MR2</code> together account for 0.13 + 0.10 = 0.23 (23%)
<ul>
<li>all four together account for 0.40 (40%)</li>
</ul></li>
<li><code>Proportion explained</code> is the proportion of the explained variance that is explained by a factor, so of the 40% of the variiance accounted for, 0.33 (33%) is attributable to <code>MR1</code></li>
</ul></li>
<li>next, correlations between factors are displayed
<ul>
<li>all are non-zero, indicating the factors are correlated (and oblique rotation was appropriate)</li>
<li>all factors are positively and fairly strongly correlated to teach other meaning the latent constructs represented by the factors are related.</li>
</ul></li>
<li>several fit indices that tell us how the model fits the data
<ul>
<li>chi-square statistic for the model is given as the <code>likelihood chi square</code>, <img src="https://latex.codecogs.com/png.latex?X%5E2=267.21,%20p%3C0.001">
<ul>
<li>we want this to be non-significant but ours is highly significant. Our sample size is 2571 so small deviations from a good fit will be significant. This highlights the limitation of using significance to indicate model fit.</li>
<li>the Tucker Lewis Index of factoring reliability (TLI) is given as 0.991</li>
<li>RMSEA is 0.015 90% CI[0.012, 0.019]</li>
<li>RMSR is 0.01</li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fit Indices
</div>
</div>
<div class="callout-body-container callout-body">
<p>Good fit is (probably) indicated by</p>
<ul>
<li>combination of TLI &gt; 0.96, and SRMR (RMSR in the output) &lt; 0.06</li>
<li>combination of RMSEA &lt; 0.05 and SRMR &lt; 0.09</li>
</ul>
<p>The TLI is 0.99, which is greater than 0.96, and RMSR is 0.01 which is smaller than both 0.09 and 0.06. Furthermore, RMSEA is 0.015, which is less than 0.05. With the caveat that universal cut-offs need to be taken with a pinch of salt, it’s reasonable to conclude that the model has excellent fit.</p>
</div>
</div>
</section>
<section id="interpreting-fa" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-fa">Interpreting FA</h3>
<ul>
<li>look at factor loadings (top of output in the pattern matrix) for each question on each factor to see which items load most heavily onto which factors</li>
<li>this is difficult to interpret in the raw form, so use <code>parameters::model_parameters()</code> to sort items by their factor loadings and suppress factor loading sbelow a certain value</li>
</ul>
<p>General form</p>
<pre><code>parameters::model_parameters(my_fa_object, sort = TRUE, threshold = "max")</code></pre>
<ul>
<li><code>my_fa_object</code> is the factor analysis object containing the factor loadings.</li>
<li><code>sort = "TRUE"</code> sorts items by their factor loadings</li>
<li>set <code>threshold</code> to a value above which we will show values. Default is maximum loading. To see all factor loadings, set <code>threshold = NULL</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(raq_fa, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb31-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">MR1</th>
<th style="text-align: right;">MR2</th>
<th style="text-align: right;">MR4</th>
<th style="text-align: right;">MR3</th>
<th style="text-align: right;">Complexity</th>
<th style="text-align: right;">Uniqueness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">raq_06</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_18</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_13</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_07</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_10</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_15</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_05</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_14</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_09</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_19</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">0.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_02</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_04</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_03</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_01</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_12</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_08</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">raq_11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raq_17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.51</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Now we can see patterns in the questions that load onto the same factors</li>
<li>Items that load highly on <code>MR1</code> seem to be items that relate to fear of computers
<ul>
<li>raq_05: I don’t understand statistics (also loads highly onto <code>MR4</code>)</li>
<li>raq_06: I have little experience of computers</li>
<li>raq_07: All computers hate me</li>
<li>raq_10: Computers are useful only for playing games</li>
<li>raq_13: I worry that I will cause irreparable damage because of my incompetence with computers</li>
<li>raq_14: Computers have minds of their own and deliberately go wrong whenever I use them</li>
<li>raq_15: Computers are out to get me</li>
<li>raq_18: R always crashes when I try to use it</li>
</ul></li>
<li>Items that load onto <code>MR2</code> relate to fear of peer/social evaluation
<ul>
<li>raq_02: My friends will think I’m stupid for not being able to cope with R</li>
<li>raq_09: My friends are better at statistics than me</li>
<li>raq_19: Everybody looks at me when I use R</li>
<li>raq_22: My friends are better at R than I am</li>
<li>raq_23: If I am good at statistics people will think I am a nerd</li>
</ul></li>
<li>Questions that load onto <code>MR4</code> relate to fear of statistics
<ul>
<li>raq_01: Statistics make me cry</li>
<li>raq_03: Standard deviations excite me</li>
<li>raq_04: I dream that Pearson is attacking me with correlation coefficients</li>
<li>raq_05: I don’t understand statistics</li>
<li>raq_12: People try to tell you that R makes statistics easier to understand but it doesn’t</li>
<li>raq_16: I weep openly at the mention of central tendency</li>
<li>raq_20: I can’t sleep for thoughts of eigenvectors</li>
<li>raq_21: I wake up under my duvet thinking that I am trapped under a normal distribution</li>
</ul></li>
<li>questions that load onto <code>MR3</code> relate to fear of math
<ul>
<li>raq_08: I have never been good at mathematics</li>
<li>raq_11: I did badly at mathematics at school</li>
<li>raq_17: I slip into a coma whenever I see an equation</li>
</ul></li>
</ul>
<p>Analysis seems to reveal that the questionnaire is composed of four subscales: fear of statistics, fear of computers, fear of maths, fear of negative peer evaluation.</p>
<ul>
<li>two possibilities:
<ul>
<li>the RAQ failed to measure what it set out to measure -&gt; R anxiety but instead measures related constructs</li>
<li>these four constructs are subcomponents of R anxiety</li>
</ul></li>
<li>However, the factor analysis does not indicate which of these is true.</li>
</ul>
</section>
</section>
<section id="reliability-analysis" class="level2">
<h2 class="anchored" data-anchor-id="reliability-analysis">Reliability Analysis</h2>
<section id="mcdonalds-omega_t-and-omega_h" class="level3">
<h3 class="anchored" data-anchor-id="mcdonalds-omega_t-and-omega_h">McDonald’s <img src="https://latex.codecogs.com/png.latex?%5Comega_t"> and <img src="https://latex.codecogs.com/png.latex?%5Comega_h"></h3>
<ul>
<li>if items are all scored in the same direction, we can select the variables on a particular subscale and pipe them into <code>omega()</code> functions in the <code>psych</code> package</li>
</ul>
<pre><code>my_omg &lt;- psych::omega(
    my_tibble
    nfactors = 1,
    fm = "minres",
    key = c(1, 1, -1, 1, 1 … 1),
    rotate = "oblimin",
    poly = FALSE
  )</code></pre>
<dl>
<dt><code>my_omg</code></dt>
<dd>
<p>name to give the object that stores the results</p>
</dd>
<dt><code>my_tibble</code></dt>
<dd>
<p>name of the tibble containing your data</p>
</dd>
</dl>
</section>
<section id="code-example-2" class="level3">
<h3 class="anchored" data-anchor-id="code-example-2">Code Example</h3>
<ul>
<li>need to recreate the original FA</li>
<li>arguments will be the same as they were set for the fa</li>
<li>the <code>key</code> argument allows us to reverse item scoring on the fly</li>
<li>supply the key argument with a vector of 1s and -1s that is the same length as the number of variables being fed into the <code>omega()</code> function</li>
<li>for RAQ, we have 23 items with the third being reverse coded</li>
<li>entering the items in order into <code>omega()</code> gives</li>
</ul>
<pre><code>key = c(1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)</code></pre>
<p>or</p>
<pre><code>key = c(1, 1, -1, rep(1, 20))</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">raq_omg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">omega</span>(raq_items_tib,</span>
<span id="cb35-2">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb35-3">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"minres"</span>,</span>
<span id="cb35-4">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)),</span>
<span id="cb35-5">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">poly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb35-6">                        )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/dsur_ch18_efa/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">raq_omg</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Omega 
Call: omegah(m = m, nfactors = nfactors, fm = fm, key = key, flip = flip, 
    digits = digits, title = title, sl = sl, labels = labels, 
    plot = plot, n.obs = n.obs, rotate = rotate, Phi = Phi, option = option, 
    covar = covar)
Alpha:                 0.88 
G.6:                   0.89 
Omega Hierarchical:    0.68 
Omega H asymptotic:    0.75 
Omega Total            0.9 

Schmid Leiman Factor loadings greater than  0.2 
           g   F1*   F2*   F3*   F4*    h2   h2   u2   p2  com
raq_01  0.32              0.26             0.17 0.83 0.57 1.99
raq_02  0.37        0.43              0.38 0.38 0.62 0.37 2.34
raq_03- 0.34              0.29        0.20 0.20 0.80 0.56 1.97
raq_04  0.43              0.38        0.33 0.33 0.67 0.56 1.98
raq_05  0.62  0.32        0.27        0.54 0.54 0.46 0.70 1.90
raq_06  0.61  0.60                    0.73 0.73 0.27 0.51 2.00
raq_07  0.44  0.39                    0.35 0.35 0.65 0.54 2.00
raq_08  0.62                    0.61  0.75 0.75 0.25 0.51 2.00
raq_09  0.32        0.73              0.62 0.62 0.38 0.17 1.39
raq_10  0.37  0.35                    0.26 0.26 0.74 0.53 2.07
raq_11  0.54                    0.50  0.55 0.55 0.45 0.54 1.99
raq_12  0.22              0.25             0.11 0.89 0.44 2.05
raq_13  0.42  0.40                    0.34 0.34 0.66 0.51 2.02
raq_14  0.36  0.30                    0.22 0.22 0.78 0.59 1.98
raq_15  0.41  0.34                    0.29 0.29 0.71 0.59 1.97
raq_16  0.34              0.34        0.23 0.23 0.77 0.49 2.02
raq_17  0.52                    0.47  0.49 0.49 0.51 0.55 1.99
raq_18  0.48  0.44                    0.43 0.43 0.57 0.54 2.02
raq_19  0.43        0.51              0.50 0.50 0.50 0.37 2.23
raq_20  0.43              0.36        0.32 0.32 0.68 0.58 1.95
raq_21  0.49              0.40        0.40 0.40 0.60 0.59 1.97
raq_22  0.41        0.46              0.41 0.41 0.59 0.41 2.16
raq_23  0.30        0.71              0.59 0.59 0.41 0.15 1.35

With Sums of squares  of:
   g  F1*  F2*  F3*  F4*   h2 
4.40 1.39 1.71 0.85 0.86 4.37 

general/max  1.01   max/min =   5.15
mean percent general =  0.49    with sd =  0.13 and cv of  0.26 
Explained Common Variance of the general factor =  0.48 

The degrees of freedom are 167  and the fit is  0.1 
The number of observations was  2571  with Chi Square =  267.21  with prob &lt;  1.3e-06
The root mean square of the residuals is  0.01 
The df corrected root mean square of the residuals is  0.02
RMSEA index =  0.015  and the 90 % confidence intervals are  0.012 0.019
BIC =  -1044.08

Compare this with the adequacy of just a general factor and no group factors
The degrees of freedom for just the general factor are 230  and the fit is  2.39 
The number of observations was  2571  with Chi Square =  6122.42  with prob &lt;  0
The root mean square of the residuals is  0.1 
The df corrected root mean square of the residuals is  0.11 

RMSEA index =  0.1  and the 90 % confidence intervals are  0.098 0.102
BIC =  4316.45 

Measures of factor score adequacy             
                                                 g  F1*  F2*   F3*  F4*
Correlation of scores with factors            0.84 0.76 0.87  0.67 0.74
Multiple R square of scores with factors      0.71 0.57 0.75  0.44 0.55
Minimum correlation of factor score estimates 0.42 0.14 0.51 -0.11 0.10

 Total, General and Subset omega for each subset
                                                 g  F1*  F2*  F3*  F4*
Omega total for total scores and subscales    0.90 0.83 0.80 0.69 0.81
Omega general for total scores and subscales  0.68 0.48 0.23 0.38 0.43
Omega group for total scores and subscales    0.18 0.35 0.56 0.31 0.38</code></pre>
</div>
</div>
<ul>
<li><p>note the table of factor loadings and that <code>raq_03-</code> is labeled with a minus to indicate it is reverse coded</p></li>
<li><p>column labeled <code>g</code>shows the loading of each item on the general factor</p>
<ul>
<li>if any items load poorly, then a common factor model isn’t appropriate</li>
<li>all items here have a factor loading far enough from zero that a general factor model is appropriate</li>
</ul></li>
<li><p>Columns F1-F4 show the loadings of each item on the four factors we extracted</p>
<ul>
<li>these values differ from the original factor analysis because this one includes a general factor</li>
<li>the patterns of item loadings to factors follow the same pattern as the original FA</li>
</ul></li>
<li><p>at the top of the text output are reliability estimates for the general factor, including</p>
<ul>
<li>Chronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha=0.88"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Comega_h=0.68"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Comega_t=0.9"></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Comega_h"> is a measure of how much the items reflect a single construct, and a value of 0.68 suggests they do but there is still a lot of unexplained variance in the general factor</p></li>
<li><p>further down in the output, we see that only 48% of the variance in the common factor is explained by the items</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Comega_t"> is the total reliability and 0.90 is high, suggesting scores are reliable</p></li>
<li><p>next are two sets of model fit stats</p></li>
<li><p>the first set are for the model that has four factors and repeat the nformation from the original EFA</p>
<ul>
<li><code>chi-square</code> is significant, <img src="https://latex.codecogs.com/png.latex?X%5E2=%20267.21,%20p%3C0.001">, which is a bad thing but unsurprising given the sample size</li>
<li><code>RMSR = 0.01</code></li>
<li><code>RMSEA = 0.02 90% CI[0.01-0.02]</code></li>
</ul></li>
<li><p>Next is the same information but for the model that contains only the general factor and not the four sub-factors</p>
<ul>
<li>the fit gets worse as shown by
<ul>
<li>larger and more significant <code>chi-square, $X^2=6122.42, p&lt;0.001$</code></li>
<li>larger <code>RMSR=0.10</code></li>
<li>larger <code>RMSEA=0.1090% CI[0.10, 0.10]</code></li>
</ul></li>
</ul></li>
<li><p>all this tells us that the model that characterizes the RAQ in terms of four factors is a better fit of the data than a model that characterises it as a single factor</p></li>
<li><p>finally, under the Total, General, and Subset omega for each subset, we get the <img src="https://latex.codecogs.com/png.latex?%5Comega_t"> (labeled omega total) and <img src="https://latex.codecogs.com/png.latex?%5Comega_h"> (labeled omega general) for the general factor (column <code>g</code>) and for the subfactors.</p></li>
<li><p>values for the general factor repeat the information at tht e start of the output</p></li>
<li><p>the values for the subfactors are particularly relvant for <img src="https://latex.codecogs.com/png.latex?%5Comega_t"> because it represents the total reliability of the scores, so these values tell us the total reliability of the scores from the underlying subscales</p>
<ul>
<li>for anxiety related to computers (F1) we have <img src="https://latex.codecogs.com/png.latex?%5Comega_t=0.83"></li>
<li>anxiety around peer or social evaluation (F2) $_t=0.80</li>
<li>anxiety around statistics (F3) <img src="https://latex.codecogs.com/png.latex?%5Comega_t=0.69"></li>
<li>anxiety around maths (F4) <img src="https://latex.codecogs.com/png.latex?%5Comega_t=0.81"></li>
</ul></li>
<li><p>scores from ach subscale are reliable, although somewhat less so for anxiety around statistics</p></li>
</ul>
</section>
</section>
<section id="cronbachs-alpha" class="level2">
<h2 class="anchored" data-anchor-id="cronbachs-alpha">Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha"></h2>
<ul>
<li>Lots of reasons not to use Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha"> (see the book for details)</li>
<li>if Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha"> is needed, it must be computed on the individual subscales
<ul>
<li>Anxiety related to computers: raq_06, raq_07, raq_10, raq_13, raq_14, raq_15 and raq_18</li>
<li>Anxiety around peer or social evaluation: raq_02, raq_09, raq_19, raq_22, and raq_2</li>
<li>Anxiety around statistics: raq_01, raq_03 (reverse scored), raq_04, raq_05, raq_12, raq_16, raq_20, and raq_21</li>
<li>Anxiety around maths: raq_08, raq_11 and raq_17</li>
</ul></li>
<li>pipe the variables for each subscale into <code>psych::alpha()</code> function</li>
</ul>
<section id="code-example-for-fear-of-computers" class="level3">
<h3 class="anchored" data-anchor-id="code-example-for-fear-of-computers">Code example for <code>fear of computers</code></h3>
<ul>
<li>example excludes <code>raq_05</code>, which makes more sense on the fear of statistics factor [<a href="https://github.com/profandyfield/discovr/issues/19">See github issue</a>]</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">raq_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(raq_06, raq_07, raq_10, raq_13, raq_14, raq_15, raq_18) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-3">  psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = dplyr::select(raq_tib, raq_06, raq_07, raq_10, 
    raq_13, raq_14, raq_15, raq_18))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.77      0.77    0.75      0.32 3.3 0.0069  3.5 0.64     0.29

    95% confidence boundaries 
         lower alpha upper
Feldt     0.75  0.77  0.78
Duhachek  0.76  0.77  0.78

 Reliability if an item is dropped:
       raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
raq_06      0.70      0.70    0.66      0.28 2.3   0.0092 0.0015  0.28
raq_07      0.74      0.74    0.71      0.32 2.9   0.0079 0.0075  0.29
raq_10      0.75      0.75    0.73      0.34 3.1   0.0075 0.0068  0.32
raq_13      0.74      0.74    0.71      0.32 2.9   0.0079 0.0074  0.29
raq_14      0.76      0.76    0.73      0.35 3.2   0.0073 0.0065  0.32
raq_15      0.75      0.75    0.72      0.33 3.0   0.0076 0.0076  0.31
raq_18      0.73      0.73    0.70      0.31 2.7   0.0082 0.0063  0.29

 Item statistics 
          n raw.r std.r r.cor r.drop mean   sd
raq_06 2571  0.79  0.79  0.77   0.68  3.5 0.99
raq_07 2571  0.65  0.65  0.56   0.49  3.5 1.00
raq_10 2571  0.59  0.59  0.48   0.42  3.5 1.00
raq_13 2571  0.64  0.64  0.55   0.48  3.5 0.98
raq_14 2571  0.57  0.57  0.45   0.39  3.5 1.00
raq_15 2571  0.61  0.61  0.51   0.44  3.5 0.99
raq_18 2571  0.67  0.68  0.60   0.53  3.5 0.97

Non missing response frequency for each item
          1    2    3    4    5 miss
raq_06 0.02 0.14 0.35 0.33 0.17    0
raq_07 0.02 0.13 0.33 0.34 0.17    0
raq_10 0.02 0.14 0.35 0.32 0.17    0
raq_13 0.02 0.14 0.33 0.35 0.15    0
raq_14 0.02 0.13 0.33 0.35 0.17    0
raq_15 0.02 0.13 0.32 0.35 0.17    0
raq_18 0.02 0.13 0.35 0.35 0.15    0</code></pre>
</div>
</div>
<ul>
<li><p>value at the top is Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha">, with the 95% CI below.</p></li>
<li><p>looking for between 0.70 and 0.80, in this case Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha">=0.77 [0.75, 0.78] indicating good reliability</p></li>
<li><p>next is a table of statistics for the scale if we deleted each item in turn</p></li>
<li><p>the values in the column <code>raw_alpha</code> are the values of the overall <img src="https://latex.codecogs.com/png.latex?%5Calpha"></p></li>
<li><p>we are looking for a change in Cronbach’s <img src="https://latex.codecogs.com/png.latex?%5Calpha"> (0.77)</p>
<ul>
<li>if values are greater than 0.77, then reliability would have improved if the item were removed - not the case here</li>
</ul></li>
<li><p>the table labeled <code>item statistics</code> shows, in <code>raw.r</code>, the correlations between each item and the total score from the scale - <code>item-total correlations</code></p>
<ul>
<li>there is a problem with this statistic in that the item is included in the scale total, which inflates the overall correlation.</li>
<li>we want these correlations to be computed without the item in question, and these values are in <code>r.drop</code></li>
<li>in a reliable scale all items should correlate with the total, so we’re looking for items that don’t correlate with the overall score from the subscale. If any values of <code>r.drop</code> are elss than 0.3, we have problems becasuse that means an item does not correlate well with the subscale
<ul>
<li>0.3 is ‘reasonable’ - use your judgement</li>
</ul></li>
</ul></li>
<li><p>the final table tells us what percentage of people gave each response to each of the items, which is useful to make sure everyone in the sample is not giving the same response.</p>
<ul>
<li>usually, if everyone gives the same response, the item will have poor reliability statistics</li>
<li>for this subscale, few people responded with a 1 on any of the items suggesting that no one is feeling the love for computers or that the items are doing a poor job of eliciting those extreme responses</li>
</ul></li>
</ul>
</section>
<section id="code-example-for-fear-of-peersocial-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="code-example-for-fear-of-peersocial-evaluation">Code example for <code>fear of peer/social evaluation</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">raq_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(raq_02, raq_09, raq_19, raq_22, raq_23)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-3">  psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = dplyr::select(raq_tib, raq_02, raq_09, raq_19, 
    raq_22, raq_23))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.78      0.78    0.75      0.42 3.6 0.0067  3.5 0.72     0.41

    95% confidence boundaries 
         lower alpha upper
Feldt     0.77  0.78   0.8
Duhachek  0.77  0.78   0.8

 Reliability if an item is dropped:
       raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
raq_02      0.77      0.77    0.71      0.45 3.3   0.0075 0.0027  0.43
raq_09      0.72      0.72    0.67      0.40 2.6   0.0089 0.0011  0.40
raq_19      0.74      0.74    0.69      0.42 2.8   0.0084 0.0049  0.40
raq_22      0.76      0.76    0.71      0.44 3.1   0.0078 0.0038  0.42
raq_23      0.73      0.73    0.67      0.41 2.7   0.0086 0.0018  0.40

 Item statistics 
          n raw.r std.r r.cor r.drop mean   sd
raq_02 2571  0.68  0.69  0.55   0.49  3.5 0.97
raq_09 2571  0.77  0.77  0.70   0.62  3.5 0.99
raq_19 2571  0.74  0.74  0.64   0.57  3.5 1.00
raq_22 2571  0.70  0.71  0.59   0.52  3.5 0.96
raq_23 2571  0.76  0.76  0.68   0.60  3.5 0.98

Non missing response frequency for each item
          1    2    3    4    5 miss
raq_02 0.02 0.13 0.37 0.33 0.15    0
raq_09 0.02 0.13 0.33 0.34 0.17    0
raq_19 0.02 0.14 0.34 0.34 0.16    0
raq_22 0.02 0.13 0.36 0.34 0.15    0
raq_23 0.02 0.14 0.34 0.34 0.16    0</code></pre>
</div>
</div>
<ul>
<li>good overall reliability (<img src="https://latex.codecogs.com/png.latex?%5Calpha=0.78%20%5Bo.77,%200.80%5D">)</li>
<li>no items improve the value if they are dropped</li>
<li>item correlations with the total are all good</li>
<li>again we have issues with the items not eliciting extremely low responses</li>
</ul>
</section>
<section id="code-example-for-fear-of-maths" class="level3">
<h3 class="anchored" data-anchor-id="code-example-for-fear-of-maths">Code example for <code>fear of maths</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">raq_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(raq_08, raq_11, raq_17)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-3">  psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = dplyr::select(raq_tib, raq_08, raq_11, raq_17))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.77      0.77     0.7      0.53 3.4 0.0078  3.5 0.81     0.55

    95% confidence boundaries 
         lower alpha upper
Feldt     0.76  0.77  0.79
Duhachek  0.76  0.77  0.79

 Reliability if an item is dropped:
       raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
raq_08      0.63      0.63    0.47      0.47 1.7    0.014    NA  0.47
raq_11      0.71      0.71    0.55      0.55 2.4    0.012    NA  0.55
raq_17      0.74      0.74    0.58      0.58 2.8    0.010    NA  0.58

 Item statistics 
          n raw.r std.r r.cor r.drop mean   sd
raq_08 2571  0.86  0.86  0.75   0.66  3.5 0.98
raq_11 2571  0.82  0.82  0.68   0.60  3.5 0.99
raq_17 2571  0.81  0.81  0.65   0.57  3.5 0.97

Non missing response frequency for each item
          1    2    3    4    5 miss
raq_08 0.02 0.14 0.33 0.35 0.16    0
raq_11 0.02 0.14 0.33 0.36 0.15    0
raq_17 0.02 0.13 0.35 0.34 0.15    0</code></pre>
</div>
</div>
<ul>
<li>fairly high reliability (<img src="https://latex.codecogs.com/png.latex?%5Calpha=0.77%20%5B0.76,%200.79%5D">)</li>
<li>no items improve value if they are dropped</li>
<li>item correlations with the total subscale are all good</li>
<li>still issues with items not eliciting low responses</li>
</ul>
</section>
<section id="code-example-for-fear-of-statistics" class="level3">
<h3 class="anchored" data-anchor-id="code-example-for-fear-of-statistics">Code example for <code>fear of statistics</code></h3>
<ul>
<li>the <code>fear of statistics</code> subscale contains <code>raq_3</code>, which is reverse scored so we need to include the <code>keys</code> argument within the function</li>
<li>note that in the <code>omega()</code> function, the argument is <code>key</code>, but in the <code>alpha()</code> function, the argument is <code>keys</code></li>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">raq_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(raq_01, raq_03, raq_04, raq_05, raq_12, raq_16, raq_20, raq_21)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-3">  psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keys =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = dplyr::select(raq_tib, raq_01, raq_03, raq_04, 
    raq_05, raq_12, raq_16, raq_20, raq_21), keys = c(1, -1, 
    1, 1, 1, 1, 1, 1))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.71      0.71    0.68      0.23 2.4 0.0087  3.4 0.57     0.22

    95% confidence boundaries 
         lower alpha upper
Feldt     0.69  0.71  0.72
Duhachek  0.69  0.71  0.72

 Reliability if an item is dropped:
        raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
raq_01       0.69      0.69    0.67      0.24 2.2   0.0092 0.0050  0.24
raq_03-      0.69      0.69    0.66      0.24 2.2   0.0094 0.0051  0.23
raq_04       0.67      0.67    0.64      0.22 2.0   0.0100 0.0046  0.22
raq_05       0.66      0.66    0.63      0.22 1.9   0.0102 0.0035  0.21
raq_12       0.71      0.71    0.68      0.26 2.4   0.0088 0.0032  0.24
raq_16       0.68      0.68    0.66      0.24 2.2   0.0095 0.0051  0.22
raq_20       0.67      0.67    0.64      0.22 2.0   0.0099 0.0037  0.22
raq_21       0.66      0.66    0.63      0.22 1.9   0.0103 0.0032  0.21

 Item statistics 
           n raw.r std.r r.cor r.drop mean   sd
raq_01  2571  0.52  0.52  0.39   0.33  3.5 0.99
raq_03- 2571  0.54  0.54  0.42   0.36  2.5 0.99
raq_04  2571  0.61  0.61  0.53   0.45  3.5 0.99
raq_05  2571  0.64  0.64  0.58   0.48  3.5 1.00
raq_12  2571  0.46  0.46  0.32   0.27  3.5 0.98
raq_16  2571  0.55  0.55  0.44   0.37  3.5 0.98
raq_20  2571  0.61  0.60  0.52   0.44  3.5 1.00
raq_21  2571  0.64  0.65  0.58   0.49  3.5 0.98

Non missing response frequency for each item
          1    2    3    4    5 miss
raq_01 0.02 0.14 0.33 0.35 0.16    0
raq_03 0.02 0.14 0.34 0.34 0.16    0
raq_04 0.02 0.14 0.34 0.34 0.16    0
raq_05 0.03 0.13 0.35 0.32 0.16    0
raq_12 0.02 0.12 0.34 0.35 0.16    0
raq_16 0.02 0.14 0.34 0.34 0.16    0
raq_20 0.02 0.14 0.33 0.35 0.17    0
raq_21 0.02 0.14 0.34 0.35 0.15    0</code></pre>
</div>
</div>
<ul>
<li>note that <code>raq_03-</code> has a minus to indicate reverse scoring</li>
<li>acceptable overall reliability (<img src="https://latex.codecogs.com/png.latex?%5Calpha=0.71%20%5B0.69,%200.72%5D">)</li>
<li>no items improve the value if they are dropped</li>
<li>item correlations with the total subscale are ok (0.27-0.49)</li>
<li>issue with items not eliciting extreme responses</li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-field2023" class="csl-entry">
Field, Andy. 2023. <span>“Discovr: Interactive Tutorials and Data for <span>"</span>Discovering Statistics Using r and RStudio<span>"</span>.”</span>
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div></section></div> ]]></description>
  <category>EFA</category>
  <category>dsur</category>
  <category>dsus</category>
  <category>R</category>
  <guid>https://cmadland.github.io/blog/posts/dsur_ch18_efa/</guid>
  <pubDate>Fri, 26 Apr 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/dsur_ch18_efa/ellie-snow.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_05 - Visualizing Data</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">wish_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/jiminy_cricket.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 500 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): strategy, time
dbl (2): id, success

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">notebook_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/notebook.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 40 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): sex, film
dbl (1): arousal

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/exam_anxiety.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 103 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): sex
dbl (4): id, revise, exam_grade, anxiety

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ul>
<li>need to turn categorical variables into factors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">wish_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wish_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb9-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strategy =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(strategy),</span>
<span id="cb9-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Baseline"</span>)</span>
<span id="cb9-5">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">notebook_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> notebook_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb10-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(sex),</span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">film =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(film)</span>
<span id="cb10-5">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(id),</span>
<span id="cb11-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(sex)</span>
<span id="cb11-5">  )</span></code></pre></div>
</div>
<section id="ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2"><code>ggplot2</code></h2>
<ul>
<li>part of the <code>tidyverse</code></li>
</ul>
<dl>
<dt><code>aes()</code></dt>
<dd>
<p>controls aesthetics of the plot</p>
</dd>
</dl>
<section id="geometric-objects" class="level3">
<h3 class="anchored" data-anchor-id="geometric-objects">Geometric objects</h3>
<ul>
<li>objects that represent data</li>
</ul>
<dl>
<dt><code>geom_point()</code></dt>
<dd>
<p>plots data by points/dots</p>
</dd>
<dt><code>geom_boxplot()</code></dt>
<dd>
<p>plots boxplots</p>
</dd>
<dt><code>geom_histogram()</code></dt>
<dd>
<p>plots histograms</p>
</dd>
<dt><code>geom_errorbar()</code></dt>
<dd>
<p>plots error bars</p>
</dd>
<dt><code>geom_smooth()</code></dt>
<dd>
<p>plots summary lines</p>
</dd>
</dl>
</section>
<section id="objects-or-stats" class="level3">
<h3 class="anchored" data-anchor-id="objects-or-stats">Objects or ‘stats’</h3>
<ul>
<li>some situations where it is easier to display a summary of the data directly to the plot (usually <code>stat_summary()</code>)</li>
</ul>
</section>
<section id="scales" class="level3">
<h3 class="anchored" data-anchor-id="scales">Scales</h3>
<ul>
<li>control details of how data are mapped to their visual objects to control what appears on <em>x</em> and <em>y</em> axes using <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code>, axis labels are controlled with <code>labs()</code></li>
</ul>
</section>
<section id="coordinate-system" class="level3">
<h3 class="anchored" data-anchor-id="coordinate-system">Coordinate system</h3>
<ul>
<li><code>ggplot2</code> uses a Cartesian system.</li>
<li><code>coord_cartesian()</code> sets limits on <em>x</em> and <em>y</em> axes</li>
</ul>
</section>
<section id="position-adjustments" class="level3">
<h3 class="anchored" data-anchor-id="position-adjustments">Position adjustments</h3>
<ul>
<li><code>position_dodge()</code>forces objects to not overlap side by side</li>
<li><code>position_jitter()</code> adds small random adjustments to data points</li>
</ul>
</section>
<section id="facets" class="level3">
<h3 class="anchored" data-anchor-id="facets">Facets</h3>
<ul>
<li>used to plot different parts of the data in different panels</li>
</ul>
</section>
<section id="themes" class="level3">
<h3 class="anchored" data-anchor-id="themes">Themes</h3>
<ul>
<li>various themes to style the output</li>
<li>can be overridden with <code>theme()</code> function</li>
</ul>
<p>Each of the above are layers that can be added to a plot, as below</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/ggplot.png" class="img-fluid figure-img"></p>
<figcaption>Explanation of the layered approach to <code>ggplot2</code></figcaption>
</figure>
</div>
</section>
</section>
<section id="boxplots-box-whisker-plots" class="level2">
<h2 class="anchored" data-anchor-id="boxplots-box-whisker-plots">Boxplots (box-whisker plots)</h2>
<ul>
<li>imaginary data based on peoples’ level of success (0-100)</li>
<li>one group told to wish for good success, other group told to work hard for success</li>
<li>measured success again 5 years later</li>
<li>The data are in <code>wish_tib</code>. The variables are <code>id</code> (the person’s id), <code>strategy</code> (hard work or wishing upon a star), <code>time</code> (baseline or 5 years), and <code>success</code> (the rating on my dodgy scale).</li>
</ul>
<p>Creating a boxplot…</p>
<dl>
<dt><code>geom_boxplot()</code></dt>
<dd>
<p><code>ggplot2::ggplot(my_tib, aes(variable_for_x_axis, variable_for_y_axis))</code></p>
</dd>
</dl>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">wish_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(wish_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, success))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creates an object called `wish_plot` that contains the boxplot</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot() function specifies the plot will use `wish_tib` and plots time on *x* and success on *y*</span></span>
<span id="cb12-3">wish_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># adds boxplot geom to wish_plot</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">wish_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(wish_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, success))</span>
<span id="cb13-2">wish_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add labels to axes</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add minimal theme layer</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>plot shows slight increase of success, but doesn’t show the effect of hard work</li>
</ul>


</section>

 ]]></description>
  <category>ggplot2</category>
  <category>visualizing data</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/</guid>
  <pubDate>Tue, 23 Apr 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_05_visualizing_data/raft-canyon.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_02 - Summarizing Data</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">ice_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/ice_bucket.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2323000 Columns: 1
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (1): upload_day

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="frequency-tables" class="level2">
<h2 class="anchored" data-anchor-id="frequency-tables">Frequency tables</h2>
<ul>
<li>use <code>group_by()</code> and <code>summarise()</code> and <code>n()</code> functions from <code>dplyr</code></li>
</ul>
<dl>
<dt><code>group_by()</code></dt>
<dd>
<p>groups data by whatever variable(s) you name within the function</p>
</dd>
<dt><code>summarise()</code></dt>
<dd>
<p>creates summary table based on the variables in the function</p>
</dd>
<dt><code>n()</code></dt>
<dd>
<p>counts the number of scores</p>
</dd>
</dl>
<p>To count frequencies:</p>
<ul>
<li>tell R to treat values that are the same, as being in the same category
<ul>
<li><code>group_by(upload_day)</code> tells R that scores that are the same within <code>upload_day</code> are in the same group</li>
<li>subsequent operations are conducted on the groups</li>
</ul></li>
<li>count how many scores fall into each category
<ul>
<li><code>summarize()</code> creates a variable called <code>frequency</code> that counts how many items are in each group created by <code>group_by()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">freq_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(upload_day) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frequency =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()</span>
<span id="cb5-5">  )</span>
<span id="cb5-6">freq_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 56 × 2
   upload_day frequency
        &lt;dbl&gt;     &lt;int&gt;
 1         21      2000
 2         22      2000
 3         23      4000
 4         24      4000
 5         25      8000
 6         26      8000
 7         27     10000
 8         28     16000
 9         29     20000
10         30     29000
# ℹ 46 more rows</code></pre>
</div>
</div>
<ul>
<li>this is a large table and a bit unwieldy</li>
<li>use a <code>grouped frequency distribution</code>
<ul>
<li>place values of <code>upload_days</code> into bins</li>
</ul></li>
<li>if we want to split the variable <code>upload_day</code> into bins of 4 days…</li>
</ul>
<pre><code>ggplot2::cut_width(upload_day, 4)</code></pre>
<ul>
<li>combine this with <code>dplyr::mutate()</code> to create a new variable called <code>days_group</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">gp_freq_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">days_group =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_width</span>(upload_day, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb8-4">    )</span>
<span id="cb8-5">gp_freq_dist</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,323,000 × 2
   upload_day days_group
        &lt;dbl&gt; &lt;fct&gt;     
 1         34 (30,34]   
 2         36 (34,38]   
 3         31 (30,34]   
 4         30 (26,30]   
 5         33 (30,34]   
 6         38 (34,38]   
 7         36 (34,38]   
 8         46 (42,46]   
 9         45 (42,46]   
10         31 (30,34]   
# ℹ 2,322,990 more rows</code></pre>
</div>
</div>
<ul>
<li>this creates a new object called <code>gp_freq_dist</code> that contains each value within <code>ice_tib</code> but with an extra column/variable called <code>days_group</code> that indicates the bin the value of <code>upload_day</code> is in</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Set notation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>the value of <code>upload_day</code> now has a corresponding value of <code>days_group</code> containing the bin</li>
<li>the first score of 34 has been assigned to the bin labelled `(30, 34] which is the bin containing any score above 30, up to and including 34</li>
<li>the label uses standard mathematical notation for sets where <code>(</code> or <code>)</code> means ‘not including’ and <code>[</code> or <code>]</code> means ‘including’</li>
</ul>
</div>
</div>
<ul>
<li>now we can use <code>summarize()</code> and <code>n()</code> to count scores like before, except to use <code>days_group</code> instead of <code>upload_day</code></li>
</ul>
<section id="coding-challenge" class="level3">
<h3 class="anchored" data-anchor-id="coding-challenge">Coding challenge</h3>
<p>Create a grouped frequency table called gp_freq_dist by starting with the code in the code example and then using the code we used to create freq_tbl to create a pipe that summarizes the grouped scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">gp_freq_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">days_group =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_width</span>(upload_day, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb10-4">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb10-5">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(days_group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-6">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb10-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frequency =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()</span>
<span id="cb10-8">  )</span>
<span id="cb10-9">gp_freq_dist</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   days_group frequency
   &lt;fct&gt;          &lt;int&gt;
 1 [18,22]         4000
 2 (22,26]        24000
 3 (26,30]        75000
 4 (30,34]       367000
 5 (34,38]       770000
 6 (38,42]       534000
 7 (42,46]       255000
 8 (46,50]       102000
 9 (50,54]        70000
10 (54,58]        38000
11 (58,62]        26000
12 (62,66]        18000
13 (66,70]        18000
14 (70,74]        16000
15 (74,78]         6000</code></pre>
</div>
</div>
</section>
</section>
<section id="relative-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="relative-frequencies">Relative Frequencies</h2>
<ul>
<li>we have an object <code>gp_freq_dist</code> that contains the number of days grouped into bins of 4 days and the number of videos uploaded during each of the time periods represented by those bins</li>
<li>to calculate the relative frequency we can use <code>dplyr::mutate()</code> to add a variable that divides the frequency by the total number of videos using <code>sum()</code></li>
</ul>
<pre><code>... |&gt;
    dplyr::mutate(
        relative_freq = frequency/sum(frequency) # creates a new column
    )</code></pre>
</section>
<section id="efficient-code" class="level2">
<h2 class="anchored" data-anchor-id="efficient-code">Efficient Code</h2>
<ul>
<li>rather than creating the table of relative frequencies step-by-step, it is usually more efficient to carry out the steps in one piece of code</li>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">gp_freq_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb13-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">days_group =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_width</span>(upload_day, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb13-4">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-5">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(days_group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-6">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frequency =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()</span>
<span id="cb13-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb13-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">relative_freq =</span> frequency<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(frequency),</span>
<span id="cb13-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent =</span> relative_freq<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb13-12">  )</span>
<span id="cb13-13">  </span>
<span id="cb13-14">gp_freq_dist</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   days_group frequency relative_freq percent
   &lt;fct&gt;          &lt;int&gt;         &lt;dbl&gt;   &lt;dbl&gt;
 1 [18,22]         4000       0.00172   0.172
 2 (22,26]        24000       0.0103    1.03 
 3 (26,30]        75000       0.0323    3.23 
 4 (30,34]       367000       0.158    15.8  
 5 (34,38]       770000       0.331    33.1  
 6 (38,42]       534000       0.230    23.0  
 7 (42,46]       255000       0.110    11.0  
 8 (46,50]       102000       0.0439    4.39 
 9 (50,54]        70000       0.0301    3.01 
10 (54,58]        38000       0.0164    1.64 
11 (58,62]        26000       0.0112    1.12 
12 (62,66]        18000       0.00775   0.775
13 (66,70]        18000       0.00775   0.775
14 (70,74]        16000       0.00689   0.689
15 (74,78]         6000       0.00258   0.258</code></pre>
</div>
</div>
</section>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<ul>
<li><code>ggplot2</code> can produce data visualizations</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Always load <code>ggplot2</code>!
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ve discussed elsewhere that if you include packages when you use functions (e.g., <code>dplyr::mutate()</code>) you don’t need to explicitly load the package (in this case <code>dplyr</code>). However, to create plots with <code>ggplot2</code> you build them up layer by layer, which means you use a lot of <code>ggplot2</code> functions. For this reason, I advise loading it at the start of your Quarto document and not worrying too much about including package references when you use functions. You can load it either with <code>library(ggplot2)</code> or by loading the entire tidyverse using <code>library(tidyverse)</code>.</p>
</div>
</div>
<ul>
<li>general form of <code>ggplot2</code></li>
</ul>
<pre><code>`ggplot2::ggplot(my_tib, aes(variable_for_x_axis, variable_for_y_axis))`</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>something is missing b/c we only told <code>ggplot2</code> ‘what’ to plot, not ‘how’ to plot it.</li>
<li>need to add a <code>geom</code> with <code>geom_histogram()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="changing-bin-widths" class="level3">
<h3 class="anchored" data-anchor-id="changing-bin-widths">Changing bin widths</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="changing-colours" class="level3">
<h3 class="anchored" data-anchor-id="changing-colours">Changing colours</h3>
<ul>
<li>include <code>fill =</code> within the <code>geom_histogram()</code> function</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transparency-and-axis-labels" class="level3">
<h3 class="anchored" data-anchor-id="transparency-and-axis-labels">Transparency and axis labels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days since first ice bucket challenge video"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="themes" class="level3">
<h3 class="anchored" data-anchor-id="themes">Themes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ice_tib, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(upload_day)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days since first ice bucket challenge video"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summarizing-data" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-data">Summarizing data</h2>
<section id="mean-and-median" class="level3">
<h3 class="anchored" data-anchor-id="mean-and-median">Mean and median</h3>
<pre><code>mean(variable, trim = 0, na.rm = FALSE)</code></pre>
<dl>
<dt><code>trim</code></dt>
<dd>
<p>allows you to trim scores before calculating the mean by specifying a value between 0 and 0.5. default is 0 (no trim). to trim 10% of scores fom each end of the distribution you could set <code>trim = 0.1</code></p>
</dd>
<dt><code>na.rm</code></dt>
<dd>
<p>stands for <code>NA remove</code>. Missing values are denoted <code>NA</code>, for ‘not available’. by setting <code>na.rm = TRUE</code> (or <code>na.rm = T</code>), R will remove missing values before computing the mean</p>
</dd>
</dl>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Missing Values
</div>
</div>
<div class="callout-body-container callout-body">
<p>The default in many functions is not to remove missing values (e.g.&nbsp;<code>na.rm = FALSE</code>). If you have missing values in your data and don’t change this default behaviour R will throw an error. Therefore, if you get an error from a function like <code>mean()</code>, check whether you have missing values and whether you have forgotten to set <code>na.rm = TRUE</code>.</p>
</div>
</div>
<p>The function for median is similar, except no trim (median is effectively the mean with 50% trim)</p>
<pre><code>median(variable, na.rm = FALSE)</code></pre>
</section>
<section id="code-example" class="level3">
<h3 class="anchored" data-anchor-id="code-example">Code example</h3>
<ul>
<li>if the defaults are ok, there is no need to set those arguments</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.678</code></pre>
</div>
</div>
<p>To remove missing values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.678</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">?mean</span></code></pre></div>
</div>
</section>
<section id="coding-challenge-1" class="level3">
<h3 class="anchored" data-anchor-id="coding-challenge-1">coding challenge</h3>
<p>Find the median number of days after the original ice bucket video that other videos were uploaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
</div>
</section>
</section>
<section id="quantifying-the-fit-of-the-mean" class="level2">
<h2 class="anchored" data-anchor-id="quantifying-the-fit-of-the-mean">Quantifying the ‘fit’ of the mean</h2>
<dl>
<dt><code>var()</code></dt>
<dd>
<p>variance</p>
</dd>
<dd>
<p><code>var(variable_name, na.rm = FALSE)</code></p>
</dd>
<dt><code>sd()</code></dt>
<dd>
<p>standard deviation</p>
</dd>
<dd>
<p><code>sd(variable_name, na.rm = FALSE)</code></p>
</dd>
</dl>
<p><code>var()</code> and <code>sd()</code> take the same syntax as <code>mean()</code></p>
<section id="coding-challenge-2" class="level3">
<h3 class="anchored" data-anchor-id="coding-challenge-2">coding challenge</h3>
<p>Use what you learned in the previous section and the code example above to get the variance and standard deviation of the days since the original ice bucket video that other videos were uploaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.94197</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.74222</code></pre>
</div>
</div>
</section>
</section>
<section id="inter-quartile-range" class="level2">
<h2 class="anchored" data-anchor-id="inter-quartile-range">Inter-quartile range</h2>
<dl>
<dt><code>IQR()</code></dt>
<dd>
<p><code>IQR(variable_name, na.rm = FALSE, type = 7)</code></p>
</dd>
</dl>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</section>
<section id="creating-a-summary-table" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-summary-table">Creating a summary table</h2>
<ul>
<li>used to comine all the above into one table</li>
</ul>
<p><code>summarise()</code></p>
<pre><code>ice_tib |&gt;
  dplyr::summarise(
    median =  median(upload_day),  # creates new variable called `median` from the output of `median(upload_day)`
    mean =  mean(upload_day), # creates new variable called `mean` from the output of `mean(upload_day)`
    ...
    )</code></pre>
<section id="coding-challenge-3" class="level3">
<h3 class="anchored" data-anchor-id="coding-challenge-3">coding challenge</h3>
<p>Create a summary table containing the mean, median, IQR, variance and SD of the number of days since the original ice bucket video.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb41-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb41-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(upload_day),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creates new variable called `median` from the output of `median(upload_day)`</span></span>
<span id="cb41-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(upload_day), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creates new variable called `mean` from the output of `mean(upload_day)`</span></span>
<span id="cb41-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">IQR =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(upload_day),</span>
<span id="cb41-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(upload_day),</span>
<span id="cb41-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(upload_day)</span>
<span id="cb41-8">    )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  median  mean   IQR   var    sd
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     38  39.7     7  59.9  7.74</code></pre>
</div>
</div>
</section>
<section id="code-example-1" class="level3">
<h3 class="anchored" data-anchor-id="code-example-1">Code example</h3>
<p>To store the summary of stats, we assign it to a new object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">upload_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb43-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb43-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(upload_day),</span>
<span id="cb43-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(upload_day),</span>
<span id="cb43-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">IQR =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(upload_day),</span>
<span id="cb43-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(upload_day),</span>
<span id="cb43-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">std_dev =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(upload_day)</span>
<span id="cb43-8">    ) </span>
<span id="cb43-9">    upload_summary</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  median  mean   IQR variance std_dev
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1     38  39.7     7     59.9    7.74</code></pre>
</div>
</div>
</section>
</section>
<section id="rounding-values" class="level2">
<h2 class="anchored" data-anchor-id="rounding-values">Rounding Values</h2>
<p>use <code>round()</code> function to round values and use <code>kable()</code> from <code>knitr</code> to round an entire table of values</p>
<dl>
<dt><code>round()</code></dt>
<dd>
<p>round(x, digits = 0)</p>
</dd>
<dd>
<p>default is 0</p>
</dd>
</dl>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.211420</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>also use a pipe to feed a mean, median, or variance into the round function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb47-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.942</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb49-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.678</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(ice_tib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upload_day) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb51-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.742</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">upload_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ice_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb53-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb53-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(upload_day),</span>
<span id="cb53-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(upload_day),</span>
<span id="cb53-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">IQR =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(upload_day),</span>
<span id="cb53-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(upload_day),</span>
<span id="cb53-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">std_dev =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(upload_day)</span>
<span id="cb53-8">    ) </span>
<span id="cb53-9">    upload_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb53-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  median  mean   IQR variance std_dev
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1     38  39.7     7     59.9    7.74</code></pre>
</div>
</div>
</section>
<section id="datawizard" class="level2">
<h2 class="anchored" data-anchor-id="datawizard">Datawizard</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">datawizard<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe_distribution</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ice_tib,</span>
<span id="cb55-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">select =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb55-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exclude =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb55-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">centrality =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>,</span>
<span id="cb55-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dispersion =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb55-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iqr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb55-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb55-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quartiles =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb55-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_factors =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb55-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable   |  Mean |   SD | IQR |          Range | Skewness | Kurtosis
----------------------------------------------------------------------
upload_day | 39.68 | 7.74 |   7 | [21.00, 76.00] |     1.72 |     4.43

Variable   |       n | n_Missing
--------------------------------
upload_day | 2323000 |         0</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>frequency</category>
  <category>histograms</category>
  <category>variance</category>
  <category>standard deviation</category>
  <category>IQR</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/</guid>
  <pubDate>Thu, 18 Apr 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_02_summarizing_data/raft-falls.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_06 - The Beast of Bias</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_06_bias/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/download_festival.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 810 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): gender
dbl (4): ticket_no, day_1, day_2, day_3

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ticket_no =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(ticket_no),</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(gender) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-5">      forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Non-binary"</span>)</span>
<span id="cb5-6">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">download_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 810 × 5
   ticket_no gender day_1 day_2 day_3
   &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2111      Male    2.64  1.35  1.61
 2 2229      Female  0.97  1.41  0.29
 3 2338      Male    0.84 NA    NA   
 4 2384      Female  3.03 NA    NA   
 5 2401      Female  0.88  0.08 NA   
 6 2405      Male    0.85 NA    NA   
 7 2467      Female  1.56 NA    NA   
 8 2478      Female  3.02 NA    NA   
 9 2490      Male    2.29 NA    NA   
10 2504      Female  1.11  0.44  0.55
# ℹ 800 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of the following describes tidy data?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Data that are arranged such that scores on a variable appear in a single column and rows represent a combination of the attributes of those scores – the entity from which the scores came, when the score was recorded, etc. Scores from a single entity can appear over multiple rows where each row represents a combination of the attributes of the score – for example, levels of an independent variable or time point at which the score was recorded.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are the download data in tidy or messy format?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Messy</p>
<p>Correct - well done! The download data are messy because the hygiene scores on different days are spread across different columns rather than being in a single colum with an additional column to indicate the day of the festival that the hygiene score was measured.</p>
</div>
</div>
</div>
<p><code>tidyr</code> has two functions for converting data from messy to tidy. - <code>pivot_longer()</code> takes columns and puts them into rosw to make messy data tidy - <code>pivot_wider()</code> takes rows and puts them in columns to make tidy data messy</p>
<section id="making-messy-data-tidy" class="level2">
<h2 class="anchored" data-anchor-id="making-messy-data-tidy">Making messy data tidy</h2>
<pre><code>tidyr::pivot_longer(
  data = tibble,
  cols = column_names,
  names_to = "name_of_column_to_contain_variable_names",
  values_to = "name_of_column_to_contain_values",
)</code></pre>
<dl>
<dt><code>tibble</code></dt>
<dd>
<p>Name of the messy tibble</p>
</dd>
<dt><code>column_names</code></dt>
<dd>
<p>list of columns to be restructured into rows</p>
</dd>
<dt><code>names_to</code></dt>
<dd>
<p>name for the new variable that contains names of the original columns</p>
</dd>
<dt><code>value_to</code></dt>
<dd>
<p>name for the new variable that will contain the values.</p>
</dd>
</dl>
</section>
<section id="code-example" class="level2">
<h2 class="anchored" data-anchor-id="code-example">Code example</h2>
<ul>
<li>in <code>download_tib</code>, there are three columns/variables that need to be restructured into rows</li>
<li>specify the variables using <code>day_1:day_3</code></li>
<li>scores in these columns represent hygiene scores, so we could use <code>hygiene</code> as the variable to contain values after restructuring</li>
<li>columns we are transforming represent different days at the festival, so we can use <code>day</code> as the name of the variable created to contain column names</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">download_tidy_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a new object called `download_tidy_tib`</span></span>
<span id="cb9-2">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(                              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use the `pivot_longer()` function from `tidyr`</span></span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> day_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>day_3,                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># specify columns `day_1:day_3` for restructuring</span></span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>,                             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># names of the columns be placed in a variable called `day`</span></span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hygiene"</span>,                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># values of the columns placed in a variable called `hygiene`</span></span>
<span id="cb9-6">)</span>
<span id="cb9-7">download_tidy_tib                               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the new object</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,430 × 4
   ticket_no gender day   hygiene
   &lt;chr&gt;     &lt;fct&gt;  &lt;chr&gt;   &lt;dbl&gt;
 1 2111      Male   day_1    2.64
 2 2111      Male   day_2    1.35
 3 2111      Male   day_3    1.61
 4 2229      Female day_1    0.97
 5 2229      Female day_2    1.41
 6 2229      Female day_3    0.29
 7 2338      Male   day_1    0.84
 8 2338      Male   day_2   NA   
 9 2338      Male   day_3   NA   
10 2384      Female day_1    3.03
# ℹ 2,420 more rows</code></pre>
</div>
</div>
</section>
<section id="tidying-labels" class="level2">
<h2 class="anchored" data-anchor-id="tidying-labels">Tidying labels</h2>
<ul>
<li>the values in <code>day</code> match the original column names exactly (<code>day_1</code>)</li>
<li>we want sentence case (<code>Day 1</code>)</li>
<li>use <code>stringr</code></li>
</ul>
<pre><code>download_tidy_tib &lt;- download_tidy_tib |&gt;   # recreates `download_tidy_tib` from itself
   dplyr::mutate(                                             # uses `dplyr::mutate` to recreate the variable `day`
    day = stringr::str_to_sentence(day) |&gt; stringr::str_replace("_", " ")                                                # uses `stringr::str_to_sentence` to capitalize the d, then `str_replace()` to find the underscore and replace it with a space
  )</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">download_tidy_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tidy_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-2">   dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb12-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day =</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_sentence</span>(day) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb12-4">  )</span>
<span id="cb12-5">  download_tidy_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,430 × 4
   ticket_no gender day   hygiene
   &lt;chr&gt;     &lt;fct&gt;  &lt;chr&gt;   &lt;dbl&gt;
 1 2111      Male   Day 1    2.64
 2 2111      Male   Day 2    1.35
 3 2111      Male   Day 3    1.61
 4 2229      Female Day 1    0.97
 5 2229      Female Day 2    1.41
 6 2229      Female Day 3    0.29
 7 2338      Male   Day 1    0.84
 8 2338      Male   Day 2   NA   
 9 2338      Male   Day 3   NA   
10 2384      Female Day 1    3.03
# ℹ 2,420 more rows</code></pre>
</div>
</div>
<p>## Making tidy data messy</p>
<ul>
<li><code>pivot_wider()</code> reverses the process above</li>
</ul>
<pre><code>tidyr::pivot_wider(
  data = tibble,  # tibble to be restructured
  id_cols = variables_that_you_do_not_want_to_restructure,
  names_from = "variable_containing_the_names_of_columns",
  values_from = " variable_containing_the_scores",
)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tidy_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-2">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb15-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ticket_no, gender),</span>
<span id="cb15-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>,</span>
<span id="cb15-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hygiene"</span>,</span>
<span id="cb15-6">)</span>
<span id="cb15-7">download_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 810 × 5
   ticket_no gender `Day 1` `Day 2` `Day 3`
   &lt;chr&gt;     &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 2111      Male      2.64    1.35    1.61
 2 2229      Female    0.97    1.41    0.29
 3 2338      Male      0.84   NA      NA   
 4 2384      Female    3.03   NA      NA   
 5 2401      Female    0.88    0.08   NA   
 6 2405      Male      0.85   NA      NA   
 7 2467      Female    1.56   NA      NA   
 8 2478      Female    3.02   NA      NA   
 9 2490      Male      2.29   NA      NA   
10 2504      Female    1.11    0.44    0.55
# ℹ 800 more rows</code></pre>
</div>
</div>
<ul>
<li>in this case, having the variable names in sentence case (Day 1), is inconvenient because we will always have to put them in backticks</li>
<li>rename using <code>dplyr::rename_with</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Day"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># finds all columns w/i download_tib that begin with the word `Day'</span></span>
<span id="cb17-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fn =</span> \(column) stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string =</span> column, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creates a lambda or anonymous function that will be applied to the variables that begin with Day</span></span>
<span id="cb17-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Day "</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with next line, tells the function what to do</span></span>
<span id="cb17-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replacement =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day_"</span>)</span>
<span id="cb17-6">)</span>
<span id="cb17-7"></span>
<span id="cb17-8">download_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 810 × 5
   ticket_no gender day_1 day_2 day_3
   &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2111      Male    2.64  1.35  1.61
 2 2229      Female  0.97  1.41  0.29
 3 2338      Male    0.84 NA    NA   
 4 2384      Female  3.03 NA    NA   
 5 2401      Female  0.88  0.08 NA   
 6 2405      Male    0.85 NA    NA   
 7 2467      Female  1.56 NA    NA   
 8 2478      Female  3.02 NA    NA   
 9 2490      Male    2.29 NA    NA   
10 2504      Female  1.11  0.44  0.55
# ℹ 800 more rows</code></pre>
</div>
</div>
</section>
<section id="spotting-outliers" class="level2">
<h2 class="anchored" data-anchor-id="spotting-outliers">Spotting outliers</h2>
<p>Two ways:</p>
<ul>
<li>visualize the data and look for unusual cases</li>
<li>look for values that are poorly predicted by the model, using model residuals as described in DSUR</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are the model residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The differences between the values a model predicts and the values observed in the data on which the model is based</li>
</ul>
</div>
</div>
</div>
</section>
<section id="histograms-and-boxplots" class="level2">
<h2 class="anchored" data-anchor-id="histograms-and-boxplots">Histograms and Boxplots</h2>


</section>

 ]]></description>
  <category>bias</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_06_bias/</guid>
  <pubDate>Tue, 16 Apr 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_06_bias/ellie.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_07 - Associations</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_07_associations/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">liar_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/biggest_liar.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 68 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): id, novice
dbl (2): creativity, position

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/exam_anxiety.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 103 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): sex
dbl (4): id, revise, exam_grade, anxiety

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">liar_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">novice =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(novice)</span>
<span id="cb7-4">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(id),</span>
<span id="cb8-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(sex)</span>
<span id="cb8-5">  )</span></code></pre></div>
</div>
<ul>
<li>psychologist uses a questionnaire to assess state anxiety related to exams (EAQ)</li>
<li>scale produced a measure of anxiety scored out of 100</li>
<li>anxiety was measured before the exam, and the percentage grade on the exam was recorded</li>
<li>also measured the number of hours spent revising Data are in</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">exam_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 103 × 5
   id    revise exam_grade anxiety sex   
   &lt;fct&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt; 
 1 1          4         40    86.3 Male  
 2 2         11         65    88.7 Female
 3 3         27         80    70.2 Male  
 4 4         53         80    61.3 Male  
 5 5          4         40    89.5 Male  
 6 6         22         70    60.5 Female
 7 7         16         20    81.5 Female
 8 8         21         55    75.8 Female
 9 9         25         50    69.4 Female
10 10        18         40    82.3 Female
# ℹ 93 more rows</code></pre>
</div>
</div>
<ul>
<li>visualise with <code>GGally</code></li>
<li>plot continuous variables, the <code>ggscatmat()</code> function produces a matrix of scatterplots (below the diagonal), distributions (along the diagonal) and the correlation coefficient (above the diagonal)</li>
<li>general form of <code>ggscatmat()</code>
<ul>
<li><code>GGally::ggscatmat(my_tibble, columns = c("variable 1", " variable 2", " variable 3" …))</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(exam_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exam_grade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revise"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"anxiety"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_07_associations/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>resulting plots are all skewed</li>
<li>could be a problem if we want significance tests or confidence intervals</li>
<li>sample contains 103 obs
<ul>
<li>could be large enough for central limit theorem to relieve us of concerns about normality</li>
<li>consider doing a robust method to compute correlation coefficient</li>
</ul></li>
</ul>
<section id="pearsons-correlation-using-r" class="level2">
<h2 class="anchored" data-anchor-id="pearsons-correlation-using-r">Pearson’s correlation using <code>R</code></h2>
<ul>
<li><code>correlation</code> package -&gt; workhorse function called <code>correlation()</code></li>
</ul>
<pre><code>correlation::correlation(tibble,
                         method = "pearson",
                         p_adjust = "holm",
                         ci = 0.95
                         )</code></pre>
<dl>
<dt><code>tibble</code></dt>
<dd>
<p>should be replaced with the name of tibble containing any variables to correlate</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>method of correlation coefficient, default is <code>pearson</code>, but can also accept <code>spearman, kendall, biserial, polychoric, tetrachoric, and percentage</code></p>
</dd>
<dt><code>p_adjust</code></dt>
<dd>
<p>corrects the <img src="https://latex.codecogs.com/png.latex?p">-value for the number of tests you have performed using the Holm-Bonferroni method</p>
</dd>
<dd>
<p>applies the Bonferroni criterion in a slightly less strict way that controls the type I error, but with less risk of a type II error</p>
</dd>
<dd>
<p>can change to <code>none</code> (bad idea), <code>bonferroni</code> (to apply the standard Bonferroni method) or several other methods.</p>
</dd>
<dt><code>ci</code></dt>
<dd>
<p>set the confidence interval width; default is 0.95 for general use</p>
</dd>
</dl>
<p>To use the function, - pipe tibble into the <code>select()</code> function from <code>dplyr</code> to select variables to correlate, then pipe that into the correlation function - use the same syntax whether you want to correlate two variables or produce all correlations between pairs of multiple variables]</p>
<p>To calculate Pearson correlation btwn variables <code>exam_grade</code> and <code>revise</code> in <code>exam_tib</code>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">4.343</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.441</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.585</td>
<td style="text-align: right;">-0.271</td>
<td style="text-align: right;">-4.938</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.220</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">4.343</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.441</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.585</td>
<td style="text-align: right;">-0.271</td>
<td style="text-align: right;">-4.938</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">revise</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.709</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.794</td>
<td style="text-align: right;">-0.598</td>
<td style="text-align: right;">-10.111</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for the association between exam grade and revision is 0.22 to 0.55. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of r lies between 0.22 and 0.55.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The p-value for the association between exam grade and revision is &lt; 0.001, what does this value mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The probability of getting a value of t at least as big as the value we have observed, if the value of r were, in fact, zero is less than 0.001. I’m going to assume, therefore, that the association between exam grade and revision is not zero.</p>
</div>
</div>
</div>
<ul>
<li>exam grade correlates with revision - <img src="https://latex.codecogs.com/png.latex?r">=0.4</li>
<li>exam grade had a similar strength relationship with exam anxiety <img src="https://latex.codecogs.com/png.latex?r">=-0.44 but in the opposite direction</li>
<li>revision had a strong negative relationship with anxiety - <img src="https://latex.codecogs.com/png.latex?r">=-0.709</li>
<li>the more you revise, the better your performance</li>
<li>the more anxiety you have, the worse your performance</li>
<li>the mopre you revise, the less anxiety you have</li>
<li>all <img src="https://latex.codecogs.com/png.latex?p">-values are less than 0.001 and would be interpreted as the correlation coefficients being significantly different from zero</li>
<li>significance values tell us that the probability of getting correlation coefficients at least as big as this in a sample of 103 people if the null were true (that there was no relationship between the variables) is very low</li>
<li>if we assume the sample is one of the 95% of samples that will produce a confidence interval containing the population value, then the confidence intervals tell us about the uncertainty around <img src="https://latex.codecogs.com/png.latex?r">.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rounding
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can control the number of decimal places using <code>knitr::kable(digits = 3)</code></p>
<p>We can also specify different columns to contain different rounding using <code>knitr::kable(digits = c(2, 2, 2, 2, 2, 2, 2, 2, 8))</code> (column 9 to 8 decimal places) or <code>knitr::kable(digits = c(rep(2, 8), 8))</code></p>
</div>
</div>
</section>
<section id="robust-correlation-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="robust-correlation-coefficients">Robust correlation coefficients</h2>
<p>Given the skew in the variables, we should use a robust correlation coefficient, like the <code>percentage bend correlation coefficient</code> by setting <code>method = "percentage"</code> within <code>correlation()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(</span>
<span id="cb17-4">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percentage"</span></span>
<span id="cb17-5">   ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-6">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00049502</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-4.41</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00005235</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">revise</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">-7.66</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Par1</th>
<th>Par2</th>
<th>Percentage Bend <img src="https://latex.codecogs.com/png.latex?r"></th>
<th>raw Pearson <img src="https://latex.codecogs.com/png.latex?r"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exam_grade</td>
<td>revise</td>
<td>0.34</td>
<td>0.397</td>
</tr>
<tr class="even">
<td>exam_grade</td>
<td>anxiety</td>
<td>-0.40</td>
<td>-0.441</td>
</tr>
<tr class="odd">
<td>revise</td>
<td>anxiety</td>
<td>-0.61</td>
<td>-0.709</td>
</tr>
</tbody>
</table>
<p>All robust correlations (percentage bend) are less than raw, though all are significant at <img src="https://latex.codecogs.com/png.latex?p%3C0.001"></p>
</section>
<section id="spearmans-correlation-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="spearmans-correlation-coefficient">Spearman’s correlation coefficient</h2>
<ul>
<li>data from World’s Best Liar competition</li>
<li>want to know if creativity impacts lying ability</li>
<li>position data (1st, 2nd, etc) is ordinal, so Spearman’s correlation coefficient should be used</li>
<li>Data are in</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">liar_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 4
   id    creativity position novice          
   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;           
 1 lnwe          53        1 First time      
 2 vxob          36        3 Previous entrant
 3 qpli          31        4 First time      
 4 pwsq          43        2 First time      
 5 xafq          30        4 Previous entrant
 6 njra          41        1 First time      
 7 lxty          32        4 First time      
 8 dxcw          54        1 Previous entrant
 9 uxgp          47        2 Previous entrant
10 dvew          50        2 First time      
# ℹ 58 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(liar_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"creativity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"position"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_07_associations/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To get Spearman correlation, we use <code>correlation()</code> the same way as we did with <code>Pearson</code>, except we add <code>method = "spearman"</code> to the function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(creativity, position) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-4">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 22%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">rho</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">S</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">creativity</td>
<td style="text-align: left;">position</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">71948.4</td>
<td style="text-align: right;">0.00172042</td>
<td style="text-align: left;">Spearman correlation</td>
<td style="text-align: right;">68</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Spearman correlation between the two is <img src="https://latex.codecogs.com/png.latex?r_s=-0.37"> with an associated <img src="https://latex.codecogs.com/png.latex?p">-value of 0.002 and a sample size of 68</li>
<li>as creativity increased, position decreased
<ul>
<li>this might seem contrary to the hypothesis, but a position of <code>4</code> is a lower position than <code>1</code></li>
</ul></li>
</ul>
</section>
<section id="kendalls-tau-tau" class="level2">
<h2 class="anchored" data-anchor-id="kendalls-tau-tau">Kendall’s tau (<img src="https://latex.codecogs.com/png.latex?%5Ctau">)</h2>
<ul>
<li>another non-parametric correlation</li>
<li>used instead of Spearman’s correlation when data set is small with a large number of tied ranks</li>
<li><code>correlation()</code> function will calculate Kendall’s <img src="https://latex.codecogs.com/png.latex?%5Ctau"> by including <code>method = "kendall"</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(creativity, position) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kendall"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-4">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">tau</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">creativity</td>
<td style="text-align: left;">position</td>
<td style="text-align: right;">-0.3002</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.4396</td>
<td style="text-align: right;">-0.1468</td>
<td style="text-align: right;">-3.2252</td>
<td style="text-align: right;">0.0012588</td>
<td style="text-align: left;">Kendall correlation</td>
<td style="text-align: right;">68</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>output shows <img src="https://latex.codecogs.com/png.latex?%5Ctau=-0.3"> -&gt; closer to 0 than Spearman (-.38) therefore Kendall’s value is likely a more accurate guage of what the correlation in the population would be</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Cover Photo by <a href="https://unsplash.com/@heebase?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Zhuojun Yu</a> on <a href="https://unsplash.com/photos/a-sandy-beach-covered-in-snow-at-sunset-RsBkqnfmgjA?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>correlation</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_07_associations/</guid>
  <pubDate>Sun, 10 Mar 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_07_associations/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_18 - Exploratory Factor Analysis</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_18_efa/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">raq_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/raq.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-2">  readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2571 Columns: 24
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): id
dbl (23): raq_01, raq_02, raq_03, raq_04, raq_05, raq_06, raq_07, raq_08, ra...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>



 ]]></description>
  <category>efa</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_18_efa/</guid>
  <pubDate>Tue, 27 Feb 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_18_efa/happy-rock.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discovr_08 - General Linear Model</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_08_the_glm/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggfortify)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(robust)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: fit.models</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">album_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/album_sales.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 200 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): album_id
dbl (4): adverts, sales, airplay, image

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">soc_anx_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/social_anxiety.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 134 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): spai, iii, obq, tosca

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">metal_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/metal_health.csv"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2506 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (2): hm, suicide

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="fitting-the-linear-model" class="level1">
<h1>Fitting the Linear Model</h1>
<ul>
<li>scatterplots to get an idea of whether assumption of linearity is met, look for outliers or other unusual cases</li>
<li>run an initial regression and save the diagnostics</li>
<li>if we want to generalize or test for significance or confidence intervals…
<ul>
<li>examine residuals for homoscedasticity, independence, normality, and linearity
<ul>
<li>lack of linearity –&gt; fit a non-linear model</li>
<li>assumptions met and no bias –&gt; Model can be generalized</li>
<li>lack of independent errors –&gt; multi-level model</li>
<li>all other situations –&gt; fit a robust version of the model using bootstrapping (small samples) or robust standard errors</li>
</ul></li>
</ul></li>
</ul>
<dl>
<dt>homoscedasticity</dt>
<dd>
<p>assumption of equal or similar variances in different groups being compared</p>
</dd>
<dd>
<p>homogeneity of variance</p>
</dd>
</dl>
<p><strong>Figure 1</strong> <img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/dsr2_fig_08_12_glm_process.png" class="img-fluid" alt="General process of fitting a linear model from discovr_08"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">album_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 5
   album_id adverts sales airplay image
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 aox1foms    10.3   330      43    10
 2 u453js2i   986.    120      28     7
 3 pie89xnr  1446.    360      35     7
 4 u2k5a0df  1188.    270      33     7
 5 t4699ux3   575.    220      44     5
 6 s4h49cu2   569.    170      19     5
 7 1235a8sf   472.     70      20     1
 8 p2v24p5k   537.    210      22     9
 9 4fbjg024   514.    200      21     7
10 e9w6usdb   174.    300      40     7
# ℹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>Use <code>GGally::ggscatmat</code> package to visualize the data</li>
<li>produces
<ul>
<li>a matrix of scatterplots below the diagonal</li>
<li>distributions along the diagonal</li>
<li>the correlation coefficient above the diagonal</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adverts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"airplay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"image"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sales"</span>))  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<ul>
<li>3 predictors have reasonably linear relationships with album sales and no obvious outliers (except bottom left of ‘band image’ scatterplots)</li>
<li>across the diagonal (distributions)
<ul>
<li>advertising is very skewed</li>
<li>airplay and sales look heavy-tailed</li>
</ul></li>
<li>correlations in the plot give us an idea of the relationships between predictors and outcome</li>
<li>if we ignore album sales, the highest correlation is between image ratings and amount of airplay, which is significant and the 0.01 level (<img src="https://latex.codecogs.com/png.latex?r=0.18">)</li>
<li>focussing on the outcome variable, adverts and airplay correlate best with the outcome (<img src="https://latex.codecogs.com/png.latex?r=0.58"> and <img src="https://latex.codecogs.com/png.latex?r=0.6">)</li>
</ul>
</section>
<section id="one-predictor" class="level2">
<h2 class="anchored" data-anchor-id="one-predictor">One predictor</h2>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<ul>
<li>predicting sales from advertising alone</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_i%7D+%5Cepsilon_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=b_0+%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D+%5Cepsilon_i"></p>
<ul>
<li>it is clear from the bottom left scatterplot and the correlation (<img src="https://latex.codecogs.com/png.latex?r=0.58">) that a positive relation exists. More advertising money spent leads to greater album sales.</li>
<li>some albums sell well regardless of advertising (top-left of scatterplot)</li>
<li>no albums sell badly when adverts are high (bottom-right of scatterplot)</li>
<li>to fit a linear model, we use <code>lm()</code> function <code>my_model &lt;- lm(outcome ~ predictor(s), data = tibble, na.action = an action)</code>
<ul>
<li><code>my_model</code> is the name of the model</li>
<li><code>outcome</code> is the name of the outcome variable (sales)</li>
<li><code>predictor</code> is the name of the predictor variable (adverts) or, a list of variables separated by <code>+</code> symbols</li>
<li><code>tibble</code> is the name of the tibble containing the data (album_tib)</li>
</ul></li>
<li>this function maps directly to the equation for the model
<ul>
<li><code>adverts ~ sales</code> maps to <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=b_0+%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D+%5Cepsilon_i"> except we ignore the error term and parameter estimates and we replace the <code>=</code> with <code>~</code> (which means ‘predicted from’)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">album_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts, data = album_tib, na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-152.949  -43.796   -0.393   37.040  211.866 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.341e+02  7.537e+00  17.799   &lt;2e-16 ***
adverts     9.612e-02  9.632e-03   9.979   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 65.99 on 198 degrees of freedom
Multiple R-squared:  0.3346,    Adjusted R-squared:  0.3313 
F-statistic: 99.59 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(album_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">65.991</td>
<td style="text-align: right;">99.587</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1120.688</td>
<td style="text-align: right;">2247.375</td>
<td style="text-align: right;">2257.27</td>
<td style="text-align: right;">862264.2</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>note <img src="https://latex.codecogs.com/png.latex?df=1"> and <img src="https://latex.codecogs.com/png.latex?df.residual=198"> therefore we can say that adding the predictor of advertising significantly improved the fit of the model to the data compared to having no predictors in the model</li>
<li><img src="https://latex.codecogs.com/png.latex?F(1,198)=99.59,%20p%3C.001"></li>
</ul>
</section>
<section id="model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="model-parameters">Model Parameters</h3>
<p>To see model parameters, use <code>broom::tidy()</code></p>
<p><code>broom::tidy(model_name, conf.int = FALSE, conf.level = 0.95)</code></p>
<ul>
<li>put the model name into the function, then two optional arguments
<ul>
<li>confidence intervals <code>conf.int=TRUE</code> (confidence intervals are not included by default)</li>
<li>default is 95%, but you can change it with <code>conf.level=.99</code> for 99% confidence interval</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(album_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 134.       7.54        17.8  5.97e-43 119.       149.   
2 adverts       0.0961   0.00963      9.98 2.94e-19   0.0771     0.115</code></pre>
</div>
</div>
<ul>
<li>output provides estimates of the model parameters (<img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">-values)</li>
<li><img src="https://latex.codecogs.com/png.latex?Y"> intercept (<img src="https://latex.codecogs.com/png.latex?b_0">) is 134.14 (when <img src="https://latex.codecogs.com/png.latex?X"> is 0, sales will be 134140)</li>
<li><img src="https://latex.codecogs.com/png.latex?X"> (<img src="https://latex.codecogs.com/png.latex?b_1">) is 0.096.
<ul>
<li>represents the change in outcome associated with a unit change in predictor.</li>
<li>when the predictor increases by 1, the outcome increases by .096, but since the units of measurement was thousands of pounds and thousands of sales, an increase in $1000 will lead to 96 more albums sold</li>
<li>not very good return</li>
<li>BUT, we know that advertising only accounts for 1/3 of the variance</li>
</ul></li>
<li>If a predictor is having a significant impact on our ability to predict the outcome, then <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> should be different from 0 and large relative to its standard error</li>
<li>the <img src="https://latex.codecogs.com/png.latex?t">-test (labelled statistic) and the associated <img src="https://latex.codecogs.com/png.latex?p">-value tell us whether the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> is significantly different from 0</li>
<li>the column p.value contains the exact probability that a value of <img src="https://latex.codecogs.com/png.latex?t"> at least as big as the one in the table would occur if the value of <img src="https://latex.codecogs.com/png.latex?b"> in the population were 0</li>
<li>if this propbability is less than 0.05, then we interpret that as the predictor being a significant predictor of hte outcome.</li>
<li>for both <img src="https://latex.codecogs.com/png.latex?t">s, the probabilities are in scientific notation
<ul>
<li><code>2.91e-19</code> means <img src="https://latex.codecogs.com/png.latex?2.91*10%5E%7B-19%7D">, or <code>move the decimal 19 places to the left</code> or <code>0.000000000000000000291</code></li>
<li><code>2.91e+19</code> means <img src="https://latex.codecogs.com/png.latex?2.91*10%5E%7B19%7D">, or <code>move the decimal 19 places to the right</code> or <code>29100000000000000000</code><br>
</li>
</ul></li>
<li>both values are 0 at 3 decimal places</li>
</ul>
</section>
<section id="exploring-the-standard-error-of-hatb" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-standard-error-of-hatb">Exploring the standard error of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></h3>
<p>https://www.youtube-nocookie.com/embed/3L9ZMdzJyyI?si=ET90VDYq3RVKnKDq</p>
</section>
<section id="confidence-intervals-for-hatb" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-for-hatb">Confidence intervals for <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></h3>
<p>Imagine we collect 100 samples of data measuring the same variables as the current model, then estimate the same model, including confidence intervals for unstandardized values.The boundaries are constructed such that 95% of our 100 samples contain the population value of <img src="https://latex.codecogs.com/png.latex?b">. 95 of 100 sample will yield confidence intervals for <img src="https://latex.codecogs.com/png.latex?b"> that contain the population value, but we don’t know if our sample is one of the 95.</p>
<p>We might just assume that it does, but if the confidence interval contains 0, then there is a possibility that there is no relationship, or the relationship might be negative. The trouble is that we would be wrong 5% of the time.</p>
<p>If the interval does not contain 0, we might conclude there is a genuine positive relationship.</p>
</section>
<section id="using-the-model" class="level3">
<h3 class="anchored" data-anchor-id="using-the-model">Using the model</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=%5Chat%7Bb_0%7D+%5Chat%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=134.14+.096*%7BAdvertising%7D_i"></p>
<p>Now we can make a prediction by entering a value for the advertising budget, say 100 (equal to 100,000 gbp)</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=134.14+.096*%7B100%7D_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=143.74"></p>
<p>or 143,740 sales</p>
</section>
</section>
<section id="several-predictors" class="level2">
<h2 class="anchored" data-anchor-id="several-predictors">Several Predictors</h2>
<p>add multiple predictors hierarchically, after advertising is shown to be significant</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_1i%7D+%7Bb_2%7D%7BX_2i%7D+%7Bb_3%7D%7BX_3i%7D+%20...%20+%7Bb_n%7D%7BX_ni%7D%5Cepsilon_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7Badvertising_i%7D+%7Bb_2%7D%7Bairplay_i%7D+%7Bb_3%7D%7Bimage_i%7D+%5Cepsilon_i"></p>
<section id="building-the-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-model">Building the model</h3>
<ul>
<li>add predictors to the R code the same way as we do in the equation, by adding <code>+</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">album_full_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-121.324  -28.336   -0.451   28.967  144.132 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -26.612958  17.350001  -1.534    0.127    
adverts       0.084885   0.006923  12.261  &lt; 2e-16 ***
airplay       3.367425   0.277771  12.123  &lt; 2e-16 ***
image        11.086335   2.437849   4.548 9.49e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 47.09 on 196 degrees of freedom
Multiple R-squared:  0.6647,    Adjusted R-squared:  0.6595 
F-statistic: 129.5 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(album_full_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">47.087</td>
<td style="text-align: right;">129.498</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1052.168</td>
<td style="text-align: right;">2114.337</td>
<td style="text-align: right;">2130.828</td>
<td style="text-align: right;">434574.6</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><code>r.squared</code> <img src="https://latex.codecogs.com/png.latex?R%5E2"> tells us the variance in album sales -&gt; .665, or 66.5%.</li>
<li><img src="https://latex.codecogs.com/png.latex?R%5E2"> for adverts was 0.335, so the difference -&gt; .665-.335=.33 means that airplay and image account for a further 33% of the variance</li>
<li>adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> <code>adj.r.squared</code> tells us how well the model generalizes, and the value should be close to r.squared.
<ul>
<li>in this case it is .66, or only .005 away</li>
</ul></li>
<li><img src="https://latex.codecogs.com/png.latex?F">-statistic is the ratio of the improvementin prediction that results from fitting the model, relative to the inaccuracy that sitll exists in the model</li>
<li>the variable <code>p.value</code> contains the p-value associated with <img src="https://latex.codecogs.com/png.latex?F"> -&gt; in this case is <img src="https://latex.codecogs.com/png.latex?2.88%C3%9710%5E%7B%E2%88%9246%7D"> -&gt; much smaller than .001</li>
<li>degrees of freedom are <code>df</code> and <code>df.residual</code></li>
<li>we can interpret the result as meaning that the model significantly improves our ability to predict the outcome variable ocmpared to not fitting the model.</li>
<li>reported as <img src="https://latex.codecogs.com/png.latex?F(3,%20196)=129.5,%20p=%3C0.001"></li>
</ul>
</section>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing Models</h2>
<ul>
<li>we can compare hierarchical models using an <img src="https://latex.codecogs.com/png.latex?F">-statisticusing the <code>anova()</code> function -&gt; <code>anova(model_1, model_2, … , model_n)</code></li>
<li>list the models in order that we want to compare</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(album_lm, album_full_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb23-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term                      df.residual    rss    df   sumsq statistic   p.value
  &lt;chr&gt;                           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 sales ~ adverts                   198 8.62e5    NA     NA       NA   NA       
2 sales ~ adverts + airpla…         196 4.35e5     2 427690.      96.4  6.88e-30</code></pre>
</div>
</div>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?F"> (<code>statistic</code>) is 96.5</li>
<li><img src="https://latex.codecogs.com/png.latex?p">-value (<code>p.value</code>) is <img src="https://latex.codecogs.com/png.latex?6.8793949%5E%7B-30%7D"></li>
<li><code>df</code> is 2 (difference between df in 2 models)</li>
<li><code>df.residual</code> is 196</li>
<li>Conclusion -&gt; adding airplay and image to the model significantly improved model fit
<ul>
<li><img src="https://latex.codecogs.com/png.latex?F(2,%20196)%20=%2096.45,%20p%20%3C%200.001"></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can only compare hierarchical models; that is to say that the second model must contain everything that was in the first model plus something new, and the third model must contain everything in the second model plus something new, and so on.</p>
</div>
</div>
<section id="model-parameter-estimates-hatb" class="level3">
<h3 class="anchored" data-anchor-id="model-parameter-estimates-hatb">Model parameter estimates (<img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">17.350</td>
<td style="text-align: right;">-1.534</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">-60.830</td>
<td style="text-align: right;">7.604</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.820</td>
<td style="text-align: right;">3.915</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.438</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">6.279</td>
<td style="text-align: right;">15.894</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>output gives estimates of the <img src="https://latex.codecogs.com/png.latex?b">-balues (column labelled <code>estimate</code>) and statistics that indicate the individual contribution of each predictor in the model.</li>
<li>all three predictors have positive <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">values, indicating positive relationships
<ul>
<li>as all three predictors increase, so do album sales</li>
</ul></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> vlaues also tell us to what degree each predictor affects the outcome if the effects of all other predictors are held constant
<ul>
<li>advertising budget -&gt; <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=0.085"> -&gt; as advertising increases by 1 unit (1000gbp), sales increases by 0.085 units (85 albums), but this is only true if the other two predictors are held constant</li>
<li>airplay <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=3.367"> -&gt; as airplay prior to release increases by one unit (1 play), album sales increase by 3.367 units (3367 album sales, but only if the other two predictors are held constant)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the 𝑏̂ (11.086) for band image?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If a band can increase their image rating by 1 unit they can expect additional album sales of 11,086 units</p>
</div>
</div>
</div>
</section>
<section id="standardized-hatbs" class="level3">
<h3 class="anchored" data-anchor-id="standardized-hatbs">Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">s</h3>
<p>The <code>lm()</code> function does not provide standardized betas, so use <code>model_parameters()</code></p>
<p><code>parameters::model_parameters(my_model, standardize = refit)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"refit"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb26-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.081</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.593</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>advertising budget -&gt; Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D=0.511">
<ul>
<li>as the advertising budgetr increases by one standard deviation (485,655gbp), album sales increase by .511 standard deviations.</li>
<li>the standard deviation for album sales is 80,699, so .511 SD is 41,240 sales</li>
<li>for every increase in advert budget of 485655gbp, album sales will increase by 41,240 IF the other predictors are held constant</li>
</ul></li>
<li>Image -&gt; Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D=0.192">
<ul>
<li>a band rated 1 SD on the image scale (1.4 units) will sell .192 SD more units.</li>
<li>this is a change of 15,490 sales IF the other predictors are held constant</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the Standardized B (0.512) for airplay?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As the number of plays on radio in the week before release increases by 1 standard deviation, album sales increase by 0.512 standard deviations</p>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for airplay ranges from 2.82 to 3.92. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of this confidence interval containing the population value is 0.95.</del></li>
<li>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 2.82 and 3.92.</li>
<li><del>I can be 95% confident that the population value of b lies between 2.82 and 3.92</del></li>
<li><del>There is a 95% chance that the population value of b lies between 2.82 and 3.92</del></li>
</ul>
</div>
</div>
</div>
<p>Assuming that each confidence interval is one of the 95% that contains the population parameter: - the true size of the relationship between advertising budget and album sales lies somewhere between 0.071 and 0.099 - the true size of the relationship between band image and album sales lies somewhere between 6.279 and 15.894</p>
<ul>
<li>the two best predictors have tight confidence intervals (airplay and adverts) indicating that the estimates are likely representative of the true population values</li>
<li>the interval for band image is much wider, but does not cross zero indicating this parameter is less representative of the population, but is still significant.</li>
</ul>
</section>
<section id="significance-tests" class="level3">
<h3 class="anchored" data-anchor-id="significance-tests">Significance tests</h3>
<p>The values in <code>statistic</code> are the values of <img src="https://latex.codecogs.com/png.latex?t"> associated with each <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> and <code>p.value</code> is the associated significance of the <img src="https://latex.codecogs.com/png.latex?t">-statistic. For every predictor, the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> is significantly different from 0 (<img src="https://latex.codecogs.com/png.latex?p%3C.001">) meaning that all predictors significantly predict album sales.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How might we interpret the statistic and p.value for the three predictors?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of the null hypothesis is less than 0.001 in all cases</del></li>
<li><del>The probability that each b is a chance result is less than 0.001</del></li>
<li>They tell us that the probability of getting a value of t at least as big as these values if the value of b were, in fact, zero is smaller than 0.001 for all predictors.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<img src="https://latex.codecogs.com/png.latex?p">-values
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many students and researchers think of <em>p</em>-values in terms of the ‘probability of a chance result’ or ‘the probability of a hypothesis being true’ but they are neither of these things. <u><strong>They are the long-run probability that you would get a test-statistic (in this case <em>t</em>) at least as large as the one you have if the null hypothesis were true.</strong></u> In other words, if there really were no relationship between advertising budget and album sales (the null hypothesis) then the population value of <em>b</em> would be zero.</p>
<p>Imagine we sampled from this null population and computed <em>t</em>, and then repeated this process 1000 times. We’d have 1000 values of <em>t</em> from a population in which there was no effect. We could plot these values as a histogram. This would tell us how often certain values of <em>t</em> occur. From it we could work out the probability of getting a particular value of <em>t</em>. If we then took another sample, and computed <em>t</em> (because we’re kind of obsessed with this sort of thing) we would be able to compare this value of <em>t</em> to the distribution of all the previous 1000 samples. Is the <em>t</em> in our current sample large of small compared to the others? Let’s say it was larger than 999 of the previous values. That would be quite an unlikely value of <em>t</em> whereas if it was larger than 500 of them this would not surprise us. <u><strong>This is what a <em>p</em>-value is: it is the long run probability of getting test statistic at least as large as the one you have if the null hypothesis were true.</strong></u> If the value is less than 0.05, people typically take this as supporting the idea that the null hypothesis isn’t true.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Report
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>the model that included the band’s image and airplay was significantly better fit than the model that included advertising budget alone <img src="https://latex.codecogs.com/png.latex?f(2,%20196)=96.45,%20p%3C0.001"></li>
<li>the final model explained 66.5% of the variance in album sales</li>
<li>advertising budget significantly predicted album sales <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=0.08%5B0.07,%200.10%5D,%20t(196)=12.26,%20p%3E.001"></li>
<li>airplay significantly predicted album sales <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=3.37%5B2.82,%203.92%5D,%20t(196)=12.12,%20p%3C.001"></li>
<li>band image significantly predicted album sales -&gt; <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=11.09%5B6.28,%2015.89%5D,%20t=4.55,%20p%3C.001"></li>
</ul>
</div>
</div>
</section>
</section>
<section id="unguided-example" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example">Unguided Example</h2>
<section id="metal-and-mental-health" class="level3">
<h3 class="anchored" data-anchor-id="metal-and-mental-health">Metal and mental health</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">metal_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,506 × 2
      hm suicide
   &lt;dbl&gt;   &lt;dbl&gt;
 1    10       7
 2    10      11
 3    10       8
 4     4      14
 5    10      13
 6     8      12
 7     8       7
 8     5      15
 9     8       7
10     9      10
# ℹ 2,496 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(metal_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suicide"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 200 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 284 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">metal_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(suicide <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> metal_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb32-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(metal_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb32-3">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">4.842</td>
<td style="text-align: right;">304.784</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6401.851</td>
<td style="text-align: right;">12809.7</td>
<td style="text-align: right;">12826.7</td>
<td style="text-align: right;">50047.05</td>
<td style="text-align: right;">2135</td>
<td style="text-align: right;">2137</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(metal_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   16.0      0.261       61.4 0          15.5      16.5  
2 hm            -0.612    0.0350     -17.5 6.64e-64   -0.680    -0.543</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance does the final model explain?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>12.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the nature of the relationship between listening to heavy metal and suicide risk?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>As love of heavy metal increases, suicide risk decreases</li>
<li>because the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> value is negative (-.0612)</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As listening to heavy metal increases by 1 unit, by how much does suicide risk change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>-0.612 units</li>
</ul>
</div>
</div>
</div>
</section>
<section id="predicting-social-anxiety" class="level3">
<h3 class="anchored" data-anchor-id="predicting-social-anxiety">Predicting Social Anxiety</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">soc_anx_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 4
    spai   iii   obq tosca
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    26 56.5   4.43  4.18
 2    51 16.1   2.03  4.20
 3    33 37.4   2.59  3.25
 4   106 16.7   4.84  4.07
 5    25  5.16  1.76  3.80
 6   109 36.0   2.13  4.25
 7    39 34.5   2.01  4.95
 8   134 18.0   1.76  4.52
 9    43 12.9   2.29  3.59
10    57  7.10  3.20  3.64
# ℹ 124 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spai"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tosca"</span>))  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">soc_anx_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb38-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(soc_anx_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-3">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">29.918</td>
<td style="text-align: right;">14.989</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-644.525</td>
<td style="text-align: right;">1295.05</td>
<td style="text-align: right;">1303.743</td>
<td style="text-align: right;">118153.3</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">134</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(soc_anx_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    -54.8     30.0      -1.82 0.0703     -114.       4.60
2 tosca           27.4      7.08      3.87 0.000169     13.4     41.4 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">soc_anx_obq_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> obq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb41-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(soc_anx_obq_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb41-3">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">29.015</td>
<td style="text-align: right;">11.218</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-630.333</td>
<td style="text-align: right;">1268.666</td>
<td style="text-align: right;">1280.197</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">132</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term        estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -53.3      29.2      -1.82 0.0704   -111.        4.50
2 tosca          22.1       7.24      3.05 0.00276     7.77     36.4 
3 obq             7.25      2.91      2.49 0.0141      1.49     13.0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"refit"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.160</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tosca</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">3.052</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">obq</td>
<td style="text-align: right;">0.213</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">2.489</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>anova(soc_anx_lm, soc_anx_obq_lm) |&gt;
broom::tidy()</code></pre>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error message
</div>
</div>
<div class="callout-body-container callout-body">
<p>Error in anova.lmlist(object, …) : models were not all fitted to the same size of dataset</p>
<ul>
<li><p>as of this writing (Mar-04-24), there is a solution listed in the <code>discovr_08</code> tutorial to start by finding the error with <code>soc_anx_tib |&gt; dplyr::summarise( across(.fns = list(valid = ~sum(!is.na(.x)), missing = ~sum(is.na(.x))), .names = "{.col}_{.fn}") )</code></p>
<ul>
<li>The output from running this function in the tutorial is a table showing that there are missing values in <code>obq</code>. this means that <code>spai</code> and <code>tosca</code> have 134 values and <code>obq</code> has 132 values, so they are not the same size.</li>
</ul></li>
<li><p>However, the output above in my own .qmd file throws a <code>deprecated</code> error in <code>dplyr 1.1.4</code> that the use of <code>across</code> without <code>.cols</code> is deprecated since <code>dplyr 1.1.1</code></p></li>
<li><p>this means that I can’t currently generate the table showing the sizes of the datasets with the code provided</p></li>
<li><p>the workaround to the problem is normally to use <code>multiple imputation</code> to estimate the missing values, which is beyond the scope of this tutorial, so Field recommends a <code>very bad practice</code>, which is to omit the missing values.</p></li>
<li><p>I’ve <a href="https://github.com/profandyfield/discovr/issues/17">filed an issue in the <code>discover.rocks</code> repo</a></p></li>
<li><p><a href="https://github.com/profandyfield/discovr/issues/17#issuecomment-1976799279">Fix’t</a></p></li>
</ul>
</div>
</div>
<p>Here is the fixed code, adding <code>.cols = everything()</code>, and the intended output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">soc_anx_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb46-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb46-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valid =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.x)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.x))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{.col}_{.fn}"</span>)</span>
<span id="cb46-4">    )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  spai_valid spai_missing iii_valid iii_missing obq_valid obq_missing
       &lt;int&gt;        &lt;int&gt;     &lt;int&gt;       &lt;int&gt;     &lt;int&gt;       &lt;int&gt;
1        134            0       129           5       132           2
# ℹ 2 more variables: tosca_valid &lt;int&gt;, tosca_missing &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">soc_anx_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> soc_anx_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb48-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>iii) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> _)</span>
<span id="cb48-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(soc_anx_lm, soc_anx_obq_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-6">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-7">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">spai ~ tosca</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">113813.1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">spai ~ tosca + obq</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5213.423</td>
<td style="text-align: right;">6.193</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance in social anxiety do OCD and shame account for?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>14.8%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for shame ranges from 7.77 to 36.42. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 7.77 and 36.42.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As shame increases by 1 unit, by how much does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>22.10 units</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As OCD increases by 1 standard deviation, by how many standard deviations does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>0.213</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The p-value for OCD is 0.014, what does this mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The probability of getting a value of t at least as big as 2.49 if the value of b were, in fact, zero is 0.014. I’m going to assume, therefore, that b isn’t zero (i.e.&nbsp;OCD significantly predicts social anxiety.)</p>
</div>
</div>
</div>
</section>
</section>
<section id="the-beast-of-bias" class="level2">
<h2 class="anchored" data-anchor-id="the-beast-of-bias">The Beast of Bias</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the most important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Linearity and additivity</p>
<p>This assumption is the most important because if it is not met then the phenomenon you’re trying to model is not well represented by the model you are trying to fit</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the least important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Normality of errors</p>
<p>This assumption is the least important because even with non-normal errors the parameter estimates (using ordinary least squares methods) of the model will be unbiased (they match the expected population value) and optimal (they minimize the squared error).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What does homoscedasticity mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The variance in errors from the (population) model is constant at all levels of the predictor variable(s)</p>
</div>
</div>
</div>
<section id="diagnostic-plots" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h3>
<p>Use <code>plot()</code> function</p>
<p><code>plot(my_model, which = numbers_of_the_plots_you_want)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>plot()</code> function can produce 6 plots (below) - default is to produce 1,2,3,5.</p>
<ol type="1">
<li>predicted values from the model (x-axis) against the residuals (y-axis). Use to look for linearity and homoscedasticity.</li>
<li>A Q-Q plot of standardised residuals to look for normality of residuals</li>
<li>predicted values from the model(x-axis) against the square root of the standardized residuals (y-axis). This is a variant of plot 1 and is used to look for linearity and homoscedasticity.</li>
<li>Case number (x-axis) against the Cooks distance (y-axis). This plot can help identify influential cases (large values of Cooks distance).</li>
<li>The leverage value for each case (x-axis) against the standardised residual (y-axis). Used to identify influential cases and outliers. Leverage values indicate the influence of an individual case on the model and are related to the Cooks distance.</li>
<li>The leverage value for each case (x-axis) against the corresponing Cooks distance (y-axis). Used to identify influential cases and outliers.</li>
</ol>
<p>To get plot #1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To get plot #1 and #2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To get all six, use <code>which = 1:6</code></p>
</div>
</div>
<p>Plots below show the patterns of dots we want (random = assumptions met)</p>
<ul>
<li>curvature indicates lack of linearity</li>
<li>funnel shape indicates heteroscedasticity</li>
<li>curvature and funnel shape indicate non-linearity and heteroscedasticity</li>
<li></li>
</ul>
<p><strong>Figure 2</strong> <img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/dsr2_fig_06_29_pred_resid.png" class="img-fluid" alt="Examples of residual plots from Field (2023)"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If both assumptions of linearity and homoscedasticity are met, then these plots should look like a random array of dots and the red trend line should be flat.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparing the plot to those in Figure 2, how would you interpret it?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No problems. random array of dots, no funnels, no bananas.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Based on the Q-Q plot, can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes, the dots line up along the diagonal, indicating a normal distribution.</p>
</div>
</div>
</div>
</section>
<section id="pretty-residual-plots" class="level3">
<h3 class="anchored" data-anchor-id="pretty-residual-plots">Pretty residual plots</h3>
<p>with <code>ggfortify</code>, we can use <code>ggplot2::autoplot()</code> to produce nicely formatted plots that are <code>ggplot2</code> objects, including themes</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using <code>GGfortify</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>for <code>autoplot()</code> function to work, the <code>ggfortify</code> package must be loaded. We can’t use verbose code because <code>ggfortify</code> adds functionality to <code>ggplot2</code> rather than to itself. Need to include <code>library(ggfortify)</code> at the beginning of the document.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(album_full_lm,</span>
<span id="cb54-2">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb54-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>,</span>
<span id="cb54-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#5ec962"</span>,</span>
<span id="cb54-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb54-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb54-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="influential-cases-and-outliers-plots" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-plots">Influential cases and outliers: plots</h2>
<ul>
<li>use Cook’s distance to identify influential cases and</li>
<li>use standardized residuals to check for outliers</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>in an average sample,
<ul>
<li>95% of standardized residuals should lie between <img src="https://latex.codecogs.com/png.latex?%5Cpm1.96"> and</li>
<li>99% should lie between <img src="https://latex.codecogs.com/png.latex?%5Cpm2.58">, and</li>
<li>any case for which absolute value of the standardized residual is 3 or more, is likely to be an outlier</li>
</ul></li>
<li>Cook’s distance measure the influence of a single case on model as a whole.
<ul>
<li>absolute values greater than 1 may be cause for concern</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(album_full_lm,</span>
<span id="cb55-2">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb55-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>,</span>
<span id="cb55-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#5ec962"</span>,</span>
<span id="cb55-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb55-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb55-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>First plot show Cook’s distance and labels cases with largest values (1, 164, 169), but largest values are in the region of 0.06, well below the threshold of 1.</li>
<li>second shows leverage values plotted against standardized residuals
<ul>
<li>we want the green trend line to be flat and lie along zero, which is the case here</li>
<li>if the trend line deviates substantially from horizontal, then it indicates one of the assumptions of the model has been violated</li>
<li>this plot usually also has red dashed lines indicating values of Cook’s distance of 0.5 and 1. this plot has none, indicating all values of Cook’s distance are well below thresholds.</li>
</ul></li>
<li>Final plot shows leverage, Cook’s distance, and the standardized residual on the same plot.
<ul>
<li>can be used to identify cases that have high leverage, high Cook’s distance, large residual, or some combination of all three.</li>
<li>e.g.&nbsp;across the plots, case 164 has a standardized residual between -2.5 and -3 and the largest Cook’s distance (although still only around 0.7)</li>
</ul></li>
</ul>
</section>
<section id="influential-cases-and-outliers-numbers" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-numbers">Influential cases and outliers: numbers</h2>
<p>For a more precise look, we can see values for Cook’s distance and standardized residuals using <code>broom::augment()</code>. All we need to do is pass the lm object into the function and save the results as a new tibble. also useful to save the case number as a variable so that you can identify cases should you need to.</p>
<ul>
<li>create a new tibble called <code>album_full_rsd</code> (rsd for <code>residuals</code>) by
<ul>
<li>piping model into <code>broom::augment()</code> to get residuals, then</li>
<li>into <code>tibble::row_id_to_column()</code> to create a variable that contains the row number</li>
</ul></li>
<li>the <code>var = "case_no"</code> tells the function to name the variable containing the numbers <code>case_no</code></li>
<li>the result is a tibble called <code>album_full_rsd</code> that contains the case number, the original data to which the model was fitted, and various diagnostic statistics.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
De-bug: residuals when you have missing values
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have missing values in the data and used <code>na.action = na.exclude</code> when fitting the model, you must also tell <code>augment()</code> where to find the original data so it can map the residuals to the original cases.</p>
<p>In this case: <code>album_full_rsd &lt;- album_full_lm |&gt;    broom::augment(data = album_tib)</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">album_full_rsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> album_full_lm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-2">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-3">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_no"</span>) </span>
<span id="cb56-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(album_full_rsd) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb56-5">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb56-6">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ sales      &lt;dbl&gt; 330, 120, 360, 270, 220, 170
$ adverts    &lt;dbl&gt; 10.256, 985.685, 1445.563, 1188.193, 574.513, 568.954
$ airplay    &lt;dbl&gt; 43, 28, 35, 33, 44, 19
$ image      &lt;dbl&gt; 10, 7, 7, 7, 5, 5
$ .fitted    &lt;dbl&gt; 229.9203, 228.9490, 291.5576, 262.9760, 225.7529, 141.0954
$ .resid     &lt;dbl&gt; 100.079745, -108.948992, 68.442368, 7.024026, -5.752861, 28…
$ .hat       &lt;dbl&gt; 0.047190526, 0.008006536, 0.020700427, 0.012560946, 0.02606…
$ .sigma     &lt;dbl&gt; 46.63346, 46.55347, 46.94739, 47.20520, 47.20607, 47.16186
$ .cooksd    &lt;dbl&gt; 5.870388e-02, 1.088943e-02, 1.140066e-02, 7.166478e-05, 1.0…
$ .std.resid &lt;dbl&gt; 2.1774041, -2.3230828, 1.4688016, 0.1501160, -0.1237983, 0.…</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">sales</th>
<th style="text-align: right;">adverts</th>
<th style="text-align: right;">airplay</th>
<th style="text-align: right;">image</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">10.26</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">229.92</td>
<td style="text-align: right;">100.08</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">46.63</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">2.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">985.68</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">228.95</td>
<td style="text-align: right;">-108.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">46.55</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">1445.56</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">291.56</td>
<td style="text-align: right;">68.44</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">46.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">1188.19</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">262.98</td>
<td style="text-align: right;">7.02</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">574.51</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">225.75</td>
<td style="text-align: right;">-5.75</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">568.95</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">141.10</td>
<td style="text-align: right;">28.90</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.16</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.62</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Standardized residuals are in a variable called <code>.std.resid</code> and the Cook’s distances in <code>.cooksd</code></p>
<p>to see what percentage of standardized residuals fall outside the limits of 1.96 (95%), 2-2.5 (99%) or above 3, we can filter the tibble using the <code>abs()</code> function to return the absolute value (ignoring the plus/minus signs) of the residual</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb58-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   case_no .std.resid .resid
     &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
 1     164      -2.63 -121. 
 2      47      -2.46 -115. 
 3      55      -2.46 -114. 
 4      68      -2.36 -110. 
 5       2      -2.32 -109. 
 6     200      -2.09  -97.2
 7     167      -2.00  -93.6
 8     100       2.10   97.3
 9      52       2.10   97.4
10      61       2.10   98.8
11      10       2.13   99.5
12       1       2.18  100. 
13     169       3.09  144. </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb60-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     164      -2.63  -121.
2     169       3.09   144.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb62-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     169       3.09   144.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>13/200 = 6.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>2/200 = 1%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No, the appropriate proportion of cases have standardized residuals in the expected range and no case has a value grossly exceeding 3.</p>
</div>
</div>
</div>
<ul>
<li>Something similar with Cook’s distance…we can filter the tibble to look at cases with cooksd&gt;1, or sort the tibble in descending order using <code>arrange()</code></li>
<li>also use <code>select()</code> so we only see Cook’s value and case numbers</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb64-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(.cooksd)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb64-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .cooksd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1     164  0.0708
 2       1  0.0587
 3     169  0.0509
 4      55  0.0404
 5      52  0.0332
 6     100  0.0314
 7     119  0.0308
 8      99  0.0281
 9     200  0.0251
10      47  0.0241
# ℹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>no cooksd&gt;1 so no cases having undue influence on the model as a whole</li>
</ul>
</section>
<section id="robust-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="robust-linear-models">Robust linear models</h2>
<ul>
<li>model appears to be accurate for the sample and generalizable to the population</li>
<li>not always the case though</li>
<li>2 things to do
<ul>
<li>test whether the parameter estimates have been biased</li>
<li>check whether confidence intervals and significance tests have been biased</li>
</ul></li>
</ul>
<section id="robust-parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="robust-parameter-estimates">Robust parameter estimates</h3>
<ul>
<li>use <code>robust::lmRob()</code></li>
<li>used the same way as <code>lm()</code></li>
<li>replace <code>lm()</code> with <code>lmRob()</code></li>
<li>can’t use any <code>broom</code> functions with <code>lmRob()</code>, so text output using <code>summary()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">album_full_rob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmRob</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb66-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_rob)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmRob(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-124.62  -30.47   -1.76   28.89  141.35 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -31.523201  21.098348  -1.494 0.136756    
adverts       0.085295   0.008501  10.033  &lt; 2e-16 ***
airplay       3.418749   0.339017  10.084  &lt; 2e-16 ***
image        11.771441   2.973559   3.959 0.000105 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44.61 on 196 degrees of freedom
Multiple R-Squared: 0.5785 

Test for Bias:
            statistic p-value
M-estimate      2.299  0.6809
LS-estimate     7.659  0.1049</code></pre>
</div>
</div>
<ul>
<li>bottom of output givessignificance tests of bias</li>
<li>significance tests need to be interpreted within the context of sample size, but these tests suggest that bias in the original model is not problematic
<ul>
<li><img src="https://latex.codecogs.com/png.latex?p">-value is not significant</li>
</ul></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Original <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
<th>Robust <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adverts</td>
<td>0.085</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>Airplay</td>
<td>3.37</td>
<td>3.42</td>
</tr>
<tr class="odd">
<td>Image</td>
<td>11.09</td>
<td>11.77</td>
</tr>
</tbody>
</table>
<ul>
<li>estimates are virtually identical to the originals, suggesting the original model is unbiased</li>
</ul>
</section>
</section>
<section id="robust-confidence-intervals-and-significance-tests" class="level2">
<h2 class="anchored" data-anchor-id="robust-confidence-intervals-and-significance-tests">Robust Confidence Intervals and significance tests</h2>
<ul>
<li><p>to test whether confidence intervals and significance tests are biased, we can estimate the model with standard errors designed for heteroscedastic residuals</p></li>
<li><p>if the sample is small, use a bootstrap</p></li>
<li><p>both can be done by placing the model in the <code>parameters::model_parameters()</code> function</p></li>
<li><p>same function to standardize parameter estimates, but three new arguments</p></li>
<li><p>we can obtain models based on robust standard errors by setting <code>vcov = "method"</code> and replacing <code>method</code> with the name of the method we want to use to compute robust standard errors.</p></li>
<li><p><code>vcov = "HC3"</code> willuse HC3 method, though some think <code>HC4</code> is better</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vcov =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HC4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.242</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.645</td>
<td style="text-align: right;">5.419</td>
<td style="text-align: right;">-1.638</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">12.306</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.749</td>
<td style="text-align: right;">3.986</td>
<td style="text-align: right;">10.738</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.260</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.630</td>
<td style="text-align: right;">15.543</td>
<td style="text-align: right;">4.906</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vcov =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HC3"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.170</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.503</td>
<td style="text-align: right;">5.277</td>
<td style="text-align: right;">-1.646</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">12.246</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.315</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.746</td>
<td style="text-align: right;">3.989</td>
<td style="text-align: right;">10.687</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.247</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.654</td>
<td style="text-align: right;">15.519</td>
<td style="text-align: right;">4.933</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Values are not much different from the non-robust versions, mainly becasue the original model didn’t violate its assumptions</li>
<li>if a robust model yields the same-ish values as a non-robust model, we know the non-robust model has not been unduly biased.</li>
<li>if the robust estimates are hugely different, then use and report the robust versions</li>
<li>fitting a robust model is a win-win</li>
</ul>
<section id="small-samples" class="level3">
<h3 class="anchored" data-anchor-id="small-samples">Small samples</h3>
<ul>
<li>we might prefer to bootstrap confidence intervals by setting the bootstrap argument in <code>model_parameters()</code> to <code>TRUE</code></li>
<li>by default, 1000 bootstrap samples are used</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb70-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.355</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-55.353</td>
<td style="text-align: right;">6.875</td>
<td style="text-align: right;">0.112</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.361</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.793</td>
<td style="text-align: right;">3.945</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">10.940</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.355</td>
<td style="text-align: right;">15.096</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>these bootstrapped confidence intervals don’t rely on assumptions of normality or homoscedasticity, so they give an accurate estimate of the population value of <img src="https://latex.codecogs.com/png.latex?b"> for each predictor (assuming our sample is one of the 95% with confidence intervals that contain the population value)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because bootstrapping relies on random sampling from the data, you will get a slightly different estimate each time you bootstrap a model. This is normal.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping is a technique from which the sampling distribution of a statistic is estimated by …
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Taking repeated samples (with replacement) from the data set.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The bootstrap confidence interval for image ranges from 6.63 to 15.45 (the values might not exactly match these). What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 6.63 and 15.45.</p>
</div>
</div>
</div>
</section>
</section>
<section id="unguided-example-1" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example-1">Unguided example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1">soc_anx_obq_rsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> soc_anx_obq_lm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb73-2">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb73-3">    tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_no"</span>) </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(soc_anx_obq_rsd) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-2">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-3">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ spai       &lt;dbl&gt; 26, 51, 33, 106, 25, 109
$ iii        &lt;dbl&gt; 56.45161, 16.12903, 37.41935, 16.67742, 5.16129, 36.03226
$ obq        &lt;dbl&gt; 4.425287, 2.034483, 2.586207, 4.839080, 1.758621, 2.126437
$ tosca      &lt;dbl&gt; 4.181818, 4.204545, 3.250000, 4.068182, 3.795455, 4.250000
$ .fitted    &lt;dbl&gt; 71.21490, 54.38582, 37.29426, 71.70370, 43.34703, 56.05675
$ .resid     &lt;dbl&gt; -45.214901, -3.385823, -4.294257, 34.296304, -18.347028, 52…
$ .hat       &lt;dbl&gt; 0.03290194, 0.01449059, 0.06325813, 0.05273344, 0.02419968,…
$ .sigma     &lt;dbl&gt; 28.84302, 29.12634, 29.12526, 28.96090, 29.08160, 28.74430
$ .cooksd    &lt;dbl&gt; 2.847631e-02, 6.772251e-05, 5.263717e-04, 2.737010e-02, 3.3…
$ .std.resid &lt;dbl&gt; -1.5846267, -0.1175478, -0.1529180, 1.2144842, -0.6401266, …</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">spai</th>
<th style="text-align: right;">iii</th>
<th style="text-align: right;">obq</th>
<th style="text-align: right;">tosca</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">56.45</td>
<td style="text-align: right;">4.43</td>
<td style="text-align: right;">4.18</td>
<td style="text-align: right;">71.21</td>
<td style="text-align: right;">-45.21</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">28.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-1.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">54.39</td>
<td style="text-align: right;">-3.39</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">37.42</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">37.29</td>
<td style="text-align: right;">-4.29</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">16.68</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">71.70</td>
<td style="text-align: right;">34.30</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">28.96</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">1.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">5.16</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">43.35</td>
<td style="text-align: right;">-18.35</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">29.08</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">36.03</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">4.25</td>
<td style="text-align: right;">56.06</td>
<td style="text-align: right;">52.94</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">28.74</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">1.84</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb76-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb76-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb76-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1      49      -2.26  -65.1
2      16      -2.13  -61.1
3     127      -1.98  -56.7
4     120       2.18   62.9
5       8       2.61   74.6
6      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb78-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb78-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb78-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1       8       2.61   74.6
2      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb80-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb80-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb80-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# ℹ 3 variables: case_no &lt;int&gt;, .std.resid &lt;dbl&gt;, .resid &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb82-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(.cooksd)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb82-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .cooksd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1       8  0.0724
 2      45  0.0497
 3      14  0.0397
 4      40  0.0373
 5      16  0.0330
 6      87  0.0304
 7     127  0.0289
 8       1  0.0285
 9       4  0.0274
10      12  0.0268
# ℹ 124 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would you interpret the plot of ZPRED vs ZRESID?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I can’t see any problems</p>
<p>The dots look like a random, evenly-dispersed pattern. No funnel shapes, no banana shapes, so all is fine.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes The distribution is fairly normal: the dots in the P-P plot lie close to the diagonal.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>4.55% 6 cases from 132 have standardized residuals with absolute values greater than 1.96, and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B6%7D%7B132%7D%C3%97100=4.55"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>1.51% 2 cases from 132 have standardized residuals with absolute values greater than 2.5, and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B2%7D%7B132%7D%C3%97100=1.51"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The appropriate proportion of cases have standardized residuals in the expected range and no case has a value exceeding 3.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are there any Cook’s distances greater than 1?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The fact there are no Cook’s distances greater than 1 suggests that no cases are having undue influence on the model as a whole.</p>
</div>
</div>
</div>
</section>
<section id="bayesian-approaches" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-approaches">Bayesian Approaches</h2>
<ul>
<li>2 possible things to do
<ul>
<li>compare models using Bayes factors</li>
<li>estimate model parameters using Bayesian methods</li>
</ul></li>
</ul>
<section id="bayes-factors" class="level3">
<h3 class="anchored" data-anchor-id="bayes-factors">Bayes factors</h3>
<ul>
<li>compare models using a Bayes factor using <code>regressionBF()</code> funtion in the <code>BayesFactor</code> package</li>
<li>compare models against each other hierarchically to see which model has the largest Bayes factor, and to evaluate the strength of evidence that this Bayes factor suggests that a particular model predicts the outcome better than the intercept alone (i.e.&nbsp;a model with no predictors).</li>
</ul>
<p><code>model_bf &lt;- BayesFactor::regressionBF(formula, rscaleCont = "medium", data = tibble)</code></p>
<ul>
<li>creates an object called <code>model_bf</code> based onthe same type of formula we put in the <code>lm()</code> function to specify the model</li>
<li>the argument <code>rscaleCont</code> sets the scale of the prior distribution for the distribution for the standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7Ds"> in the model.</li>
<li>arguemnt can be set as a numeric value or one of three pre-defined values</li>
<li>default value is <code>medium</code>, corresponding to a value of about <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B4%7D">, or about 0.354</li>
<li>example uses the default to illustrate, but consider what value is appropriate for a given model</li>
</ul>
<p>Fitting the model with Bayes factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1">album_bf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regressionBF</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscaleCont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1">album_bf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts                   : 1.320123e+16 ±0%
[2] airplay                   : 4.723817e+17 ±0.01%
[3] image                     : 6039.289     ±0%
[4] adverts + airplay         : 5.65038e+39  ±0%
[5] adverts + image           : 2.65494e+20  ±0%
[6] airplay + image           : 1.034464e+20 ±0%
[7] adverts + airplay + image : 7.746101e+42 ±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>Output shows Bayes factors for all potential models we can get from our predictor variables (7 in total)</li>
<li>each model is compared to a model that contains only the intercept</li>
<li>all models have huge Bayes factors suggesting they all provide strong evidence for the hypothesis that the model predicts the outcome better than the intercept alone</li>
<li>best model is the one with the largest Bayes factor, which is model 7, which includes all three predictors - it has a Bayes factor of <img src="https://latex.codecogs.com/png.latex?7.75%C3%9710%5E%7B42%7D"></li>
</ul>
</section>
</section>
<section id="bayesian-parameter-estimates" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-parameter-estimates">Bayesian parameter estimates</h2>
<ul>
<li>knowing model is best ( we know this from the nonBayesian model) we can estimate the parameters using the <code>lmBF()</code> function</li>
<li>same format as <code>regressionBF()</code></li>
<li><code>lmBF()</code> fits only the model we specify</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1">album_full_bf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmBF</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscaleCont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1">album_full_bf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts + airplay + image : 7.746101e+42 ±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>same result in the previous output</li>
<li>but we can extract <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">-values derived from Bayesian estimaten and their credible intervals using the <code>posterior()</code> function
<ul>
<li>enter the name of the model we just created <code>album_full_bf</code> into ’posterior()` function in which we also set the number of iterations to 10000</li>
<li>samples taken from the posterios distribution of the <code>album_full_bf</code> model and stored in an object called <code>album_full_post</code></li>
<li>place posterios samples into <code>summary()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1">album_full_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior</span>(album_full_bf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iterations =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>)</span>
<span id="cb92-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_post) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1:10000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

             Mean        SD  Naive SE Time-series SE
mu      1.932e+02 3.339e+00 3.339e-02      3.339e-02
adverts 8.403e-02 6.911e-03 6.911e-05      6.874e-05
airplay 3.337e+00 2.785e-01 2.785e-03      2.764e-03
image   1.098e+01 2.430e+00 2.430e-02      2.430e-02
sig2    2.246e+03 2.295e+02 2.295e+00      2.379e+00
g       9.908e-01 1.730e+00 1.730e-02      1.757e-02

2. Quantiles for each variable:

             2.5%       25%       50%       75%     97.5%
mu      1.868e+02 1.910e+02 1.932e+02 1.955e+02 1.997e+02
adverts 7.042e-02 7.933e-02 8.405e-02 8.861e-02 9.752e-02
airplay 2.795e+00 3.150e+00 3.337e+00 3.525e+00 3.880e+00
image   6.243e+00 9.380e+00 1.100e+01 1.258e+01 1.577e+01
sig2    1.837e+03 2.085e+03 2.229e+03 2.389e+03 2.732e+03
g       1.736e-01 3.723e-01 6.127e-01 1.062e+00 4.042e+00</code></pre>
</div>
</div>
<ul>
<li>Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> can be found in the column labeled <code>Mean</code>
<ul>
<li>0.084 for adverts</li>
<li>3.34 for airplay</li>
<li>10.96 for image</li>
</ul></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Predictor</th>
<th>Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
<th>non-Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>adverts</td>
<td>0.084</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>airplay</td>
<td>3.34</td>
<td>3.37</td>
</tr>
<tr class="odd">
<td>image</td>
<td>10.96</td>
<td>11.09</td>
</tr>
</tbody>
</table>
<ul>
<li>most useful are the <code>credible intervals</code> for these parameters
<ul>
<li>if we want the 95% credible interval, then we read the values from columns labelled 2.5% and 97.5% in the table of quantiles</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unlike confidence intervals, credible intervals contain the population value with a probability of 0.95 (95%)</p>
</div>
</div>
<ul>
<li><p>there is a 95% probability that the population value of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> lies between | Predictor | 2.5% | 97.5% | | — | — | — | | adverts | 0.07 | 0.097 | | airplay | 2.78 | 3.87 | | image |6.26 | 15.86 |</p></li>
<li><p>these intervals are constructed assuming that an effect exists, so you cannot use them to test the hypothesis that the null is exactly 0, only to establish plausible population values of the <img src="https://latex.codecogs.com/png.latex?b">s in the model.</p></li>
</ul>


</section>
</section>

 ]]></description>
  <category>regression</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_08_the_glm/</guid>
  <pubDate>Mon, 26 Feb 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_08_the_glm/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Simple Regression</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/simple-regression/</link>
  <description><![CDATA[ 





<section id="regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="regression-equation">Regression Equation</h2>
<p>Linear regression expresses the relationship between two variables, <img src="https://latex.codecogs.com/png.latex?X_i"> and <img src="https://latex.codecogs.com/png.latex?Y_i">.</p>
<p>The <img src="https://latex.codecogs.com/png.latex?_i"> refers to the cases in the dataset, so if there are 1000 cases, then <img src="https://latex.codecogs.com/png.latex?_i"> is 1-1000. Each <img src="https://latex.codecogs.com/png.latex?_i"> refers to a ‘student’.</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_i%7D+%5Cepsilon_i"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?b_1"> is the slope or regression coefficient (how much <img src="https://latex.codecogs.com/png.latex?Y"> will change when <img src="https://latex.codecogs.com/png.latex?X"> increases by 1)<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?b_0"> is the <img src="https://latex.codecogs.com/png.latex?Y">-intercept, where the regression line crosses the <img src="https://latex.codecogs.com/png.latex?Y"> axis</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cepsilon_i"> is the error term</li>
</ul>
<p>or</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+%7Bb_1%7D%7BX_i%7D"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"> is the predicted value of <img src="https://latex.codecogs.com/png.latex?Y"></li>
</ul>
<p>Notes:</p>
<p>Larger values of <img src="https://latex.codecogs.com/png.latex?b_1"> indicate a steeper regression line</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/slope.png" class="img-fluid figure-img"></p>
<figcaption>examples of slope and intercept</figcaption>
</figure>
</div>
<ul>
<li>left image, red is positive slope and green is negative slope (negative correlation; when predictor increases, outcome decreases)</li>
<li>right image, all slopes positive</li>
</ul>
</section>
<section id="calculating-regression" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression">Calculating Regression</h2>
<ul>
<li>any dataset is made up of points, and regression finds the best fitting straight line for the dataset</li>
</ul>
</section>
<section id="best-fit" class="level2">
<h2 class="anchored" data-anchor-id="best-fit">Best Fit</h2>
<ul>
<li>need to define mathematically the distance between each data point and the regression line<br>
</li>
<li>for every <img src="https://latex.codecogs.com/png.latex?X"> value in the data, the linear equation can determine the <img src="https://latex.codecogs.com/png.latex?Y"> value on the line - called <strong>predicted <img src="https://latex.codecogs.com/png.latex?Y"></strong>, or <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"></li>
<li>this distance measures the error between the line and the data</li>
<li>if all data points were on the line, then the line ‘fits’ the data perfectly</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"> should be close to actual <img src="https://latex.codecogs.com/png.latex?Y"></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/predicted.png" class="img-fluid figure-img"></p>
<figcaption>graph showing the difference between predicted and actual values of <img src="https://latex.codecogs.com/png.latex?Y"></figcaption>
</figure>
</div>
<ul>
<li>green dots = <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"></li>
<li>blue dots = <img src="https://latex.codecogs.com/png.latex?Y"></li>
<li>distance between the green and blue dots is the prediction error - need to minimize</li>
<li>some are positive (above the line) and some are negative (below the line)<br>
</li>
<li>since some are positive and some are negative, if we want to add the error values together, we need to get rid of the signs by squaring the distance and adding the squared error</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?total%20%5Cspace%20squared%20%5Cspace%20error%20=%7B%5Csum%5En_%7Bi=1%7D%7D(%7BY_i%7D-%7B%5Chat%7BY_i%7D%7D)%5E2"></p>
<ul>
<li>for each poissible line, we can calculate the total squared error, then choose the line with the lowest total squared error, which is the regression line</li>
<li>this minimizes the difference between the line and the observed data</li>
<li>this line is called the <em>least squared error</em> solution</li>
<li>this method is inefficient due to the infinite number of lines possible</li>
<li>calculus is a mathematical technique to find the maxima or minima of a mathematical expression.</li>
<li>Using this method, the regression coefficients (slope (<img src="https://latex.codecogs.com/png.latex?b_1">) and intercept (<img src="https://latex.codecogs.com/png.latex?b_0">)) that produce the minimum errors can be calculated.</li>
</ul>
</section>
<section id="calculating-regression-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression-coefficients">Calculating Regression Coefficients</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D_i=b_0+b_1X_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_0%7D=M_Y-%5Chat%7Bb_1%7DM_x"></p>
<p>Where</p>
<p><img src="https://latex.codecogs.com/png.latex?r"> is the correlation between <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?S_X"> and <img src="https://latex.codecogs.com/png.latex?S_Y"> are sample standard deviations for <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?M_X"> and <img src="https://latex.codecogs.com/png.latex?M_Y"> are sample means for <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"></p>
<p>These are <em>raw regression coefficients</em> (<img src="https://latex.codecogs.com/png.latex?b_1">): the change in outcome is associated with a change in the predictor</p>
<section id="standardized-regression-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="standardized-regression-coefficients">Standardized regression coefficients</h3>
<ul>
<li>tell us the same thing, except expressed as standard deviations</li>
<li>if both variables <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"> have been standardized by transforming tehm into <em>Z-scores</em> before calculating the regression coefficients, then the regression coefficients become *standardized coefficients</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D=%5Cbeta%7BZ_%7BX_i%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbeta=r"></p>
<p>Where</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D"> is the standard deviation of <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BX_i%7D%7D"> is the styandard deviation of <img src="https://latex.codecogs.com/png.latex?X"><br>
<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> is the correlation coefficient</p>
<p>Standardizing <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"> puts the variables on the same scale - when <img src="https://latex.codecogs.com/png.latex?X"> increases by 1SD, <img src="https://latex.codecogs.com/png.latex?Y"> increases by 1SD</p>
</section>
</section>
<section id="analysis-of-regression" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-regression">Analysis of regression</h2>
<ul>
<li>regression line is only a model based on the data</li>
<li>process of testing the significance of a regression equation is called <em>analysis of regression</em></li>
<li>null hypothesis in the analysis of regression states that the equation does not account for a significant proportion of the variance in <img src="https://latex.codecogs.com/png.latex?Y"> scores</li>
<li>analysis of regression is similar to ANOVA</li>
</ul>
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/anoreg.png" class="img-fluid"></p>
<p>Sum Square Total (<img src="https://latex.codecogs.com/png.latex?SS_T"> (left plot)) is <img src="https://latex.codecogs.com/png.latex?%5Csum(Y-%5Cbar%7BY%7D)%5E2"></p>
<p>Sum Square Residual (<img src="https://latex.codecogs.com/png.latex?SS_R"> (right plot)) is <img src="https://latex.codecogs.com/png.latex?%5Csum(Y-%5Chat%7BY%7D)%5E2"></p>
<ul>
<li>prediction error - squared distance between the data and the regression line</li>
<li>needs to be minimized</li>
<li>this is the variability that is not explained by the regression equation</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/ssm.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Sum Square model (<img src="https://latex.codecogs.com/png.latex?SS_M">) is <img src="https://latex.codecogs.com/png.latex?%5Csum(%5Chat%7BY%7D-%5Cbar%7BY%7D)%5E2"></p>
<ul>
<li><p>in this equation, <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+b_1X"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_T">: total variability is the variability between the scores and the mean<br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_R">: sum squared residual is the residual or error variability between the regression model and the data<br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_M"> or sum square regression: Model variability - difference in variability between the model and the mean.<img src="https://latex.codecogs.com/png.latex?Y"> are determined by the value of <img src="https://latex.codecogs.com/png.latex?X"><br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_T"> is the sum of <img src="https://latex.codecogs.com/png.latex?SS_R"> and <img src="https://latex.codecogs.com/png.latex?SS_M"></p>
<ul>
<li>part of the variability is residual - we don’t know what is causing<br>
</li>
<li>part of it is due to the model - the relationship between <img src="https://latex.codecogs.com/png.latex?Y"> and <img src="https://latex.codecogs.com/png.latex?X"></li>
</ul></li>
</ul>
<p>The proportion of variability in <img src="https://latex.codecogs.com/png.latex?Y"> that is predicted by its relationship with <img src="https://latex.codecogs.com/png.latex?X">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BSS_%7Bregression%7D%7D%7BSS_T%7D=r%5E2"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is an effect size that tells us the proportion of variability that is accounted for by the model</p>
<p>The proportion of the variability that is not accounted for is</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BSS_%7Bresidual%7D%7D%7BSS_T%7D=1-r%5E2"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is very mieaningful</p>
<p>if <img src="https://latex.codecogs.com/png.latex?R%5E2"> is 20%, then the amount of the variability in <img src="https://latex.codecogs.com/png.latex?Y"> that is accounted for by the model is 20%, which is quite large.</p>
<p>Therefore</p>
<p><img src="https://latex.codecogs.com/png.latex?SS_%7Bregression%7D=r%5E2SS_T"></p>
<p><img src="https://latex.codecogs.com/png.latex?SS_%7Bresidual%7D=(1-r%5E2)SS_Y"></p>
<p><img src="https://latex.codecogs.com/png.latex?SS_Y"> is the same thing as <img src="https://latex.codecogs.com/png.latex?SS_T"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is the Pearson Correlation Coefficient squared</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/components.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Total variability is partitioned into two - sum squared regression (explained by the model) and sum squared residual (not explained by the model).</p>
<p>Same for degrees of freedom</p>
<p>Sums of squares are total values and can be expressed as averages called <em>Mean Squares</em>, or <img src="https://latex.codecogs.com/png.latex?MS"> AKA <em>variance</em></p>
<p><img src="https://latex.codecogs.com/png.latex?MS_%7Bregression%7D=%5Cfrac%7BSS_%7Bregression%7D%7D%7Bdf_%7Bregression%7D%7D"></p>
<ul>
<li>mean square variance is the variance accounted for in the model</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?MS_%7Bresidual%7D=%5Cfrac%7BSS_%7Bresidual%7D%7D%7Bdf_%7Bresidual%7D%7D"></p>
<ul>
<li>mean square residual is the variance not accounted for in the model</li>
</ul>
<p>An <img src="https://latex.codecogs.com/png.latex?F">-ratio can be used to compare these two mean squares</p>
<p><img src="https://latex.codecogs.com/png.latex?F=%5Cfrac%7BMS_%7Bregression%7D%7D%7BMS_%7Bresidual%7D%7D%20%5Ctext%7Bwith%7D%5C:%20df=1,n-2"></p>
<ul>
<li>if the mean square regression is small compared to the mean square residual, then the model does not account for much variance<br>
</li>
<li>if the mean square regression is larger than the mean square residual, then the model accounts for more variance</li>
</ul>
</section>
<section id="an-example-fields" class="level2">
<h2 class="anchored" data-anchor-id="an-example-fields">An Example (Fields)</h2>
<ul>
<li>record company boss interested in predicting album sales from advertising bsed on 200 different album releases<br>
</li>
<li>outcome variable: sales of CDs and downloads in the week after release<br>
</li>
<li>predictor variable: amount in GBP spent promoting the album before release</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/album-sales.png" class="img-fluid figure-img"></p>
<figcaption>scatterplot of album sales by advertising budget</figcaption>
</figure>
</div>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> = 0.335, so 33.5% of the variability is shared by both variables (cutoffs, 9% - small, 25% - large effect size)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/model-summary.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/anova.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/coefficients.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
</section>
<section id="activities" class="level2">
<h2 class="anchored" data-anchor-id="activities">Activities</h2>
<p>In a survey that included assessment of husband and wife heights, Hodges, Krech and Crutchfield (1975) reported the following results. Let’s treat wife height as the predictor (X) variable and husband as the outcome (Y) variable:<br>
<img src="https://latex.codecogs.com/png.latex?r_XY"> = .32, <img src="https://latex.codecogs.com/png.latex?N"> = 1, 296<br>
Wife height: <img src="https://latex.codecogs.com/png.latex?M_X"> = 64.42, <img src="https://latex.codecogs.com/png.latex?S_X"> = 2.56<br>
Husband height: <img src="https://latex.codecogs.com/png.latex?M_Y"> = 70.46, <img src="https://latex.codecogs.com/png.latex?S_Y"> = 2.87<br>
a. Calculates the values of <img src="https://latex.codecogs.com/png.latex?b_0"> and <img src="https://latex.codecogs.com/png.latex?b_1"> to predict husband height in inches (Y) from wife height in inches (X), and write out this raw score predictive equation</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32%5Cfrac%7B2.87%7D%7B2.56%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=0.35"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=M_Y-%5Chat%7Bb_1%7DM_X"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=70.46-(0.35*64.42)"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=70.46-22.54"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=47.91"></p>
<p>Predictive Equation <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+%7Bb_1%7D%7BX_i%7D"> <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=47.91+(0.35*%7BX_i%7D)"></p>
<ol start="2" type="a">
<li>For women: what is your own height? Substitute your own height into the equation from step a, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=47.91+(0.35*67)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=71.36"></p>
<ol start="3" type="a">
<li>Now reverse the roles of the variables (i.e., use husband height as the predictor and wife height as the outcome variable). Calculates the values of bb0 and bb1.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32%5Cfrac%7B2.56%7D%7B2.87%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32*.89"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.28"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=M_Y-%5Chat%7Bb_1%7DM_X"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=64.42-(0.28*70.46)"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=64.42-19.72"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=44.7"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=44.7+(0.28*%7BX_i%7D)"></p>
<ol start="4" type="a">
<li>For men: what is your height in inches? Substitute your own height into the equation from step c, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=44.7+(0.28*70)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=64.3"></p>
<ol start="5" type="a">
<li>What proportion of variance in husband height is predictable from wife height? Test the significance of the regression equation.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2=.10"></p>
<ol start="6" type="a">
<li>If both X and Y have been standardized by transforming into Z scores before calculating the regression coefficients, what would be the values of bb0 and bb1 to predict husband height in inches (Y) from wife height in inches (X)? How does this standardized version of the prediction equation tell us about “regression toward the mean” for predictions?</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D=%5Cbeta%7BZ_%7BX_i%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7B2.87%7D=0.32%7B2.56%7D"></p>


</section>

 ]]></description>
  <category>505</category>
  <guid>https://cmadland.github.io/blog/posts/simple-regression/</guid>
  <pubDate>Sun, 18 Feb 2024 08:00:00 GMT</pubDate>
</item>
</channel>
</rss>
