<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Stats Blog</title>
<link>https://cmadland.github.io/blog/</link>
<atom:link href="https://cmadland.github.io/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Colins Stats Blog</description>
<generator>quarto-1.4.545</generator>
<lastBuildDate>Tue, 16 Apr 2024 07:00:00 GMT</lastBuildDate>
<item>
  <title>discover_06 - The Beast of Bias</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_06_bias/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/download_festival.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 810 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): gender
dbl (4): ticket_no, day_1, day_2, day_3

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">download_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ticket_no =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(ticket_no),</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(gender) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-5">      forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Non-binary"</span>)</span>
<span id="cb5-6">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">download_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 810 × 5
   ticket_no gender day_1 day_2 day_3
   &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2111      Male    2.64  1.35  1.61
 2 2229      Female  0.97  1.41  0.29
 3 2338      Male    0.84 NA    NA   
 4 2384      Female  3.03 NA    NA   
 5 2401      Female  0.88  0.08 NA   
 6 2405      Male    0.85 NA    NA   
 7 2467      Female  1.56 NA    NA   
 8 2478      Female  3.02 NA    NA   
 9 2490      Male    2.29 NA    NA   
10 2504      Female  1.11  0.44  0.55
# ℹ 800 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of the following describes tidy data?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Data that are arranged such that scores on a variable appear in a single column and rows represent a combination of the attributes of those scores – the entity from which the scores came, when the score was recorded, etc. Scores from a single entity can appear over multiple rows where each row represents a combination of the attributes of the score – for example, levels of an independent variable or time point at which the score was recorded.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are the download data in tidy or messy format?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Messy</p>
<p>Correct - well done! The download data are messy because the hygiene scores on different days are spread across different columns rather than being in a single colum with an additional column to indicate the day of the festival that the hygiene score was measured.</p>
</div>
</div>
</div>
<p><code>tidyr</code> has two functions for converting data from messy to tidy. - <code>pivot_longer()</code> takes columns and puts them into rosw to make messy data tidy - <code>pivot_wider()</code> takes rows and puts them in columns to make tidy data messy</p>
<section id="making-messy-data-tidy" class="level2">
<h2 class="anchored" data-anchor-id="making-messy-data-tidy">Making messy data tidy</h2>
<pre><code>tidyr::pivot_longer(
  data = tibble,
  cols = column_names,
  names_to = "name_of_column_to_contain_variable_names",
  values_to = "name_of_column_to_contain_values",
)</code></pre>
<dl>
<dt><code>tibble</code></dt>
<dd>
Name of the messy tibble
</dd>
<dt><code>column_names</code></dt>
<dd>
list of columns to be restructured into rows
</dd>
<dt><code>names_to</code></dt>
<dd>
name for the new variable that contains names of the original columns
</dd>
<dt><code>value_to</code></dt>
<dd>
name for the new variable that will contain the values.
</dd>
</dl>
</section>
<section id="code-example" class="level2">
<h2 class="anchored" data-anchor-id="code-example">Code example</h2>
<ul>
<li>in <code>download_tib</code>, there are three columns/variables that need to be restructured into rows</li>
<li>specify the variables using <code>day_1:day_3</code></li>
<li>scores in these columns represent hygiene scores, so we could use <code>hygiene</code> as the variable to contain values after restructuring</li>
<li>columns we are transforming represent different days at the festival, so we can use <code>day</code> as the name of the variable created to contain column names</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">download_tidy_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> download_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-2">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> day_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>day_3,</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hygiene"</span>,</span>
<span id="cb9-6">)</span>
<span id="cb9-7">download_tidy_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,430 × 4
   ticket_no gender day   hygiene
   &lt;chr&gt;     &lt;fct&gt;  &lt;chr&gt;   &lt;dbl&gt;
 1 2111      Male   day_1    2.64
 2 2111      Male   day_2    1.35
 3 2111      Male   day_3    1.61
 4 2229      Female day_1    0.97
 5 2229      Female day_2    1.41
 6 2229      Female day_3    0.29
 7 2338      Male   day_1    0.84
 8 2338      Male   day_2   NA   
 9 2338      Male   day_3   NA   
10 2384      Female day_1    3.03
# ℹ 2,420 more rows</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>bias</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_06_bias/</guid>
  <pubDate>Tue, 16 Apr 2024 07:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_06_bias/ellie.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discover_07 - Associations</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_07_associations/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">liar_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/biggest_liar.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 68 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): id, novice
dbl (2): creativity, position

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/exam_anxiety.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 103 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): sex
dbl (4): id, revise, exam_grade, anxiety

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">liar_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">novice =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(novice)</span>
<span id="cb7-4">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">exam_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(id),</span>
<span id="cb8-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(sex)</span>
<span id="cb8-5">  )</span></code></pre></div>
</div>
<ul>
<li>psychologist uses a questionnaire to assess state anxiety related to exams (EAQ)</li>
<li>scale produced a measure of anxiety scored out of 100</li>
<li>anxiety was measured before the exam, and the percentage grade on the exam was recorded</li>
<li>also measured the number of hours spent revising Data are in</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">exam_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 103 × 5
   id    revise exam_grade anxiety sex   
   &lt;fct&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt; 
 1 1          4         40    86.3 Male  
 2 2         11         65    88.7 Female
 3 3         27         80    70.2 Male  
 4 4         53         80    61.3 Male  
 5 5          4         40    89.5 Male  
 6 6         22         70    60.5 Female
 7 7         16         20    81.5 Female
 8 8         21         55    75.8 Female
 9 9         25         50    69.4 Female
10 10        18         40    82.3 Female
# ℹ 93 more rows</code></pre>
</div>
</div>
<ul>
<li>visualise with <code>GGally</code></li>
<li>plot continuous variables, the <code>ggscatmat()</code> function produces a matrix of scatterplots (below the diagonal), distributions (along the diagonal) and the correlation coefficient (above the diagonal)</li>
<li>general form of <code>ggscatmat()</code>
<ul>
<li><code>GGally::ggscatmat(my_tibble, columns = c("variable 1", " variable 2", " variable 3" …))</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(exam_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exam_grade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revise"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"anxiety"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_07_associations/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>resulting plots are all skewed</li>
<li>could be a problem if we want significance tests or confidence intervals</li>
<li>sample contains 103 obs
<ul>
<li>could be large enough for central limit theorem to relieve us of concerns about normality</li>
<li>consider doing a robust method to compute correlation coefficient</li>
</ul></li>
</ul>
<section id="pearsons-correlation-using-r" class="level2">
<h2 class="anchored" data-anchor-id="pearsons-correlation-using-r">Pearson’s correlation using <code>R</code></h2>
<ul>
<li><code>correlation</code> package -&gt; workhorse function called <code>correlation()</code></li>
</ul>
<pre><code>correlation::correlation(tibble,
                         method = "pearson",
                         p_adjust = "holm",
                         ci = 0.95
                         )</code></pre>
<dl>
<dt><code>tibble</code></dt>
<dd>
should be replaced with the name of tibble containing any variables to correlate
</dd>
<dt><code>method</code></dt>
<dd>
method of correlation coefficient, default is <code>pearson</code>, but can also accept <code>spearman, kendall, biserial, polychoric, tetrachoric, and percentage</code>
</dd>
<dt><code>p_adjust</code></dt>
<dd>
corrects the <img src="https://latex.codecogs.com/png.latex?p">-value for the number of tests you have performed using the Holm-Bonferroni method
</dd>
<dd>
applies the Bonferroni criterion in a slightly less strict way that controls the type I error, but with less risk of a type II error
</dd>
<dd>
can change to <code>none</code> (bad idea), <code>bonferroni</code> (to apply the standard Bonferroni method) or several other methods.
</dd>
<dt><code>ci</code></dt>
<dd>
set the confidence interval width; default is 0.95 for general use
</dd>
</dl>
<p>To use the function, - pipe tibble into the <code>select()</code> function from <code>dplyr</code> to select variables to correlate, then pipe that into the correlation function - use the same syntax whether you want to correlate two variables or produce all correlations between pairs of multiple variables]</p>
<p>To calculate Pearson correlation btwn variables <code>exam_grade</code> and <code>revise</code> in <code>exam_tib</code>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">4.343</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.441</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.585</td>
<td style="text-align: right;">-0.271</td>
<td style="text-align: right;">-4.938</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.220</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">4.343</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.441</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.585</td>
<td style="text-align: right;">-0.271</td>
<td style="text-align: right;">-4.938</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">revise</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.709</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.794</td>
<td style="text-align: right;">-0.598</td>
<td style="text-align: right;">-10.111</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for the association between exam grade and revision is 0.22 to 0.55. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of r lies between 0.22 and 0.55.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The p-value for the association between exam grade and revision is &lt; 0.001, what does this value mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The probability of getting a value of t at least as big as the value we have observed, if the value of r were, in fact, zero is less than 0.001. I’m going to assume, therefore, that the association between exam grade and revision is not zero.</p>
</div>
</div>
</div>
<ul>
<li>exam grade correlates with revision - <img src="https://latex.codecogs.com/png.latex?r">=0.4</li>
<li>exam grade had a similar strength relationship with exam anxiety <img src="https://latex.codecogs.com/png.latex?r">=-0.44 but in the opposite direction</li>
<li>revision had a strong negative relationship with anxiety - <img src="https://latex.codecogs.com/png.latex?r">=-0.709</li>
<li>the more you revise, the better your performance</li>
<li>the more anxiety you have, the worse your performance</li>
<li>the mopre you revise, the less anxiety you have</li>
<li>all <img src="https://latex.codecogs.com/png.latex?p">-values are less than 0.001 and would be interpreted as the correlation coefficients being significantly different from zero</li>
<li>significance values tell us that the probability of getting correlation coefficients at least as big as this in a sample of 103 people if the null were true (that there was no relationship between the variables) is very low</li>
<li>if we assume the sample is one of the 95% of samples that will produce a confidence interval containing the population value, then the confidence intervals tell us about the uncertainty around <img src="https://latex.codecogs.com/png.latex?r">.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rounding
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can control the number of decimal places using <code>knitr::kable(digits = 3)</code></p>
<p>We can also specify different columns to contain different rounding using <code>knitr::kable(digits = c(2, 2, 2, 2, 2, 2, 2, 2, 8))</code> (column 9 to 8 decimal places) or <code>knitr::kable(digits = c(rep(2, 8), 8))</code></p>
</div>
</div>
</section>
<section id="robust-correlation-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="robust-correlation-coefficients">Robust correlation coefficients</h2>
<p>Given the skew in the variables, we should use a robust correlation coefficient, like the <code>percentage bend correlation coefficient</code> by setting <code>method = "percentage"</code> within <code>correlation()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">exam_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(exam_grade, revise, anxiety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(</span>
<span id="cb17-4">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percentage"</span></span>
<span id="cb17-5">   ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-6">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">revise</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00049502</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: left;">exam_grade</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-4.41</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00005235</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">revise</td>
<td style="text-align: left;">anxiety</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">-7.66</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: left;">Percentage Bend correlation</td>
<td style="text-align: right;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th>Par1</th>
<th>Par2</th>
<th>Percentage Bend <img src="https://latex.codecogs.com/png.latex?r"></th>
<th>raw Pearson <img src="https://latex.codecogs.com/png.latex?r"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exam_grade</td>
<td>revise</td>
<td>0.34</td>
<td>0.397</td>
</tr>
<tr class="even">
<td>exam_grade</td>
<td>anxiety</td>
<td>-0.40</td>
<td>-0.441</td>
</tr>
<tr class="odd">
<td>revise</td>
<td>anxiety</td>
<td>-0.61</td>
<td>-0.709</td>
</tr>
</tbody>
</table>
<p>All robust correlations (percentage bend) are less than raw, though all are significant at <img src="https://latex.codecogs.com/png.latex?p%3C0.001"></p>
</section>
<section id="spearmans-correlation-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="spearmans-correlation-coefficient">Spearman’s correlation coefficient</h2>
<ul>
<li>data from World’s Best Liar competition</li>
<li>want to know if creativity impacts lying ability</li>
<li>position data (1st, 2nd, etc) is ordinal, so Spearman’s correlation coefficient should be used</li>
<li>Data are in</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">liar_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 4
   id    creativity position novice          
   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;           
 1 lnwe          53        1 First time      
 2 vxob          36        3 Previous entrant
 3 qpli          31        4 First time      
 4 pwsq          43        2 First time      
 5 xafq          30        4 Previous entrant
 6 njra          41        1 First time      
 7 lxty          32        4 First time      
 8 dxcw          54        1 Previous entrant
 9 uxgp          47        2 Previous entrant
10 dvew          50        2 First time      
# ℹ 58 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(liar_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"creativity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"position"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_07_associations/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To get Spearman correlation, we use <code>correlation()</code> the same way as we did with <code>Pearson</code>, except we add <code>method = "spearman"</code> to the function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(creativity, position) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-4">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 22%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">rho</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">S</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">creativity</td>
<td style="text-align: left;">position</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">71948.4</td>
<td style="text-align: right;">0.00172042</td>
<td style="text-align: left;">Spearman correlation</td>
<td style="text-align: right;">68</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Spearman correlation between the two is <img src="https://latex.codecogs.com/png.latex?r_s=-0.37"> with an associated <img src="https://latex.codecogs.com/png.latex?p">-value of 0.002 and a sample size of 68</li>
<li>as creativity increased, position decreased
<ul>
<li>this might seem contrary to the hypothesis, but a position of <code>4</code> is a lower position than <code>1</code></li>
</ul></li>
</ul>
</section>
<section id="kendalls-tau-tau" class="level2">
<h2 class="anchored" data-anchor-id="kendalls-tau-tau">Kendall’s tau (<img src="https://latex.codecogs.com/png.latex?%5Ctau">)</h2>
<ul>
<li>another non-parametric correlation</li>
<li>used instead of Spearman’s correlation when data set is small with a large number of tied ranks</li>
<li><code>correlation()</code> function will calculate Kendall’s <img src="https://latex.codecogs.com/png.latex?%5Ctau"> by including <code>method = "kendall"</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">liar_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(creativity, position) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-3">  correlation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kendall"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-4">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 21%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter1</th>
<th style="text-align: left;">Parameter2</th>
<th style="text-align: right;">tau</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Method</th>
<th style="text-align: right;">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">creativity</td>
<td style="text-align: left;">position</td>
<td style="text-align: right;">-0.3002</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.4396</td>
<td style="text-align: right;">-0.1468</td>
<td style="text-align: right;">-3.2252</td>
<td style="text-align: right;">0.0012588</td>
<td style="text-align: left;">Kendall correlation</td>
<td style="text-align: right;">68</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>output shows <img src="https://latex.codecogs.com/png.latex?%5Ctau=-0.3"> -&gt; closer to 0 than Spearman (-.38) therefore Kendall’s value is likely a more accurate guage of what the correlation in the population would be</li>
</ul>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Cover Photo by <a href="https://unsplash.com/@heebase?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Zhuojun Yu</a> on <a href="https://unsplash.com/photos/a-sandy-beach-covered-in-snow-at-sunset-RsBkqnfmgjA?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>correlation</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_07_associations/</guid>
  <pubDate>Sun, 10 Mar 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_07_associations/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>discover_08 - General Linear Model</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/discovr_08_the_glm/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse, ggplot2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggfortify)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(robust)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: fit.models</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">album_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/album_sales.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 200 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): album_id
dbl (4): adverts, sales, airplay, image

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">soc_anx_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/social_anxiety.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 134 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): spai, iii, obq, tosca

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">metal_tib <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/metal_health.csv"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2506 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (2): hm, suicide

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="fitting-the-linear-model" class="level1">
<h1>Fitting the Linear Model</h1>
<ul>
<li>scatterplots to get an idea of whether assumption of linearity is met, look for outliers or other unusual cases</li>
<li>run an initial regression and save the diagnostics</li>
<li>if we want to generalize or test for significance or confidence intervals…
<ul>
<li>examine residuals for homoscedasticity, independence, normality, and linearity
<ul>
<li>lack of linearity –&gt; fit a non-linear model</li>
<li>assumptions met and no bias –&gt; Model can be generalized</li>
<li>lack of independent errors –&gt; multi-level model</li>
<li>all other situations –&gt; fit a robust version of the model using bootstrapping (small samples) or robust standard errors</li>
</ul></li>
</ul></li>
</ul>
<dl>
<dt>homoscedasticity</dt>
<dd>
<p>assumption of equal or similar variances in different groups being compared</p>
</dd>
<dd>
homogeneity of variance
</dd>
</dl>
<p><strong>Figure 1</strong> <img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/dsr2_fig_08_12_glm_process.png" class="img-fluid" alt="General process of fitting a linear model from discovr_08"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">album_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 5
   album_id adverts sales airplay image
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 aox1foms    10.3   330      43    10
 2 u453js2i   986.    120      28     7
 3 pie89xnr  1446.    360      35     7
 4 u2k5a0df  1188.    270      33     7
 5 t4699ux3   575.    220      44     5
 6 s4h49cu2   569.    170      19     5
 7 1235a8sf   472.     70      20     1
 8 p2v24p5k   537.    210      22     9
 9 4fbjg024   514.    200      21     7
10 e9w6usdb   174.    300      40     7
# ℹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>Use <code>GGally::ggscatmat</code> package to visualize the data</li>
<li>produces
<ul>
<li>a matrix of scatterplots below the diagonal</li>
<li>distributions along the diagonal</li>
<li>the correlation coefficient above the diagonal</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adverts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"airplay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"image"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sales"</span>))  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<ul>
<li>3 predictors have reasonably linear relationships with album sales and no obvious outliers (except bottom left of ‘band image’ scatterplots)</li>
<li>across the diagonal (distributions)
<ul>
<li>advertising is very skewed</li>
<li>airplay and sales look heavy-tailed</li>
</ul></li>
<li>correlations in the plot give us an idea of the relationships between predictors and outcome</li>
<li>if we ignore album sales, the highest correlation is between image ratings and amount of airplay, which is significant and the 0.01 level (<img src="https://latex.codecogs.com/png.latex?r=0.18">)</li>
<li>focussing on the outcome variable, adverts and airplay correlate best with the outcome (<img src="https://latex.codecogs.com/png.latex?r=0.58"> and <img src="https://latex.codecogs.com/png.latex?r=0.6">)</li>
</ul>
</section>
<section id="one-predictor" class="level2">
<h2 class="anchored" data-anchor-id="one-predictor">One predictor</h2>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<ul>
<li>predicting sales from advertising alone</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_i%7D+%5Cepsilon_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=b_0+%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D+%5Cepsilon_i"></p>
<ul>
<li>it is clear from the bottom left scatterplot and the correlation (<img src="https://latex.codecogs.com/png.latex?r=0.58">) that a positive relation exists. More advertising money spent leads to greater album sales.</li>
<li>some albums sell well regardless of advertising (top-left of scatterplot)</li>
<li>no albums sell badly when adverts are high (bottom-right of scatterplot)</li>
<li>to fit a linear model, we use <code>lm()</code> function <code>my_model &lt;- lm(outcome ~ predictor(s), data = tibble, na.action = an action)</code>
<ul>
<li><code>my_model</code> is the name of the model</li>
<li><code>outcome</code> is the name of the outcome variable (sales)</li>
<li><code>predictor</code> is the name of the predictor variable (adverts) or, a list of variables separated by <code>+</code> symbols</li>
<li><code>tibble</code> is the name of the tibble containing the data (album_tib)</li>
</ul></li>
<li>this function maps directly to the equation for the model
<ul>
<li><code>adverts ~ sales</code> maps to <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=b_0+%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D+%5Cepsilon_i"> except we ignore the error term and parameter estimates and we replace the <code>=</code> with <code>~</code> (which means ‘predicted from’)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">album_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts, data = album_tib, na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-152.949  -43.796   -0.393   37.040  211.866 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.341e+02  7.537e+00  17.799   &lt;2e-16 ***
adverts     9.612e-02  9.632e-03   9.979   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 65.99 on 198 degrees of freedom
Multiple R-squared:  0.3346,    Adjusted R-squared:  0.3313 
F-statistic: 99.59 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(album_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">65.991</td>
<td style="text-align: right;">99.587</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1120.688</td>
<td style="text-align: right;">2247.375</td>
<td style="text-align: right;">2257.27</td>
<td style="text-align: right;">862264.2</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>note <img src="https://latex.codecogs.com/png.latex?df=1"> and <img src="https://latex.codecogs.com/png.latex?df.residual=198"> therefore we can say that adding the predictor of advertising significantly improved the fit of the model to the data compared to having no predictors in the model</li>
<li><img src="https://latex.codecogs.com/png.latex?F(1,198)=99.59,%20p%3C.001"></li>
</ul>
</section>
<section id="model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="model-parameters">Model Parameters</h3>
<p>To see model parameters, use <code>broom::tidy()</code></p>
<p><code>broom::tidy(model_name, conf.int = FALSE, conf.level = 0.95)</code></p>
<ul>
<li>put the model name into the function, then two optional arguments
<ul>
<li>confidence intervals <code>conf.int=TRUE</code> (confidence intervals are not included by default)</li>
<li>default is 95%, but you can change it with <code>conf.level=.99</code> for 99% confidence interval</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(album_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 134.       7.54        17.8  5.97e-43 119.       149.   
2 adverts       0.0961   0.00963      9.98 2.94e-19   0.0771     0.115</code></pre>
</div>
</div>
<ul>
<li>output provides estimates of the model parameters (<img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">-values)</li>
<li><img src="https://latex.codecogs.com/png.latex?Y"> intercept (<img src="https://latex.codecogs.com/png.latex?b_0">) is 134.14 (when <img src="https://latex.codecogs.com/png.latex?X"> is 0, sales will be 134140)</li>
<li><img src="https://latex.codecogs.com/png.latex?X"> (<img src="https://latex.codecogs.com/png.latex?b_1">) is 0.096.
<ul>
<li>represents the change in outcome associated with a unit change in predictor.</li>
<li>when the predictor increases by 1, the outcome increases by .096, but since the units of measurement was thousands of pounds and thousands of sales, an increase in $1000 will lead to 96 more albums sold</li>
<li>not very good return</li>
<li>BUT, we know that advertising only accounts for 1/3 of the variance</li>
</ul></li>
<li>If a predictor is having a significant impact on our ability to predict the outcome, then <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> should be different from 0 and large relative to its standard error</li>
<li>the <img src="https://latex.codecogs.com/png.latex?t">-test (labelled statistic) and the associated <img src="https://latex.codecogs.com/png.latex?p">-value tell us whether the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> is significantly different from 0</li>
<li>the column p.value contains the exact probability that a value of <img src="https://latex.codecogs.com/png.latex?t"> at least as big as the one in the table would occur if the value of <img src="https://latex.codecogs.com/png.latex?b"> in the population were 0</li>
<li>if this propbability is less than 0.05, then we interpret that as the predictor being a significant predictor of hte outcome.</li>
<li>for both <img src="https://latex.codecogs.com/png.latex?t">s, the probabilities are in scientific notation
<ul>
<li><code>2.91e-19</code> means <img src="https://latex.codecogs.com/png.latex?2.91*10%5E%7B-19%7D">, or <code>move the decimal 19 places to the left</code> or <code>0.000000000000000000291</code></li>
<li><code>2.91e+19</code> means <img src="https://latex.codecogs.com/png.latex?2.91*10%5E%7B19%7D">, or <code>move the decimal 19 places to the right</code> or <code>29100000000000000000</code><br>
</li>
</ul></li>
<li>both values are 0 at 3 decimal places</li>
</ul>
</section>
<section id="exploring-the-standard-error-of-hatb" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-standard-error-of-hatb">Exploring the standard error of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></h3>
<p>https://www.youtube-nocookie.com/embed/3L9ZMdzJyyI?si=ET90VDYq3RVKnKDq</p>
</section>
<section id="confidence-intervals-for-hatb" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-for-hatb">Confidence intervals for <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></h3>
<p>Imagine we collect 100 samples of data measuring the same variables as the current model, then estimate the same model, including confidence intervals for unstandardized values.The boundaries are constructed such that 95% of our 100 samples contain the population value of <img src="https://latex.codecogs.com/png.latex?b">. 95 of 100 sample will yield confidence intervals for <img src="https://latex.codecogs.com/png.latex?b"> that contain the population value, but we don’t know if our sample is one of the 95.</p>
<p>We might just assume that it does, but if the confidence interval contains 0, then there is a possibility that there is no relationship, or the relationship might be negative. The trouble is that we would be wrong 5% of the time.</p>
<p>If the interval does not contain 0, we might conclude there is a genuine positive relationship.</p>
</section>
<section id="using-the-model" class="level3">
<h3 class="anchored" data-anchor-id="using-the-model">Using the model</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=%5Chat%7Bb_0%7D+%5Chat%7Bb_1%7D%7B%5Ctext%7BAdvertising%7D_i%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=134.14+.096*%7BAdvertising%7D_i"></p>
<p>Now we can make a prediction by entering a value for the advertising budget, say 100 (equal to 100,000 gbp)</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=134.14+.096*%7B100%7D_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BSales%7D_i=143.74"></p>
<p>or 143,740 sales</p>
</section>
</section>
<section id="several-predictors" class="level2">
<h2 class="anchored" data-anchor-id="several-predictors">Several Predictors</h2>
<p>add multiple predictors hierarchically, after advertising is shown to be significant</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_1i%7D+%7Bb_2%7D%7BX_2i%7D+%7Bb_3%7D%7BX_3i%7D+%20...%20+%7Bb_n%7D%7BX_ni%7D%5Cepsilon_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7Badvertising_i%7D+%7Bb_2%7D%7Bairplay_i%7D+%7Bb_3%7D%7Bimage_i%7D+%5Cepsilon_i"></p>
<section id="building-the-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-model">Building the model</h3>
<ul>
<li>add predictors to the R code the same way as we do in the equation, by adding <code>+</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">album_full_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-121.324  -28.336   -0.451   28.967  144.132 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -26.612958  17.350001  -1.534    0.127    
adverts       0.084885   0.006923  12.261  &lt; 2e-16 ***
airplay       3.367425   0.277771  12.123  &lt; 2e-16 ***
image        11.086335   2.437849   4.548 9.49e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 47.09 on 196 degrees of freedom
Multiple R-squared:  0.6647,    Adjusted R-squared:  0.6595 
F-statistic: 129.5 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(album_full_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb22-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">47.087</td>
<td style="text-align: right;">129.498</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1052.168</td>
<td style="text-align: right;">2114.337</td>
<td style="text-align: right;">2130.828</td>
<td style="text-align: right;">434574.6</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><code>r.squared</code> <img src="https://latex.codecogs.com/png.latex?R%5E2"> tells us the variance in album sales -&gt; .665, or 66.5%.</li>
<li><img src="https://latex.codecogs.com/png.latex?R%5E2"> for adverts was 0.335, so the difference -&gt; .665-.335=.33 means that airplay and image account for a further 33% of the variance</li>
<li>adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> <code>adj.r.squared</code> tells us how well the model generalizes, and the value should be close to r.squared.
<ul>
<li>in this case it is .66, or only .005 away</li>
</ul></li>
<li><img src="https://latex.codecogs.com/png.latex?F">-statistic is the ratio of the improvementin prediction that results from fitting the model, relative to the inaccuracy that sitll exists in the model</li>
<li>the variable <code>p.value</code> contains the p-value associated with <img src="https://latex.codecogs.com/png.latex?F"> -&gt; in this case is <img src="https://latex.codecogs.com/png.latex?2.88%C3%9710%5E%7B%E2%88%9246%7D"> -&gt; much smaller than .001</li>
<li>degrees of freedom are <code>df</code> and <code>df.residual</code></li>
<li>we can interpret the result as meaning that the model significantly improves our ability to predict the outcome variable ocmpared to not fitting the model.</li>
<li>reported as <img src="https://latex.codecogs.com/png.latex?F(3,%20196)=129.5,%20p=%3C0.001"></li>
</ul>
</section>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing Models</h2>
<ul>
<li>we can compare hierarchical models using an <img src="https://latex.codecogs.com/png.latex?F">-statisticusing the <code>anova()</code> function -&gt; <code>anova(model_1, model_2, … , model_n)</code></li>
<li>list the models in order that we want to compare</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(album_lm, album_full_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb23-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term                      df.residual    rss    df   sumsq statistic   p.value
  &lt;chr&gt;                           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 sales ~ adverts                   198 8.62e5    NA     NA       NA   NA       
2 sales ~ adverts + airpla…         196 4.35e5     2 427690.      96.4  6.88e-30</code></pre>
</div>
</div>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?F"> (<code>statistic</code>) is 96.5</li>
<li><img src="https://latex.codecogs.com/png.latex?p">-value (<code>p.value</code>) is <img src="https://latex.codecogs.com/png.latex?6.8793949%5E%7B-30%7D"></li>
<li><code>df</code> is 2 (difference between df in 2 models)</li>
<li><code>df.residual</code> is 196</li>
<li>Conclusion -&gt; adding airplay and image to the model significantly improved model fit
<ul>
<li><img src="https://latex.codecogs.com/png.latex?F(2,%20196)%20=%2096.45,%20p%20%3C%200.001"></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can only compare hierarchical models; that is to say that the second model must contain everything that was in the first model plus something new, and the third model must contain everything in the second model plus something new, and so on.</p>
</div>
</div>
<section id="model-parameter-estimates-hatb" class="level3">
<h3 class="anchored" data-anchor-id="model-parameter-estimates-hatb">Model parameter estimates (<img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">17.350</td>
<td style="text-align: right;">-1.534</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">-60.830</td>
<td style="text-align: right;">7.604</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.820</td>
<td style="text-align: right;">3.915</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.438</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">6.279</td>
<td style="text-align: right;">15.894</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>output gives estimates of the <img src="https://latex.codecogs.com/png.latex?b">-balues (column labelled <code>estimate</code>) and statistics that indicate the individual contribution of each predictor in the model.</li>
<li>all three predictors have positive <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">values, indicating positive relationships
<ul>
<li>as all three predictors increase, so do album sales</li>
</ul></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> vlaues also tell us to what degree each predictor affects the outcome if the effects of all other predictors are held constant
<ul>
<li>advertising budget -&gt; <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=0.085"> -&gt; as advertising increases by 1 unit (1000gbp), sales increases by 0.085 units (85 albums), but this is only true if the other two predictors are held constant</li>
<li>airplay <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=3.367"> -&gt; as airplay prior to release increases by one unit (1 play), album sales increase by 3.367 units (3367 album sales, but only if the other two predictors are held constant)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the 𝑏̂ (11.086) for band image?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If a band can increase their image rating by 1 unit they can expect additional album sales of 11,086 units</p>
</div>
</div>
</div>
</section>
<section id="standardized-hatbs" class="level3">
<h3 class="anchored" data-anchor-id="standardized-hatbs">Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">s</h3>
<p>The <code>lm()</code> function does not provide standardized betas, so use <code>model_parameters()</code></p>
<p><code>parameters::model_parameters(my_model, standardize = refit)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"refit"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb26-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.081</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.593</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>advertising budget -&gt; Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D=0.511">
<ul>
<li>as the advertising budgetr increases by one standard deviation (485,655gbp), album sales increase by .511 standard deviations.</li>
<li>the standard deviation for album sales is 80,699, so .511 SD is 41,240 sales</li>
<li>for every increase in advert budget of 485655gbp, album sales will increase by 41,240 IF the other predictors are held constant</li>
</ul></li>
<li>Image -&gt; Standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D=0.192">
<ul>
<li>a band rated 1 SD on the image scale (1.4 units) will sell .192 SD more units.</li>
<li>this is a change of 15,490 sales IF the other predictors are held constant</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the Standardized B (0.512) for airplay?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As the number of plays on radio in the week before release increases by 1 standard deviation, album sales increase by 0.512 standard deviations</p>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for airplay ranges from 2.82 to 3.92. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of this confidence interval containing the population value is 0.95.</del></li>
<li>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 2.82 and 3.92.</li>
<li><del>I can be 95% confident that the population value of b lies between 2.82 and 3.92</del></li>
<li><del>There is a 95% chance that the population value of b lies between 2.82 and 3.92</del></li>
</ul>
</div>
</div>
</div>
<p>Assuming that each confidence interval is one of the 95% that contains the population parameter: - the true size of the relationship between advertising budget and album sales lies somewhere between 0.071 and 0.099 - the true size of the relationship between band image and album sales lies somewhere between 6.279 and 15.894</p>
<ul>
<li>the two best predictors have tight confidence intervals (airplay and adverts) indicating that the estimates are likely representative of the true population values</li>
<li>the interval for band image is much wider, but does not cross zero indicating this parameter is less representative of the population, but is still significant.</li>
</ul>
</section>
<section id="significance-tests" class="level3">
<h3 class="anchored" data-anchor-id="significance-tests">Significance tests</h3>
<p>The values in <code>statistic</code> are the values of <img src="https://latex.codecogs.com/png.latex?t"> associated with each <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> and <code>p.value</code> is the associated significance of the <img src="https://latex.codecogs.com/png.latex?t">-statistic. For every predictor, the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> is significantly different from 0 (<img src="https://latex.codecogs.com/png.latex?p%3C.001">) meaning that all predictors significantly predict album sales.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How might we interpret the statistic and p.value for the three predictors?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of the null hypothesis is less than 0.001 in all cases</del></li>
<li><del>The probability that each b is a chance result is less than 0.001</del></li>
<li>They tell us that the probability of getting a value of t at least as big as these values if the value of b were, in fact, zero is smaller than 0.001 for all predictors.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<img src="https://latex.codecogs.com/png.latex?p">-values
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many students and researchers think of <em>p</em>-values in terms of the ‘probability of a chance result’ or ‘the probability of a hypothesis being true’ but they are neither of these things. <u><strong>They are the long-run probability that you would get a test-statistic (in this case <em>t</em>) at least as large as the one you have if the null hypothesis were true.</strong></u> In other words, if there really were no relationship between advertising budget and album sales (the null hypothesis) then the population value of <em>b</em> would be zero.</p>
<p>Imagine we sampled from this null population and computed <em>t</em>, and then repeated this process 1000 times. We’d have 1000 values of <em>t</em> from a population in which there was no effect. We could plot these values as a histogram. This would tell us how often certain values of <em>t</em> occur. From it we could work out the probability of getting a particular value of <em>t</em>. If we then took another sample, and computed <em>t</em> (because we’re kind of obsessed with this sort of thing) we would be able to compare this value of <em>t</em> to the distribution of all the previous 1000 samples. Is the <em>t</em> in our current sample large of small compared to the others? Let’s say it was larger than 999 of the previous values. That would be quite an unlikely value of <em>t</em> whereas if it was larger than 500 of them this would not surprise us. <u><strong>This is what a <em>p</em>-value is: it is the long run probability of getting test statistic at least as large as the one you have if the null hypothesis were true.</strong></u> If the value is less than 0.05, people typically take this as supporting the idea that the null hypothesis isn’t true.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Report
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>the model that included the band’s image and airplay was significantly better fit than the model that included advertising budget alone <img src="https://latex.codecogs.com/png.latex?f(2,%20196)=96.45,%20p%3C0.001"></li>
<li>the final model explained 66.5% of the variance in album sales</li>
<li>advertising budget significantly predicted album sales <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=0.08%5B0.07,%200.10%5D,%20t(196)=12.26,%20p%3E.001"></li>
<li>airplay significantly predicted album sales <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=3.37%5B2.82,%203.92%5D,%20t(196)=12.12,%20p%3C.001"></li>
<li>band image significantly predicted album sales -&gt; <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D=11.09%5B6.28,%2015.89%5D,%20t=4.55,%20p%3C.001"></li>
</ul>
</div>
</div>
</section>
</section>
<section id="unguided-example" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example">Unguided Example</h2>
<section id="metal-and-mental-health" class="level3">
<h3 class="anchored" data-anchor-id="metal-and-mental-health">Metal and mental health</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">metal_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,506 × 2
      hm suicide
   &lt;dbl&gt;   &lt;dbl&gt;
 1    10       7
 2    10      11
 3    10       8
 4     4      14
 5    10      13
 6     8      12
 7     8       7
 8     5      15
 9     8       7
10     9      10
# ℹ 2,496 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(metal_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suicide"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 200 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 284 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">metal_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(suicide <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> metal_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb32-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(metal_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb32-3">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">4.842</td>
<td style="text-align: right;">304.784</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6401.851</td>
<td style="text-align: right;">12809.7</td>
<td style="text-align: right;">12826.7</td>
<td style="text-align: right;">50047.05</td>
<td style="text-align: right;">2135</td>
<td style="text-align: right;">2137</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(metal_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   16.0      0.261       61.4 0          15.5      16.5  
2 hm            -0.612    0.0350     -17.5 6.64e-64   -0.680    -0.543</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance does the final model explain?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>12.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the nature of the relationship between listening to heavy metal and suicide risk?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>As love of heavy metal increases, suicide risk decreases</li>
<li>because the <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> value is negative (-.0612)</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As listening to heavy metal increases by 1 unit, by how much does suicide risk change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>-0.612 units</li>
</ul>
</div>
</div>
</div>
</section>
<section id="predicting-social-anxiety" class="level3">
<h3 class="anchored" data-anchor-id="predicting-social-anxiety">Predicting Social Anxiety</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">soc_anx_tib</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 4
    spai   iii   obq tosca
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    26 56.5   4.43  4.18
 2    51 16.1   2.03  4.20
 3    33 37.4   2.59  3.25
 4   106 16.7   4.84  4.07
 5    25  5.16  1.76  3.80
 6   109 36.0   2.13  4.25
 7    39 34.5   2.01  4.95
 8   134 18.0   1.76  4.52
 9    43 12.9   2.29  3.59
10    57  7.10  3.20  3.64
# ℹ 124 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">GGally<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggscatmat</span>(soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spai"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tosca"</span>))  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">soc_anx_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb38-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(soc_anx_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-3">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">29.918</td>
<td style="text-align: right;">14.989</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-644.525</td>
<td style="text-align: right;">1295.05</td>
<td style="text-align: right;">1303.743</td>
<td style="text-align: right;">118153.3</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">134</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(soc_anx_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    -54.8     30.0      -1.82 0.0703     -114.       4.60
2 tosca           27.4      7.08      3.87 0.000169     13.4     41.4 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">soc_anx_obq_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> obq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb41-2">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(soc_anx_obq_lm)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb41-3">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">29.015</td>
<td style="text-align: right;">11.218</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-630.333</td>
<td style="text-align: right;">1268.666</td>
<td style="text-align: right;">1280.197</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">132</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term        estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -53.3      29.2      -1.82 0.0704   -111.        4.50
2 tosca          22.1       7.24      3.05 0.00276     7.77     36.4 
3 obq             7.25      2.91      2.49 0.0141      1.49     13.0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"refit"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.160</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tosca</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">3.052</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">obq</td>
<td style="text-align: right;">0.213</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">2.489</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>anova(soc_anx_lm, soc_anx_obq_lm) |&gt;
broom::tidy()</code></pre>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error message
</div>
</div>
<div class="callout-body-container callout-body">
<p>Error in anova.lmlist(object, …) : models were not all fitted to the same size of dataset</p>
<ul>
<li><p>as of this writing (Mar-04-24), there is a solution listed in the <code>discovr_08</code> tutorial to start by finding the error with <code>soc_anx_tib |&gt; dplyr::summarise( across(.fns = list(valid = ~sum(!is.na(.x)), missing = ~sum(is.na(.x))), .names = "{.col}_{.fn}") )</code></p>
<ul>
<li>The output from running this function in the tutorial is a table showing that there are missing values in <code>obq</code>. this means that <code>spai</code> and <code>tosca</code> have 134 values and <code>obq</code> has 132 values, so they are not the same size.</li>
</ul></li>
<li><p>However, the output above in my own .qmd file throws a <code>deprecated</code> error in <code>dplyr 1.1.4</code> that the use of <code>across</code> without <code>.cols</code> is deprecated since <code>dplyr 1.1.1</code></p></li>
<li><p>this means that I can’t currently generate the table showing the sizes of the datasets with the code provided</p></li>
<li><p>the workaround to the problem is normally to use <code>multiple imputation</code> to estimate the missing values, which is beyond the scope of this tutorial, so Field recommends a <code>very bad practice</code>, which is to omit the missing values.</p></li>
<li><p>I’ve <a href="https://github.com/profandyfield/discovr/issues/17">filed an issue in the <code>discover.rocks</code> repo</a></p></li>
<li><p><a href="https://github.com/profandyfield/discovr/issues/17#issuecomment-1976799279">Fix’t</a></p></li>
</ul>
</div>
</div>
<p>Here is the fixed code, adding <code>.cols = everything()</code>, and the intended output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">soc_anx_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb46-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb46-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valid =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.x)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.x))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{.col}_{.fn}"</span>)</span>
<span id="cb46-4">    )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  spai_valid spai_missing iii_valid iii_missing obq_valid obq_missing
       &lt;int&gt;        &lt;int&gt;     &lt;int&gt;       &lt;int&gt;     &lt;int&gt;       &lt;int&gt;
1        134            0       129           5       132           2
# ℹ 2 more variables: tosca_valid &lt;int&gt;, tosca_missing &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">soc_anx_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> soc_anx_tib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb48-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>iii) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(spai <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tosca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> _)</span>
<span id="cb48-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(soc_anx_lm, soc_anx_obq_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-6">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-7">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">spai ~ tosca</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">113813.1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">spai ~ tosca + obq</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5213.423</td>
<td style="text-align: right;">6.193</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance in social anxiety do OCD and shame account for?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>14.8%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for shame ranges from 7.77 to 36.42. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 7.77 and 36.42.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As shame increases by 1 unit, by how much does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>22.10 units</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As OCD increases by 1 standard deviation, by how many standard deviations does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>0.213</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The p-value for OCD is 0.014, what does this mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The probability of getting a value of t at least as big as 2.49 if the value of b were, in fact, zero is 0.014. I’m going to assume, therefore, that b isn’t zero (i.e.&nbsp;OCD significantly predicts social anxiety.)</p>
</div>
</div>
</div>
</section>
</section>
<section id="the-beast-of-bias" class="level2">
<h2 class="anchored" data-anchor-id="the-beast-of-bias">The Beast of Bias</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the most important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Linearity and additivity</p>
<p>This assumption is the most important because if it is not met then the phenomenon you’re trying to model is not well represented by the model you are trying to fit</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the least important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Normality of errors</p>
<p>This assumption is the least important because even with non-normal errors the parameter estimates (using ordinary least squares methods) of the model will be unbiased (they match the expected population value) and optimal (they minimize the squared error).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What does homoscedasticity mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The variance in errors from the (population) model is constant at all levels of the predictor variable(s)</p>
</div>
</div>
</div>
<section id="diagnostic-plots" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h3>
<p>Use <code>plot()</code> function</p>
<p><code>plot(my_model, which = numbers_of_the_plots_you_want)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>plot()</code> function can produce 6 plots (below) - default is to produce 1,2,3,5.</p>
<ol type="1">
<li>predicted values from the model (x-axis) against the residuals (y-axis). Use to look for linearity and homoscedasticity.</li>
<li>A Q-Q plot of standardised residuals to look for normality of residuals</li>
<li>predicted values from the model(x-axis) against the square root of the standardized residuals (y-axis). This is a variant of plot 1 and is used to look for linearity and homoscedasticity.</li>
<li>Case number (x-axis) against the Cooks distance (y-axis). This plot can help identify influential cases (large values of Cooks distance).</li>
<li>The leverage value for each case (x-axis) against the standardised residual (y-axis). Used to identify influential cases and outliers. Leverage values indicate the influence of an individual case on the model and are related to the Cooks distance.</li>
<li>The leverage value for each case (x-axis) against the corresponing Cooks distance (y-axis). Used to identify influential cases and outliers.</li>
</ol>
<p>To get plot #1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To get plot #1 and #2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To get all six, use <code>which = 1:6</code></p>
</div>
</div>
<p>Plots below show the patterns of dots we want (random = assumptions met)</p>
<ul>
<li>curvature indicates lack of linearity</li>
<li>funnel shape indicates heteroscedasticity</li>
<li>curvature and funnel shape indicate non-linearity and heteroscedasticity</li>
<li></li>
</ul>
<p><strong>Figure 2</strong> <img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/dsr2_fig_06_29_pred_resid.png" class="img-fluid" alt="Examples of residual plots from Field (2023)"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If both assumptions of linearity and homoscedasticity are met, then these plots should look like a random array of dots and the red trend line should be flat.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparing the plot to those in Figure 2, how would you interpret it?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No problems. random array of dots, no funnels, no bananas.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Based on the Q-Q plot, can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes, the dots line up along the diagonal, indicating a normal distribution.</p>
</div>
</div>
</div>
</section>
<section id="pretty-residual-plots" class="level3">
<h3 class="anchored" data-anchor-id="pretty-residual-plots">Pretty residual plots</h3>
<p>with <code>ggfortify</code>, we can use <code>ggplot2::autoplot()</code> to produce nicely formatted plots that are <code>ggplot2</code> objects, including themes</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using <code>GGfortify</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>for <code>autoplot()</code> function to work, the <code>ggfortify</code> package must be loaded. We can’t use verbose code because <code>ggfortify</code> adds functionality to <code>ggplot2</code> rather than to itself. Need to include <code>library(ggfortify)</code> at the beginning of the document.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(album_full_lm,</span>
<span id="cb54-2">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb54-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>,</span>
<span id="cb54-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#5ec962"</span>,</span>
<span id="cb54-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb54-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb54-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="influential-cases-and-outliers-plots" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-plots">Influential cases and outliers: plots</h2>
<ul>
<li>use Cook’s distance to identify influential cases and</li>
<li>use standardized residuals to check for outliers</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>in an average sample,
<ul>
<li>95% of standardized residuals should lie between <img src="https://latex.codecogs.com/png.latex?%5Cpm1.96"> and</li>
<li>99% should lie between <img src="https://latex.codecogs.com/png.latex?%5Cpm2.58">, and</li>
<li>any case for which absolute value of the standardized residual is 3 or more, is likely to be an outlier</li>
</ul></li>
<li>Cook’s distance measure the influence of a single case on model as a whole.
<ul>
<li>absolute values greater than 1 may be cause for concern</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(album_full_lm,</span>
<span id="cb55-2">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb55-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#440154"</span>,</span>
<span id="cb55-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#5ec962"</span>,</span>
<span id="cb55-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb55-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb55-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>First plot show Cook’s distance and labels cases with largest values (1, 164, 169), but largest values are in the region of 0.06, well below the threshold of 1.</li>
<li>second shows leverage values plotted against standardized residuals
<ul>
<li>we want the green trend line to be flat and lie along zero, which is the case here</li>
<li>if the trend line deviates substantially from horizontal, then it indicates one of the assumptions of the model has been violated</li>
<li>this plot usually also has red dashed lines indicating values of Cook’s distance of 0.5 and 1. this plot has none, indicating all values of Cook’s distance are well below thresholds.</li>
</ul></li>
<li>Final plot shows leverage, Cook’s distance, and the standardized residual on the same plot.
<ul>
<li>can be used to identify cases that have high leverage, high Cook’s distance, large residual, or some combination of all three.</li>
<li>e.g.&nbsp;across the plots, case 164 has a standardized residual between -2.5 and -3 and the largest Cook’s distance (although still only around 0.7)</li>
</ul></li>
</ul>
</section>
<section id="influential-cases-and-outliers-numbers" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-numbers">Influential cases and outliers: numbers</h2>
<p>For a more precise look, we can see values for Cook’s distance and standardized residuals using <code>broom::augment()</code>. All we need to do is pass the lm object into the function and save the results as a new tibble. also useful to save the case number as a variable so that you can identify cases should you need to.</p>
<ul>
<li>create a new tibble called <code>album_full_rsd</code> (rsd for <code>residuals</code>) by
<ul>
<li>piping model into <code>broom::augment()</code> to get residuals, then</li>
<li>into <code>tibble::row_id_to_column()</code> to create a variable that contains the row number</li>
</ul></li>
<li>the <code>var = "case_no"</code> tells the function to name the variable containing the numbers <code>case_no</code></li>
<li>the result is a tibble called <code>album_full_rsd</code> that contains the case number, the original data to which the model was fitted, and various diagnostic statistics.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
De-bug: residuals when you have missing values
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have missing values in the data and used <code>na.action = na.exclude</code> when fitting the model, you must also tell <code>augment()</code> where to find the original data so it can map the residuals to the original cases.</p>
<p>In this case: <code>album_full_rsd &lt;- album_full_lm |&gt;    broom::augment(data = album_tib)</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">album_full_rsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> album_full_lm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-2">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-3">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_no"</span>) </span>
<span id="cb56-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(album_full_rsd) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb56-5">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb56-6">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ sales      &lt;dbl&gt; 330, 120, 360, 270, 220, 170
$ adverts    &lt;dbl&gt; 10.256, 985.685, 1445.563, 1188.193, 574.513, 568.954
$ airplay    &lt;dbl&gt; 43, 28, 35, 33, 44, 19
$ image      &lt;dbl&gt; 10, 7, 7, 7, 5, 5
$ .fitted    &lt;dbl&gt; 229.9203, 228.9490, 291.5576, 262.9760, 225.7529, 141.0954
$ .resid     &lt;dbl&gt; 100.079745, -108.948992, 68.442368, 7.024026, -5.752861, 28…
$ .hat       &lt;dbl&gt; 0.047190526, 0.008006536, 0.020700427, 0.012560946, 0.02606…
$ .sigma     &lt;dbl&gt; 46.63346, 46.55347, 46.94739, 47.20520, 47.20607, 47.16186
$ .cooksd    &lt;dbl&gt; 5.870388e-02, 1.088943e-02, 1.140066e-02, 7.166478e-05, 1.0…
$ .std.resid &lt;dbl&gt; 2.1774041, -2.3230828, 1.4688016, 0.1501160, -0.1237983, 0.…</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">sales</th>
<th style="text-align: right;">adverts</th>
<th style="text-align: right;">airplay</th>
<th style="text-align: right;">image</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">10.26</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">229.92</td>
<td style="text-align: right;">100.08</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">46.63</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">2.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">985.68</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">228.95</td>
<td style="text-align: right;">-108.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">46.55</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">1445.56</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">291.56</td>
<td style="text-align: right;">68.44</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">46.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">1188.19</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">262.98</td>
<td style="text-align: right;">7.02</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">574.51</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">225.75</td>
<td style="text-align: right;">-5.75</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">568.95</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">141.10</td>
<td style="text-align: right;">28.90</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.16</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.62</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Standardized residuals are in a variable called <code>.std.resid</code> and the Cook’s distances in <code>.cooksd</code></p>
<p>to see what percentage of standardized residuals fall outside the limits of 1.96 (95%), 2-2.5 (99%) or above 3, we can filter the tibble using the <code>abs()</code> function to return the absolute value (ignoring the plus/minus signs) of the residual</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb58-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   case_no .std.resid .resid
     &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
 1     164      -2.63 -121. 
 2      47      -2.46 -115. 
 3      55      -2.46 -114. 
 4      68      -2.36 -110. 
 5       2      -2.32 -109. 
 6     200      -2.09  -97.2
 7     167      -2.00  -93.6
 8     100       2.10   97.3
 9      52       2.10   97.4
10      61       2.10   98.8
11      10       2.13   99.5
12       1       2.18  100. 
13     169       3.09  144. </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb60-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     164      -2.63  -121.
2     169       3.09   144.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb62-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     169       3.09   144.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>13/200 = 6.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>2/200 = 1%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No, the appropriate proportion of cases have standardized residuals in the expected range and no case has a value grossly exceeding 3.</p>
</div>
</div>
</div>
<ul>
<li>Something similar with Cook’s distance…we can filter the tibble to look at cases with cooksd&gt;1, or sort the tibble in descending order using <code>arrange()</code></li>
<li>also use <code>select()</code> so we only see Cook’s value and case numbers</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">album_full_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb64-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(.cooksd)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb64-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .cooksd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1     164  0.0708
 2       1  0.0587
 3     169  0.0509
 4      55  0.0404
 5      52  0.0332
 6     100  0.0314
 7     119  0.0308
 8      99  0.0281
 9     200  0.0251
10      47  0.0241
# ℹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>no cooksd&gt;1 so no cases having undue influence on the model as a whole</li>
</ul>
</section>
<section id="robust-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="robust-linear-models">Robust linear models</h2>
<ul>
<li>model appears to be accurate for the sample and generalizable to the population</li>
<li>not always the case though</li>
<li>2 things to do
<ul>
<li>test whether the parameter estimates have been biased</li>
<li>check whether confidence intervals and significance tests have been biased</li>
</ul></li>
</ul>
<section id="robust-parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="robust-parameter-estimates">Robust parameter estimates</h3>
<ul>
<li>use <code>robust::lmRob()</code></li>
<li>used the same way as <code>lm()</code></li>
<li>replace <code>lm()</code> with <code>lmRob()</code></li>
<li>can’t use any <code>broom</code> functions with <code>lmRob()</code>, so text output using <code>summary()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">album_full_rob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmRob</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.exclude)</span>
<span id="cb66-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_rob)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmRob(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-124.62  -30.47   -1.76   28.89  141.35 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -31.523201  21.098348  -1.494 0.136756    
adverts       0.085295   0.008501  10.033  &lt; 2e-16 ***
airplay       3.418749   0.339017  10.084  &lt; 2e-16 ***
image        11.771441   2.973559   3.959 0.000105 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44.61 on 196 degrees of freedom
Multiple R-Squared: 0.5785 

Test for Bias:
            statistic p-value
M-estimate      2.299  0.6809
LS-estimate     7.659  0.1049</code></pre>
</div>
</div>
<ul>
<li>bottom of output givessignificance tests of bias</li>
<li>significance tests need to be interpreted within the context of sample size, but these tests suggest that bias in the original model is not problematic
<ul>
<li><img src="https://latex.codecogs.com/png.latex?p">-value is not significant</li>
</ul></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Original <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
<th>Robust <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adverts</td>
<td>0.085</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>Airplay</td>
<td>3.37</td>
<td>3.42</td>
</tr>
<tr class="odd">
<td>Image</td>
<td>11.09</td>
<td>11.77</td>
</tr>
</tbody>
</table>
<ul>
<li>estimates are virtually identical to the originals, suggesting the original model is unbiased</li>
</ul>
</section>
</section>
<section id="robust-confidence-intervals-and-significance-tests" class="level2">
<h2 class="anchored" data-anchor-id="robust-confidence-intervals-and-significance-tests">Robust Confidence Intervals and significance tests</h2>
<ul>
<li><p>to test whether confidence intervals and significance tests are biased, we can estimate the model with standard errors designed for heteroscedastic residuals</p></li>
<li><p>if the sample is small, use a bootstrap</p></li>
<li><p>both can be done by placing the model in the <code>parameters::model_parameters()</code> function</p></li>
<li><p>same function to standardize parameter estimates, but three new arguments</p></li>
<li><p>we can obtain models based on robust standard errors by setting <code>vcov = "method"</code> and replacing <code>method</code> with the name of the method we want to use to compute robust standard errors.</p></li>
<li><p><code>vcov = "HC3"</code> willuse HC3 method, though some think <code>HC4</code> is better</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vcov =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HC4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.242</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.645</td>
<td style="text-align: right;">5.419</td>
<td style="text-align: right;">-1.638</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">12.306</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.749</td>
<td style="text-align: right;">3.986</td>
<td style="text-align: right;">10.738</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.260</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.630</td>
<td style="text-align: right;">15.543</td>
<td style="text-align: right;">4.906</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vcov =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HC3"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.170</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.503</td>
<td style="text-align: right;">5.277</td>
<td style="text-align: right;">-1.646</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">12.246</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.315</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.746</td>
<td style="text-align: right;">3.989</td>
<td style="text-align: right;">10.687</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.247</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.654</td>
<td style="text-align: right;">15.519</td>
<td style="text-align: right;">4.933</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Values are not much different from the non-robust versions, mainly becasue the original model didn’t violate its assumptions</li>
<li>if a robust model yields the same-ish values as a non-robust model, we know the non-robust model has not been unduly biased.</li>
<li>if the robust estimates are hugely different, then use and report the robust versions</li>
<li>fitting a robust model is a win-win</li>
</ul>
<section id="small-samples" class="level3">
<h3 class="anchored" data-anchor-id="small-samples">Small samples</h3>
<ul>
<li>we might prefer to bootstrap confidence intervals by setting the bootstrap argument in <code>model_parameters()</code> to <code>TRUE</code></li>
<li>by default, 1000 bootstrap samples are used</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_parameters</span>(album_full_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb70-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-25.716</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-57.196</td>
<td style="text-align: right;">4.526</td>
<td style="text-align: right;">0.108</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.371</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.758</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">10.971</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.416</td>
<td style="text-align: right;">15.194</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>these bootstrapped confidence intervals don’t rely on assumptions of normality or homoscedasticity, so they give an accurate estimate of the population value of <img src="https://latex.codecogs.com/png.latex?b"> for each predictor (assuming our sample is one of the 95% with confidence intervals that contain the population value)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because bootstrapping relies on random sampling from the data, you will get a slightly different estimate each time you bootstrap a model. This is normal.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping is a technique from which the sampling distribution of a statistic is estimated by …
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Taking repeated samples (with replacement) from the data set.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The bootstrap confidence interval for image ranges from 6.63 to 15.45 (the values might not exactly match these). What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 6.63 and 15.45.</p>
</div>
</div>
</div>
</section>
</section>
<section id="unguided-example-1" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example-1">Unguided example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(soc_anx_obq_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/discovr_08_the_glm/index_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1">soc_anx_obq_rsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> soc_anx_obq_lm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb73-2">  broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> soc_anx_tib) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb73-3">    tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_no"</span>) </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(soc_anx_obq_rsd) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-2">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-3">    knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ spai       &lt;dbl&gt; 26, 51, 33, 106, 25, 109
$ iii        &lt;dbl&gt; 56.45161, 16.12903, 37.41935, 16.67742, 5.16129, 36.03226
$ obq        &lt;dbl&gt; 4.425287, 2.034483, 2.586207, 4.839080, 1.758621, 2.126437
$ tosca      &lt;dbl&gt; 4.181818, 4.204545, 3.250000, 4.068182, 3.795455, 4.250000
$ .fitted    &lt;dbl&gt; 71.21490, 54.38582, 37.29426, 71.70370, 43.34703, 56.05675
$ .resid     &lt;dbl&gt; -45.214901, -3.385823, -4.294257, 34.296304, -18.347028, 52…
$ .hat       &lt;dbl&gt; 0.03290194, 0.01449059, 0.06325813, 0.05273344, 0.02419968,…
$ .sigma     &lt;dbl&gt; 28.84302, 29.12634, 29.12526, 28.96090, 29.08160, 28.74430
$ .cooksd    &lt;dbl&gt; 2.847631e-02, 6.772251e-05, 5.263717e-04, 2.737010e-02, 3.3…
$ .std.resid &lt;dbl&gt; -1.5846267, -0.1175478, -0.1529180, 1.2144842, -0.6401266, …</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">spai</th>
<th style="text-align: right;">iii</th>
<th style="text-align: right;">obq</th>
<th style="text-align: right;">tosca</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">56.45</td>
<td style="text-align: right;">4.43</td>
<td style="text-align: right;">4.18</td>
<td style="text-align: right;">71.21</td>
<td style="text-align: right;">-45.21</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">28.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-1.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">54.39</td>
<td style="text-align: right;">-3.39</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">37.42</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">37.29</td>
<td style="text-align: right;">-4.29</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">16.68</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">71.70</td>
<td style="text-align: right;">34.30</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">28.96</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">1.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">5.16</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">43.35</td>
<td style="text-align: right;">-18.35</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">29.08</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">36.03</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">4.25</td>
<td style="text-align: right;">56.06</td>
<td style="text-align: right;">52.94</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">28.74</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">1.84</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb76-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb76-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb76-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1      49      -2.26  -65.1
2      16      -2.13  -61.1
3     127      -1.98  -56.7
4     120       2.18   62.9
5       8       2.61   74.6
6      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb78-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb78-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb78-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1       8       2.61   74.6
2      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb80-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(.std.resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb80-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .std.resid, .resid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb80-4">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.std.resid)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# ℹ 3 variables: case_no &lt;int&gt;, .std.resid &lt;dbl&gt;, .resid &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1">soc_anx_obq_rsd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb82-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(.cooksd)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb82-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_no, .cooksd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1       8  0.0724
 2      45  0.0497
 3      14  0.0397
 4      40  0.0373
 5      16  0.0330
 6      87  0.0304
 7     127  0.0289
 8       1  0.0285
 9       4  0.0274
10      12  0.0268
# ℹ 124 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would you interpret the plot of ZPRED vs ZRESID?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I can’t see any problems</p>
<p>The dots look like a random, evenly-dispersed pattern. No funnel shapes, no banana shapes, so all is fine.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes The distribution is fairly normal: the dots in the P-P plot lie close to the diagonal.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>4.55% 6 cases from 132 have standardized residuals with absolute values greater than 1.96, and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B6%7D%7B132%7D%C3%97100=4.55"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>1.51% 2 cases from 132 have standardized residuals with absolute values greater than 2.5, and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B2%7D%7B132%7D%C3%97100=1.51"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The appropriate proportion of cases have standardized residuals in the expected range and no case has a value exceeding 3.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are there any Cook’s distances greater than 1?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The fact there are no Cook’s distances greater than 1 suggests that no cases are having undue influence on the model as a whole.</p>
</div>
</div>
</div>
</section>
<section id="bayesian-approaches" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-approaches">Bayesian Approaches</h2>
<ul>
<li>2 possible things to do
<ul>
<li>compare models using Bayes factors</li>
<li>estimate model parameters using Bayesian methods</li>
</ul></li>
</ul>
<section id="bayes-factors" class="level3">
<h3 class="anchored" data-anchor-id="bayes-factors">Bayes factors</h3>
<ul>
<li>compare models using a Bayes factor using <code>regressionBF()</code> funtion in the <code>BayesFactor</code> package</li>
<li>compare models against each other hierarchically to see which model has the largest Bayes factor, and to evaluate the strength of evidence that this Bayes factor suggests that a particular model predicts the outcome better than the intercept alone (i.e.&nbsp;a model with no predictors).</li>
</ul>
<p><code>model_bf &lt;- BayesFactor::regressionBF(formula, rscaleCont = "medium", data = tibble)</code></p>
<ul>
<li>creates an object called <code>model_bf</code> based onthe same type of formula we put in the <code>lm()</code> function to specify the model</li>
<li>the argument <code>rscaleCont</code> sets the scale of the prior distribution for the distribution for the standardized <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7Ds"> in the model.</li>
<li>arguemnt can be set as a numeric value or one of three pre-defined values</li>
<li>default value is <code>medium</code>, corresponding to a value of about <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B4%7D">, or about 0.354</li>
<li>example uses the default to illustrate, but consider what value is appropriate for a given model</li>
</ul>
<p>Fitting the model with Bayes factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1">album_bf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regressionBF</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscaleCont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1">album_bf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts                   : 1.320123e+16 ±0%
[2] airplay                   : 4.723817e+17 ±0.01%
[3] image                     : 6039.289     ±0%
[4] adverts + airplay         : 5.65038e+39  ±0%
[5] adverts + image           : 2.65494e+20  ±0%
[6] airplay + image           : 1.034464e+20 ±0%
[7] adverts + airplay + image : 7.746101e+42 ±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>Output shows Bayes factors for all potential models we can get from our predictor variables (7 in total)</li>
<li>each model is compared to a model that contains only the intercept</li>
<li>all models have huge Bayes factors suggesting they all provide strong evidence for the hypothesis that the model predicts the outcome better than the intercept alone</li>
<li>best model is the one with the largest Bayes factor, which is model 7, which includes all three predictors - it has a Bayes factor of <img src="https://latex.codecogs.com/png.latex?7.75%C3%9710%5E%7B42%7D"></li>
</ul>
</section>
</section>
<section id="bayesian-parameter-estimates" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-parameter-estimates">Bayesian parameter estimates</h2>
<ul>
<li>knowing model is best ( we know this from the nonBayesian model) we can estimate the parameters using the <code>lmBF()</code> function</li>
<li>same format as <code>regressionBF()</code></li>
<li><code>lmBF()</code> fits only the model we specify</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1">album_full_bf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmBF</span>(sales <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> adverts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> airplay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> image, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscaleCont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> album_tib)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1">album_full_bf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts + airplay + image : 7.746101e+42 ±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>same result in the previous output</li>
<li>but we can extract <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D">-values derived from Bayesian estimaten and their credible intervals using the <code>posterior()</code> function
<ul>
<li>enter the name of the model we just created <code>album_full_bf</code> into ’posterior()` function in which we also set the number of iterations to 10000</li>
<li>samples taken from the posterios distribution of the <code>album_full_bf</code> model and stored in an object called <code>album_full_post</code></li>
<li>place posterios samples into <code>summary()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1">album_full_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BayesFactor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior</span>(album_full_bf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iterations =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>)</span>
<span id="cb92-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(album_full_post) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1:10000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

             Mean        SD  Naive SE Time-series SE
mu      1.931e+02 3.363e+00 3.363e-02      3.308e-02
adverts 8.403e-02 6.926e-03 6.926e-05      6.845e-05
airplay 3.335e+00 2.843e-01 2.843e-03      2.758e-03
image   1.097e+01 2.434e+00 2.434e-02      2.434e-02
sig2    2.251e+03 2.293e+02 2.293e+00      2.383e+00
g       1.030e+00 1.811e+00 1.811e-02      1.785e-02

2. Quantiles for each variable:

             2.5%       25%       50%       75%     97.5%
mu      1.865e+02 1.909e+02 1.931e+02 1.954e+02 1.997e+02
adverts 7.046e-02 7.931e-02 8.397e-02 8.875e-02 9.743e-02
airplay 2.776e+00 3.145e+00 3.335e+00 3.527e+00 3.898e+00
image   6.192e+00 9.322e+00 1.094e+01 1.260e+01 1.575e+01
sig2    1.846e+03 2.092e+03 2.232e+03 2.392e+03 2.744e+03
g       1.737e-01 3.785e-01 6.122e-01 1.078e+00 4.408e+00</code></pre>
</div>
</div>
<ul>
<li>Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> can be found in the column labeled <code>Mean</code>
<ul>
<li>0.084 for adverts</li>
<li>3.34 for airplay</li>
<li>10.96 for image</li>
</ul></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Predictor</th>
<th>Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
<th>non-Bayesian estimate of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>adverts</td>
<td>0.084</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>airplay</td>
<td>3.34</td>
<td>3.37</td>
</tr>
<tr class="odd">
<td>image</td>
<td>10.96</td>
<td>11.09</td>
</tr>
</tbody>
</table>
<ul>
<li>most useful are the <code>credible intervals</code> for these parameters
<ul>
<li>if we want the 95% credible interval, then we read the values from columns labelled 2.5% and 97.5% in the table of quantiles</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unlike confidence intervals, credible intervals contain the population value with a probability of 0.95 (95%)</p>
</div>
</div>
<ul>
<li><p>there is a 95% probability that the population value of <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb%7D"> lies between | Predictor | 2.5% | 97.5% | | — | — | — | | adverts | 0.07 | 0.097 | | airplay | 2.78 | 3.87 | | image |6.26 | 15.86 |</p></li>
<li><p>these intervals are constructed assuming that an effect exists, so you cannot use them to test the hypothesis that the null is exactly 0, only to establish plausible population values of the <img src="https://latex.codecogs.com/png.latex?b">s in the model.</p></li>
</ul>


</section>
</section>

 ]]></description>
  <category>regression</category>
  <category>R</category>
  <category>discovr</category>
  <guid>https://cmadland.github.io/blog/posts/discovr_08_the_glm/</guid>
  <pubDate>Mon, 26 Feb 2024 08:00:00 GMT</pubDate>
  <media:content url="https://cmadland.github.io/blog/posts/discovr_08_the_glm/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Simple Regression</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/simple-regression/</link>
  <description><![CDATA[ 





<section id="regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="regression-equation">Regression Equation</h2>
<p>Linear regression expresses the relationship between two variables, <img src="https://latex.codecogs.com/png.latex?X_i"> and <img src="https://latex.codecogs.com/png.latex?Y_i">.</p>
<p>The <img src="https://latex.codecogs.com/png.latex?_i"> refers to the cases in the dataset, so if there are 1000 cases, then <img src="https://latex.codecogs.com/png.latex?_i"> is 1-1000. Each <img src="https://latex.codecogs.com/png.latex?_i"> refers to a ‘student’.</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=b_0+%7Bb_1%7D%7BX_i%7D+%5Cepsilon_i"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?b_1"> is the slope or regression coefficient (how much <img src="https://latex.codecogs.com/png.latex?Y"> will change when <img src="https://latex.codecogs.com/png.latex?X"> increases by 1)<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?b_0"> is the <img src="https://latex.codecogs.com/png.latex?Y">-intercept, where the regression line crosses the <img src="https://latex.codecogs.com/png.latex?Y"> axis</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cepsilon_i"> is the error term</li>
</ul>
<p>or</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+%7Bb_1%7D%7BX_i%7D"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"> is the predicted value of <img src="https://latex.codecogs.com/png.latex?Y"></li>
</ul>
<p>Notes:</p>
<p>Larger values of <img src="https://latex.codecogs.com/png.latex?b_1"> indicate a steeper regression line</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/slope.png" class="img-fluid figure-img"></p>
<figcaption>examples of slope and intercept</figcaption>
</figure>
</div>
<ul>
<li>left image, red is positive slope and green is negative slope (negative correlation; when predictor increases, outcome decreases)</li>
<li>right image, all slopes positive</li>
</ul>
</section>
<section id="calculating-regression" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression">Calculating Regression</h2>
<ul>
<li>any dataset is made up of points, and regression finds the best fitting straight line for the dataset</li>
</ul>
</section>
<section id="best-fit" class="level2">
<h2 class="anchored" data-anchor-id="best-fit">Best Fit</h2>
<ul>
<li>need to define mathematically the distance between each data point and the regression line<br>
</li>
<li>for every <img src="https://latex.codecogs.com/png.latex?X"> value in the data, the linear equation can determine the <img src="https://latex.codecogs.com/png.latex?Y"> value on the line - called <strong>predicted <img src="https://latex.codecogs.com/png.latex?Y"></strong>, or <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"></li>
<li>this distance measures the error between the line and the data</li>
<li>if all data points were on the line, then the line ‘fits’ the data perfectly</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"> should be close to actual <img src="https://latex.codecogs.com/png.latex?Y"></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/predicted.png" class="img-fluid figure-img"></p>
<figcaption>graph showing the difference between predicted and actual values of <img src="https://latex.codecogs.com/png.latex?Y"></figcaption>
</figure>
</div>
<ul>
<li>green dots = <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"></li>
<li>blue dots = <img src="https://latex.codecogs.com/png.latex?Y"></li>
<li>distance between the green and blue dots is the prediction error - need to minimize</li>
<li>some are positive (above the line) and some are negative (below the line)<br>
</li>
<li>since some are positive and some are negative, if we want to add the error values together, we need to get rid of the signs by squaring the distance and adding the squared error</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?total%20%5Cspace%20squared%20%5Cspace%20error%20=%7B%5Csum%5En_%7Bi=1%7D%7D(%7BY_i%7D-%7B%5Chat%7BY_i%7D%7D)%5E2"></p>
<ul>
<li>for each poissible line, we can calculate the total squared error, then choose the line with the lowest total squared error, which is the regression line</li>
<li>this minimizes the difference between the line and the observed data</li>
<li>this line is called the <em>least squared error</em> solution</li>
<li>this method is inefficient due to the infinite number of lines possible</li>
<li>calculus is a mathematical technique to find the maxima or minima of a mathematical expression.</li>
<li>Using this method, the regression coefficients (slope (<img src="https://latex.codecogs.com/png.latex?b_1">) and intercept (<img src="https://latex.codecogs.com/png.latex?b_0">)) that produce the minimum errors can be calculated.</li>
</ul>
</section>
<section id="calculating-regression-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression-coefficients">Calculating Regression Coefficients</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D_i=b_0+b_1X_i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_0%7D=M_Y-%5Chat%7Bb_1%7DM_x"></p>
<p>Where</p>
<p><img src="https://latex.codecogs.com/png.latex?r"> is the correlation between <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?S_X"> and <img src="https://latex.codecogs.com/png.latex?S_Y"> are sample standard deviations for <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?M_X"> and <img src="https://latex.codecogs.com/png.latex?M_Y"> are sample means for <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"></p>
<p>These are <em>raw regression coefficients</em> (<img src="https://latex.codecogs.com/png.latex?b_1">): the change in outcome is associated with a change in the predictor</p>
<section id="standardized-regression-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="standardized-regression-coefficients">Standardized regression coefficients</h3>
<ul>
<li>tell us the same thing, except expressed as standard deviations</li>
<li>if both variables <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"> have been standardized by transforming tehm into <em>Z-scores</em> before calculating the regression coefficients, then the regression coefficients become *standardized coefficients</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D=%5Cbeta%7BZ_%7BX_i%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbeta=r"></p>
<p>Where</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D"> is the standard deviation of <img src="https://latex.codecogs.com/png.latex?Y"><br>
<img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BX_i%7D%7D"> is the styandard deviation of <img src="https://latex.codecogs.com/png.latex?X"><br>
<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> is the correlation coefficient</p>
<p>Standardizing <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"> puts the variables on the same scale - when <img src="https://latex.codecogs.com/png.latex?X"> increases by 1SD, <img src="https://latex.codecogs.com/png.latex?Y"> increases by 1SD</p>
</section>
</section>
<section id="analysis-of-regression" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-regression">Analysis of regression</h2>
<ul>
<li>regression line is only a model based on the data</li>
<li>process of testing the significance of a regression equation is called <em>analysis of regression</em></li>
<li>null hypothesis in the analysis of regression states that the equation does not account for a significant proportion of the variance in <img src="https://latex.codecogs.com/png.latex?Y"> scores</li>
<li>analysis of regression is similar to ANOVA</li>
</ul>
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/anoreg.png" class="img-fluid"></p>
<p>Sum Square Total (<img src="https://latex.codecogs.com/png.latex?SS_T"> (left plot)) is <img src="https://latex.codecogs.com/png.latex?%5Csum(Y-%5Cbar%7BY%7D)%5E2"></p>
<p>Sum Square Residual (<img src="https://latex.codecogs.com/png.latex?SS_R"> (right plot)) is <img src="https://latex.codecogs.com/png.latex?%5Csum(Y-%5Chat%7BY%7D)%5E2"></p>
<ul>
<li>prediction error - squared distance between the data and the regression line</li>
<li>needs to be minimized</li>
<li>this is the variability that is not explained by the regression equation</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/ssm.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Sum Square model (<img src="https://latex.codecogs.com/png.latex?SS_M">) is <img src="https://latex.codecogs.com/png.latex?%5Csum(%5Chat%7BY%7D-%5Cbar%7BY%7D)%5E2"></p>
<ul>
<li><p>in this equation, <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+b_1X"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_T">: total variability is the variability between the scores and the mean<br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_R">: sum squared residual is the residual or error variability between the regression model and the data<br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_M"> or sum square regression: Model variability - difference in variability between the model and the mean.<img src="https://latex.codecogs.com/png.latex?Y"> are determined by the value of <img src="https://latex.codecogs.com/png.latex?X"><br>
</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?SS_T"> is the sum of <img src="https://latex.codecogs.com/png.latex?SS_R"> and <img src="https://latex.codecogs.com/png.latex?SS_M"></p>
<ul>
<li>part of the variability is residual - we don’t know what is causing<br>
</li>
<li>part of it is due to the model - the relationship between <img src="https://latex.codecogs.com/png.latex?Y"> and <img src="https://latex.codecogs.com/png.latex?X"></li>
</ul></li>
</ul>
<p>The proportion of variability in <img src="https://latex.codecogs.com/png.latex?Y"> that is predicted by its relationship with <img src="https://latex.codecogs.com/png.latex?X">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BSS_%7Bregression%7D%7D%7BSS_T%7D=r%5E2"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is an effect size that tells us the proportion of variability that is accounted for by the model</p>
<p>The proportion of the variability that is not accounted for is</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BSS_%7Bresidual%7D%7D%7BSS_T%7D=1-r%5E2"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is very mieaningful</p>
<p>if <img src="https://latex.codecogs.com/png.latex?R%5E2"> is 20%, then the amount of the variability in <img src="https://latex.codecogs.com/png.latex?Y"> that is accounted for by the model is 20%, which is quite large.</p>
<p>Therefore</p>
<p><img src="https://latex.codecogs.com/png.latex?SS_%7Bregression%7D=r%5E2SS_T"></p>
<p><img src="https://latex.codecogs.com/png.latex?SS_%7Bresidual%7D=(1-r%5E2)SS_Y"></p>
<p><img src="https://latex.codecogs.com/png.latex?SS_Y"> is the same thing as <img src="https://latex.codecogs.com/png.latex?SS_T"></p>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> is the Pearson Correlation Coefficient squared</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/components.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Total variability is partitioned into two - sum squared regression (explained by the model) and sum squared residual (not explained by the model).</p>
<p>Same for degrees of freedom</p>
<p>Sums of squares are total values and can be expressed as averages called <em>Mean Squares</em>, or <img src="https://latex.codecogs.com/png.latex?MS"> AKA <em>variance</em></p>
<p><img src="https://latex.codecogs.com/png.latex?MS_%7Bregression%7D=%5Cfrac%7BSS_%7Bregression%7D%7D%7Bdf_%7Bregression%7D%7D"></p>
<ul>
<li>mean square variance is the variance accounted for in the model</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?MS_%7Bresidual%7D=%5Cfrac%7BSS_%7Bresidual%7D%7D%7Bdf_%7Bresidual%7D%7D"></p>
<ul>
<li>mean square residual is the variance not accounted for in the model</li>
</ul>
<p>An <img src="https://latex.codecogs.com/png.latex?F">-ratio can be used to compare these two mean squares</p>
<p><img src="https://latex.codecogs.com/png.latex?F=%5Cfrac%7BMS_%7Bregression%7D%7D%7BMS_%7Bresidual%7D%7D%20%5Ctext%7Bwith%7D%5C:%20df=1,n-2"></p>
<ul>
<li>if the mean square regression is small compared to the mean square residual, then the model does not account for much variance<br>
</li>
<li>if the mean square regression is larger than the mean square residual, then the model accounts for more variance</li>
</ul>
</section>
<section id="an-example-fields" class="level2">
<h2 class="anchored" data-anchor-id="an-example-fields">An Example (Fields)</h2>
<ul>
<li>record company boss interested in predicting album sales from advertising bsed on 200 different album releases<br>
</li>
<li>outcome variable: sales of CDs and downloads in the week after release<br>
</li>
<li>predictor variable: amount in GBP spent promoting the album before release</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/album-sales.png" class="img-fluid figure-img"></p>
<figcaption>scatterplot of album sales by advertising budget</figcaption>
</figure>
</div>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2"> = 0.335, so 33.5% of the variability is shared by both variables (cutoffs, 9% - small, 25% - large effect size)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/model-summary.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/anova.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cmadland.github.io/blog/posts/simple-regression/coefficients.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
</section>
<section id="activities" class="level2">
<h2 class="anchored" data-anchor-id="activities">Activities</h2>
<p>In a survey that included assessment of husband and wife heights, Hodges, Krech and Crutchfield (1975) reported the following results. Let’s treat wife height as the predictor (X) variable and husband as the outcome (Y) variable:<br>
<img src="https://latex.codecogs.com/png.latex?r_XY"> = .32, <img src="https://latex.codecogs.com/png.latex?N"> = 1, 296<br>
Wife height: <img src="https://latex.codecogs.com/png.latex?M_X"> = 64.42, <img src="https://latex.codecogs.com/png.latex?S_X"> = 2.56<br>
Husband height: <img src="https://latex.codecogs.com/png.latex?M_Y"> = 70.46, <img src="https://latex.codecogs.com/png.latex?S_Y"> = 2.87<br>
a. Calculates the values of <img src="https://latex.codecogs.com/png.latex?b_0"> and <img src="https://latex.codecogs.com/png.latex?b_1"> to predict husband height in inches (Y) from wife height in inches (X), and write out this raw score predictive equation</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32%5Cfrac%7B2.87%7D%7B2.56%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=0.35"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=M_Y-%5Chat%7Bb_1%7DM_X"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=70.46-(0.35*64.42)"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=70.46-22.54"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=47.91"></p>
<p>Predictive Equation <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=b_0+%7Bb_1%7D%7BX_i%7D"> <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=47.91+(0.35*%7BX_i%7D)"></p>
<ol start="2" type="a">
<li>For women: what is your own height? Substitute your own height into the equation from step a, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=47.91+(0.35*67)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=71.36"></p>
<ol start="3" type="a">
<li>Now reverse the roles of the variables (i.e., use husband height as the predictor and wife height as the outcome variable). Calculates the values of bb0 and bb1.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=r%5Cfrac%7BS_Y%7D%7BS_X%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32%5Cfrac%7B2.56%7D%7B2.87%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.32*.89"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7Bb_1%7D=.28"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=M_Y-%5Chat%7Bb_1%7DM_X"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=64.42-(0.28*70.46)"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=64.42-19.72"></p>
<p><img src="https://latex.codecogs.com/png.latex?b_0=44.7"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=44.7+(0.28*%7BX_i%7D)"></p>
<ol start="4" type="a">
<li>For men: what is your height in inches? Substitute your own height into the equation from step c, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=44.7+(0.28*70)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D=64.3"></p>
<ol start="5" type="a">
<li>What proportion of variance in husband height is predictable from wife height? Test the significance of the regression equation.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?r%5E2=.10"></p>
<ol start="6" type="a">
<li>If both X and Y have been standardized by transforming into Z scores before calculating the regression coefficients, what would be the values of bb0 and bb1 to predict husband height in inches (Y) from wife height in inches (X)? How does this standardized version of the prediction equation tell us about “regression toward the mean” for predictions?</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7BZ_%7BY_i%7D%7D=%5Cbeta%7BZ_%7BX_i%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Chat%7B2.87%7D=0.32%7B2.56%7D"></p>


</section>

 ]]></description>
  <category>505</category>
  <guid>https://cmadland.github.io/blog/posts/simple-regression/</guid>
  <pubDate>Sun, 18 Feb 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Variance and Standard Deviation</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/variance-std-dev/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(UsingR)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: UsingR</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: HistData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Hmisc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Hmisc'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    format.pval, units</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(HistData)</span></code></pre></div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?sample%20variance=s%5E2=%5Cfrac%7B1%7D%7Bn-1%7D%E2%80%8E%E2%80%8E%5Csum_i(x_i%20-%20%5Cbar%7Bx%7D)%5E2"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">wts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">43</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">47</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">59</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(wts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 24 24 27 29 38 40 43 47 48 48 59 61</code></pre>
</div>
</div>



 ]]></description>
  <category>intro-stats</category>
  <category>variance</category>
  <category>standard-deviation</category>
  <guid>https://cmadland.github.io/blog/posts/variance-std-dev/</guid>
  <pubDate>Sun, 18 Feb 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Welcome To My Blog</title>
  <dc:creator>Colin Madland</dc:creator>
  <link>https://cmadland.github.io/blog/posts/welcome/</link>
  <description><![CDATA[ 





<p>Hey!</p>
<p><img src="https://cmadland.github.io/blog/posts/welcome/thumbnail.jpg" class="img-fluid"></p>
<p>I plan to use this space to record my learning and review of stats using R and this blog built with <a href="https://quarto.org/docs/websites/website-blog.html">Quarto</a>. The last time I was semi-serious about a blog was in Grav, and WordPress before that, so I’m curious to see how this works out.</p>
<p>I’m using a few books in this journey, including</p>
<p>Desjardins, C. D., &amp; Bulut, O. (2018). Handbook of Educational Measurement and Psychometrics Using R (1st ed.). Chapman and Hall/CRC. https://doi.org/10.1201/b20498</p>
<p>Field, A. P. (2018). Discovering statistics using IBM SPSS statistics (5th edition, North American edition). Sage Publications Inc.</p>
<p>Navarro, D. (n.d.). Learning statistics with R: A tutorial for psychology students and other beginners. (Version 0.6.1). Retrieved January 8, 2020, from https://learningstatisticswithr.com/book/</p>



 ]]></description>
  <category>news</category>
  <guid>https://cmadland.github.io/blog/posts/welcome/</guid>
  <pubDate>Wed, 14 Feb 2024 08:00:00 GMT</pubDate>
</item>
</channel>
</rss>
