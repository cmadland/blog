<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Colin Madland">
<meta name="dcterms.date" content="2024-02-26">

<title>discovr_08 - General Linear Model â€“ Learning | Assessment | Technology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-79bb3942e891885f9f7af119cd221462.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-99e42d58961487636930fdd71fdb3421.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Learning | Assessment | Technology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cmadland/blog"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/cmad.land"> <i class="bi bi-bluesky" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">discovr_08 - General Linear Model</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">regression</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">discovr</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Colin Madland </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 26, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.2     âœ” tibble    3.2.1
âœ” lubridate 1.9.4     âœ” tidyr     1.3.1
âœ” purrr     1.0.4     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: fit.models</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>album_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/album_sales.csv"</span>) <span class="sc">|&gt;</span> readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 200 Columns: 5
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (1): album_id
dbl (4): adverts, sales, airplay, image

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>soc_anx_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/social_anxiety.csv"</span>) <span class="sc">|&gt;</span> readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 134 Columns: 4
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
dbl (4): spai, iii, obq, tosca

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>metal_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/metal_health.csv"</span>)  <span class="sc">|&gt;</span> readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2506 Columns: 2
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
dbl (2): hm, suicide

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="fitting-the-linear-model" class="level1">
<h1>Fitting the Linear Model</h1>
<ul>
<li>scatterplots to get an idea of whether assumption of linearity is met, look for outliers or other unusual cases</li>
<li>run an initial regression and save the diagnostics</li>
<li>if we want to generalize or test for significance or confidence intervalsâ€¦
<ul>
<li>examine residuals for homoscedasticity, independence, normality, and linearity
<ul>
<li>lack of linearity â€“&gt; fit a non-linear model</li>
<li>assumptions met and no bias â€“&gt; Model can be generalized</li>
<li>lack of independent errors â€“&gt; multi-level model</li>
<li>all other situations â€“&gt; fit a robust version of the model using bootstrapping (small samples) or robust standard errors</li>
</ul></li>
</ul></li>
</ul>
<dl>
<dt>homoscedasticity</dt>
<dd>
<p>assumption of equal or similar variances in different groups being compared</p>
</dd>
<dd>
<p>homogeneity of variance</p>
</dd>
</dl>
<p><strong>Figure 1</strong> <img src="dsr2_fig_08_12_glm_process.png" class="img-fluid" alt="General process of fitting a linear model from discovr_08"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>album_tib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 Ã— 5
   album_id adverts sales airplay image
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 aox1foms    10.3   330      43    10
 2 u453js2i   986.    120      28     7
 3 pie89xnr  1446.    360      35     7
 4 u2k5a0df  1188.    270      33     7
 5 t4699ux3   575.    220      44     5
 6 s4h49cu2   569.    170      19     5
 7 1235a8sf   472.     70      20     1
 8 p2v24p5k   537.    210      22     9
 9 4fbjg024   514.    200      21     7
10 e9w6usdb   174.    300      40     7
# â„¹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>Use <code>GGally::ggscatmat</code> package to visualize the data</li>
<li>produces
<ul>
<li>a matrix of scatterplots below the diagonal</li>
<li>distributions along the diagonal</li>
<li>the correlation coefficient above the diagonal</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggscatmat</span>(album_tib, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"adverts"</span>, <span class="st">"airplay"</span>, <span class="st">"image"</span>, <span class="st">"sales"</span>))  <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<ul>
<li>3 predictors have reasonably linear relationships with album sales and no obvious outliers (except bottom left of â€˜band imageâ€™ scatterplots)</li>
<li>across the diagonal (distributions)
<ul>
<li>advertising is very skewed</li>
<li>airplay and sales look heavy-tailed</li>
</ul></li>
<li>correlations in the plot give us an idea of the relationships between predictors and outcome</li>
<li>if we ignore album sales, the highest correlation is between image ratings and amount of airplay, which is significant and the 0.01 level (<span class="math inline">\(r=0.18\)</span>)</li>
<li>focussing on the outcome variable, adverts and airplay correlate best with the outcome (<span class="math inline">\(r=0.58\)</span> and <span class="math inline">\(r=0.6\)</span>)</li>
</ul>
</section>
<section id="one-predictor" class="level2">
<h2 class="anchored" data-anchor-id="one-predictor">One predictor</h2>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<ul>
<li>predicting sales from advertising alone</li>
</ul>
<p><span class="math display">\[Y_i=b_0+{b_1}{X_i}+\epsilon_i\]</span></p>
<p><span class="math display">\[\text{Sales}_i=b_0+{b_1}{\text{Advertising}_i}+\epsilon_i\]</span></p>
<ul>
<li>it is clear from the bottom left scatterplot and the correlation (<span class="math inline">\(r=0.58\)</span>) that a positive relation exists. More advertising money spent leads to greater album sales.</li>
<li>some albums sell well regardless of advertising (top-left of scatterplot)</li>
<li>no albums sell badly when adverts are high (bottom-right of scatterplot)</li>
<li>to fit a linear model, we use <code>lm()</code> function <code>my_model &lt;- lm(outcome ~ predictor(s), data = tibble, na.action = an action)</code>
<ul>
<li><code>my_model</code> is the name of the model</li>
<li><code>outcome</code> is the name of the outcome variable (sales)</li>
<li><code>predictor</code> is the name of the predictor variable (adverts) or, a list of variables separated by <code>+</code> symbols</li>
<li><code>tibble</code> is the name of the tibble containing the data (album_tib)</li>
</ul></li>
<li>this function maps directly to the equation for the model
<ul>
<li><code>adverts ~ sales</code> maps to <span class="math inline">\(\text{Sales}_i=b_0+{b_1}{\text{Advertising}_i}+\epsilon_i\)</span> except we ignore the error term and parameter estimates and we replace the <code>=</code> with <code>~</code> (which means â€˜predicted fromâ€™)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>album_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> adverts, <span class="at">data =</span> album_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(album_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts, data = album_tib, na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-152.949  -43.796   -0.393   37.040  211.866 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.341e+02  7.537e+00  17.799   &lt;2e-16 ***
adverts     9.612e-02  9.632e-03   9.979   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 65.99 on 198 degrees of freedom
Multiple R-squared:  0.3346,    Adjusted R-squared:  0.3313 
F-statistic: 99.59 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(album_lm)  <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">65.991</td>
<td style="text-align: right;">99.587</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1120.688</td>
<td style="text-align: right;">2247.375</td>
<td style="text-align: right;">2257.27</td>
<td style="text-align: right;">862264.2</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>note <span class="math inline">\(df=1\)</span> and <span class="math inline">\(df.residual=198\)</span> therefore we can say that adding the predictor of advertising significantly improved the fit of the model to the data compared to having no predictors in the model</li>
<li><span class="math inline">\(F(1,198)=99.59, p&lt;.001\)</span></li>
</ul>
</section>
<section id="model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="model-parameters">Model Parameters</h3>
<p>To see model parameters, use <code>broom::tidy()</code></p>
<p><code>broom::tidy(model_name, conf.int = FALSE, conf.level = 0.95)</code></p>
<ul>
<li>put the model name into the function, then two optional arguments
<ul>
<li>confidence intervals <code>conf.int=TRUE</code> (confidence intervals are not included by default)</li>
<li>default is 95%, but you can change it with <code>conf.level=.99</code> for 99% confidence interval</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(album_lm, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 134.       7.54        17.8  5.97e-43 119.       149.   
2 adverts       0.0961   0.00963      9.98 2.94e-19   0.0771     0.115</code></pre>
</div>
</div>
<ul>
<li>output provides estimates of the model parameters (<span class="math inline">\(\hat{b}\)</span>-values)</li>
<li><span class="math inline">\(Y\)</span> intercept (<span class="math inline">\(b_0\)</span>) is 134.14 (when <span class="math inline">\(X\)</span> is 0, sales will be 134140)</li>
<li><span class="math inline">\(X\)</span> (<span class="math inline">\(b_1\)</span>) is 0.096.
<ul>
<li>represents the change in outcome associated with a unit change in predictor.</li>
<li>when the predictor increases by 1, the outcome increases by .096, but since the units of measurement was thousands of pounds and thousands of sales, an increase in $1000 will lead to 96 more albums sold</li>
<li>not very good return</li>
<li>BUT, we know that advertising only accounts for 1/3 of the variance</li>
</ul></li>
<li>If a predictor is having a significant impact on our ability to predict the outcome, then <span class="math inline">\(\hat{b}\)</span> should be different from 0 and large relative to its standard error</li>
<li>the <span class="math inline">\(t\)</span>-test (labelled statistic) and the associated <span class="math inline">\(p\)</span>-value tell us whether the <span class="math inline">\(\hat{b}\)</span> is significantly different from 0</li>
<li>the column p.value contains the exact probability that a value of <span class="math inline">\(t\)</span> at least as big as the one in the table would occur if the value of <span class="math inline">\(b\)</span> in the population were 0</li>
<li>if this propbability is less than 0.05, then we interpret that as the predictor being a significant predictor of hte outcome.</li>
<li>for both <span class="math inline">\(t\)</span>s, the probabilities are in scientific notation
<ul>
<li><code>2.91e-19</code> means <span class="math inline">\(2.91*10^{-19}\)</span>, or <code>move the decimal 19 places to the left</code> or <code>0.000000000000000000291</code></li>
<li><code>2.91e+19</code> means <span class="math inline">\(2.91*10^{19}\)</span>, or <code>move the decimal 19 places to the right</code> or <code>29100000000000000000</code><br>
</li>
</ul></li>
<li>both values are 0 at 3 decimal places</li>
</ul>
</section>
<section id="exploring-the-standard-error-of-hatb" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-standard-error-of-hatb">Exploring the standard error of <span class="math inline">\(\hat{b}\)</span></h3>
<p>https://www.youtube-nocookie.com/embed/3L9ZMdzJyyI?si=ET90VDYq3RVKnKDq</p>
</section>
<section id="confidence-intervals-for-hatb" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-for-hatb">Confidence intervals for <span class="math inline">\(\hat{b}\)</span></h3>
<p>Imagine we collect 100 samples of data measuring the same variables as the current model, then estimate the same model, including confidence intervals for unstandardized values.The boundaries are constructed such that 95% of our 100 samples contain the population value of <span class="math inline">\(b\)</span>. 95 of 100 sample will yield confidence intervals for <span class="math inline">\(b\)</span> that contain the population value, but we donâ€™t know if our sample is one of the 95.</p>
<p>We might just assume that it does, but if the confidence interval contains 0, then there is a possibility that there is no relationship, or the relationship might be negative. The trouble is that we would be wrong 5% of the time.</p>
<p>If the interval does not contain 0, we might conclude there is a genuine positive relationship.</p>
</section>
<section id="using-the-model" class="level3">
<h3 class="anchored" data-anchor-id="using-the-model">Using the model</h3>
<p><span class="math display">\[\text{Sales}_i=\hat{b_0}+\hat{b_1}{\text{Advertising}_i}\]</span></p>
<p><span class="math display">\[\text{Sales}_i=134.14+.096*{Advertising}_i\]</span></p>
<p>Now we can make a prediction by entering a value for the advertising budget, say 100 (equal to 100,000 gbp)</p>
<p><span class="math display">\[\text{Sales}_i=134.14+.096*{100}_i\]</span></p>
<p><span class="math display">\[\text{Sales}_i=143.74\]</span></p>
<p>or 143,740 sales</p>
</section>
</section>
<section id="several-predictors" class="level2">
<h2 class="anchored" data-anchor-id="several-predictors">Several Predictors</h2>
<p>add multiple predictors hierarchically, after advertising is shown to be significant</p>
<p><span class="math display">\[Y_i=b_0+{b_1}{X_1i}+{b_2}{X_2i}+{b_3}{X_3i}+ ... +{b_n}{X_ni}\epsilon_i\]</span></p>
<p><span class="math display">\[Y_i=b_0+{b_1}{advertising_i}+{b_2}{airplay_i}+{b_3}{image_i}+\epsilon_i\]</span></p>
<section id="building-the-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-model">Building the model</h3>
<ul>
<li>add predictors to the R code the same way as we do in the equation, by adding <code>+</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>album_full_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> adverts <span class="sc">+</span> airplay <span class="sc">+</span> image, <span class="at">data =</span> album_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(album_full_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
     Min       1Q   Median       3Q      Max 
-121.324  -28.336   -0.451   28.967  144.132 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -26.612958  17.350001  -1.534    0.127    
adverts       0.084885   0.006923  12.261  &lt; 2e-16 ***
airplay       3.367425   0.277771  12.123  &lt; 2e-16 ***
image        11.086335   2.437849   4.548 9.49e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 47.09 on 196 degrees of freedom
Multiple R-squared:  0.6647,    Adjusted R-squared:  0.6595 
F-statistic: 129.5 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(album_full_lm)  <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">47.087</td>
<td style="text-align: right;">129.498</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1052.168</td>
<td style="text-align: right;">2114.337</td>
<td style="text-align: right;">2130.828</td>
<td style="text-align: right;">434574.6</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><code>r.squared</code> <span class="math inline">\(R^2\)</span> tells us the variance in album sales -&gt; .665, or 66.5%.</li>
<li><span class="math inline">\(R^2\)</span> for adverts was 0.335, so the difference -&gt; .665-.335=.33 means that airplay and image account for a further 33% of the variance</li>
<li>adjusted <span class="math inline">\(R^2\)</span> <code>adj.r.squared</code> tells us how well the model generalizes, and the value should be close to r.squared.
<ul>
<li>in this case it is .66, or only .005 away</li>
</ul></li>
<li><span class="math inline">\(F\)</span>-statistic is the ratio of the improvementin prediction that results from fitting the model, relative to the inaccuracy that sitll exists in the model</li>
<li>the variable <code>p.value</code> contains the p-value associated with <span class="math inline">\(F\)</span> -&gt; in this case is <span class="math inline">\(2.88Ã—10^{âˆ’46}\)</span> -&gt; much smaller than .001</li>
<li>degrees of freedom are <code>df</code> and <code>df.residual</code></li>
<li>we can interpret the result as meaning that the model significantly improves our ability to predict the outcome variable ocmpared to not fitting the model.</li>
<li>reported as <span class="math inline">\(F(3, 196)=129.5, p=&lt;0.001\)</span></li>
</ul>
</section>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing Models</h2>
<ul>
<li>we can compare hierarchical models using an <span class="math inline">\(F\)</span>-statisticusing the <code>anova()</code> function -&gt; <code>anova(model_1, model_2, â€¦ , model_n)</code></li>
<li>list the models in order that we want to compare</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(album_lm, album_full_lm) <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 7
  term                      df.residual    rss    df   sumsq statistic   p.value
  &lt;chr&gt;                           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 sales ~ adverts                   198 8.62e5    NA     NA       NA   NA       
2 sales ~ adverts + airplaâ€¦         196 4.35e5     2 427690.      96.4  6.88e-30</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(F\)</span> (<code>statistic</code>) is 96.5</li>
<li><span class="math inline">\(p\)</span>-value (<code>p.value</code>) is <span class="math inline">\(6.8793949^{-30}\)</span></li>
<li><code>df</code> is 2 (difference between df in 2 models)</li>
<li><code>df.residual</code> is 196</li>
<li>Conclusion -&gt; adding airplay and image to the model significantly improved model fit
<ul>
<li><span class="math inline">\(F(2, 196) = 96.45, p &lt; 0.001\)</span></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can only compare hierarchical models; that is to say that the second model must contain everything that was in the first model plus something new, and the third model must contain everything in the second model plus something new, and so on.</p>
</div>
</div>
<section id="model-parameter-estimates-hatb" class="level3">
<h3 class="anchored" data-anchor-id="model-parameter-estimates-hatb">Model parameter estimates (<span class="math inline">\(\hat{b}\)</span>)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(album_full_lm, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">17.350</td>
<td style="text-align: right;">-1.534</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">-60.830</td>
<td style="text-align: right;">7.604</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.820</td>
<td style="text-align: right;">3.915</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.438</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">6.279</td>
<td style="text-align: right;">15.894</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>output gives estimates of the <span class="math inline">\(b\)</span>-balues (column labelled <code>estimate</code>) and statistics that indicate the individual contribution of each predictor in the model.</li>
<li>all three predictors have positive <span class="math inline">\(\hat{b}\)</span>values, indicating positive relationships
<ul>
<li>as all three predictors increase, so do album sales</li>
</ul></li>
<li><span class="math inline">\(\hat{b}\)</span> vlaues also tell us to what degree each predictor affects the outcome if the effects of all other predictors are held constant
<ul>
<li>advertising budget -&gt; <span class="math inline">\(\hat{b}=0.085\)</span> -&gt; as advertising increases by 1 unit (1000gbp), sales increases by 0.085 units (85 albums), but this is only true if the other two predictors are held constant</li>
<li>airplay <span class="math inline">\(\hat{b}=3.367\)</span> -&gt; as airplay prior to release increases by one unit (1 play), album sales increase by 3.367 units (3367 album sales, but only if the other two predictors are held constant)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the ğ‘Ì‚ (11.086) for band image?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If a band can increase their image rating by 1 unit they can expect additional album sales of 11,086 units</p>
</div>
</div>
</div>
</section>
<section id="standardized-hatbs" class="level3">
<h3 class="anchored" data-anchor-id="standardized-hatbs">Standardized <span class="math inline">\(\hat{b}\)</span>s</h3>
<p>The <code>lm()</code> function does not provide standardized betas, so use <code>model_parameters()</code></p>
<p><code>parameters::model_parameters(my_model, standardize = refit)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(album_full_lm, <span class="at">standardize =</span> <span class="st">"refit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.081</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.593</td>
<td style="text-align: right;">12.261</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">12.123</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">4.548</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>advertising budget -&gt; Standardized <span class="math inline">\(\hat{\beta}=0.511\)</span>
<ul>
<li>as the advertising budgetr increases by one standard deviation (485,655gbp), album sales increase by .511 standard deviations.</li>
<li>the standard deviation for album sales is 80,699, so .511 SD is 41,240 sales</li>
<li>for every increase in advert budget of 485655gbp, album sales will increase by 41,240 IF the other predictors are held constant</li>
</ul></li>
<li>Image -&gt; Standardized <span class="math inline">\(\hat{\beta}=0.192\)</span>
<ul>
<li>a band rated 1 SD on the image scale (1.4 units) will sell .192 SD more units.</li>
<li>this is a change of 15,490 sales IF the other predictors are held constant</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would we interpret the Standardized B (0.512) for airplay?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As the number of plays on radio in the week before release increases by 1 standard deviation, album sales increase by 0.512 standard deviations</p>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for airplay ranges from 2.82 to 3.92. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of this confidence interval containing the population value is 0.95.</del></li>
<li>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 2.82 and 3.92.</li>
<li><del>I can be 95% confident that the population value of b lies between 2.82 and 3.92</del></li>
<li><del>There is a 95% chance that the population value of b lies between 2.82 and 3.92</del></li>
</ul>
</div>
</div>
</div>
<p>Assuming that each confidence interval is one of the 95% that contains the population parameter: - the true size of the relationship between advertising budget and album sales lies somewhere between 0.071 and 0.099 - the true size of the relationship between band image and album sales lies somewhere between 6.279 and 15.894</p>
<ul>
<li>the two best predictors have tight confidence intervals (airplay and adverts) indicating that the estimates are likely representative of the true population values</li>
<li>the interval for band image is much wider, but does not cross zero indicating this parameter is less representative of the population, but is still significant.</li>
</ul>
</section>
<section id="significance-tests" class="level3">
<h3 class="anchored" data-anchor-id="significance-tests">Significance tests</h3>
<p>The values in <code>statistic</code> are the values of <span class="math inline">\(t\)</span> associated with each <span class="math inline">\(\hat{b}\)</span> and <code>p.value</code> is the associated significance of the <span class="math inline">\(t\)</span>-statistic. For every predictor, the <span class="math inline">\(\hat{b}\)</span> is significantly different from 0 (<span class="math inline">\(p&lt;.001\)</span>) meaning that all predictors significantly predict album sales.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How might we interpret the statistic and p.value for the three predictors?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><del>The probability of the null hypothesis is less than 0.001 in all cases</del></li>
<li><del>The probability that each b is a chance result is less than 0.001</del></li>
<li>They tell us that the probability of getting a value of t at least as big as these values if the value of b were, in fact, zero is smaller than 0.001 for all predictors.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="math inline">\(p\)</span>-values
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many students and researchers think of <em>p</em>-values in terms of the â€˜probability of a chance resultâ€™ or â€˜the probability of a hypothesis being trueâ€™ but they are neither of these things. <u><strong>They are the long-run probability that you would get a test-statistic (in this case <em>t</em>) at least as large as the one you have if the null hypothesis were true.</strong></u> In other words, if there really were no relationship between advertising budget and album sales (the null hypothesis) then the population value of <em>b</em> would be zero.</p>
<p>Imagine we sampled from this null population and computed <em>t</em>, and then repeated this process 1000 times. Weâ€™d have 1000 values of <em>t</em> from a population in which there was no effect. We could plot these values as a histogram. This would tell us how often certain values of <em>t</em> occur. From it we could work out the probability of getting a particular value of <em>t</em>. If we then took another sample, and computed <em>t</em> (because weâ€™re kind of obsessed with this sort of thing) we would be able to compare this value of <em>t</em> to the distribution of all the previous 1000 samples. Is the <em>t</em> in our current sample large of small compared to the others? Letâ€™s say it was larger than 999 of the previous values. That would be quite an unlikely value of <em>t</em> whereas if it was larger than 500 of them this would not surprise us. <u><strong>This is what a <em>p</em>-value is: it is the long run probability of getting test statistic at least as large as the one you have if the null hypothesis were true.</strong></u> If the value is less than 0.05, people typically take this as supporting the idea that the null hypothesis isnâ€™t true.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Report
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>the model that included the bandâ€™s image and airplay was significantly better fit than the model that included advertising budget alone <span class="math inline">\(f(2, 196)=96.45, p&lt;0.001\)</span></li>
<li>the final model explained 66.5% of the variance in album sales</li>
<li>advertising budget significantly predicted album sales <span class="math inline">\(\hat{b}=0.08[0.07, 0.10], t(196)=12.26, p&gt;.001\)</span></li>
<li>airplay significantly predicted album sales <span class="math inline">\(\hat{b}=3.37[2.82, 3.92], t(196)=12.12, p&lt;.001\)</span></li>
<li>band image significantly predicted album sales -&gt; <span class="math inline">\(\hat{b}=11.09[6.28, 15.89], t=4.55, p&lt;.001\)</span></li>
</ul>
</div>
</div>
</section>
</section>
<section id="unguided-example" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example">Unguided Example</h2>
<section id="metal-and-mental-health" class="level3">
<h3 class="anchored" data-anchor-id="metal-and-mental-health">Metal and mental health</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>metal_tib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,506 Ã— 2
      hm suicide
   &lt;dbl&gt;   &lt;dbl&gt;
 1    10       7
 2    10      11
 3    10       8
 4     4      14
 5    10      13
 6     8      12
 7     8       7
 8     5      15
 9     8       7
10     9      10
# â„¹ 2,496 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggscatmat</span>(metal_tib, <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"hm"</span>, <span class="st">"suicide"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 200 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 284 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>metal_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(suicide <span class="sc">~</span> hm, <span class="at">data =</span> metal_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(metal_lm) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">4.842</td>
<td style="text-align: right;">304.784</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6401.851</td>
<td style="text-align: right;">12809.7</td>
<td style="text-align: right;">12826.7</td>
<td style="text-align: right;">50047.05</td>
<td style="text-align: right;">2135</td>
<td style="text-align: right;">2137</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(metal_lm, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   16.0      0.261       61.4 0          15.5      16.5  
2 hm            -0.612    0.0350     -17.5 6.64e-64   -0.680    -0.543</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance does the final model explain?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>12.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the nature of the relationship between listening to heavy metal and suicide risk?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>As love of heavy metal increases, suicide risk decreases</li>
<li>because the <span class="math inline">\(\hat{b}\)</span> value is negative (-.0612)</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As listening to heavy metal increases by 1 unit, by how much does suicide risk change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>-0.612 units</li>
</ul>
</div>
</div>
</div>
</section>
<section id="predicting-social-anxiety" class="level3">
<h3 class="anchored" data-anchor-id="predicting-social-anxiety">Predicting Social Anxiety</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>soc_anx_tib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 Ã— 4
    spai   iii   obq tosca
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    26 56.5   4.43  4.18
 2    51 16.1   2.03  4.20
 3    33 37.4   2.59  3.25
 4   106 16.7   4.84  4.07
 5    25  5.16  1.76  3.80
 6   109 36.0   2.13  4.25
 7    39 34.5   2.01  4.95
 8   134 18.0   1.76  4.52
 9    43 12.9   2.29  3.59
10    57  7.10  3.20  3.64
# â„¹ 124 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggscatmat</span>(soc_anx_tib, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"spai"</span>, <span class="st">"tosca"</span>))  <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>soc_anx_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(spai <span class="sc">~</span> tosca, <span class="at">data =</span> soc_anx_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(soc_anx_lm)  <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">29.918</td>
<td style="text-align: right;">14.989</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-644.525</td>
<td style="text-align: right;">1295.05</td>
<td style="text-align: right;">1303.743</td>
<td style="text-align: right;">118153.3</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">134</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(soc_anx_lm, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    -54.8     30.0      -1.82 0.0703     -114.       4.60
2 tosca           27.4      7.08      3.87 0.000169     13.4     41.4 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(spai <span class="sc">~</span> tosca <span class="sc">+</span> obq, <span class="at">data =</span> soc_anx_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(soc_anx_obq_lm)  <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">29.015</td>
<td style="text-align: right;">11.218</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-630.333</td>
<td style="text-align: right;">1268.666</td>
<td style="text-align: right;">1280.197</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">132</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(soc_anx_obq_lm, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 7
  term        estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -53.3      29.2      -1.82 0.0704   -111.        4.50
2 tosca          22.1       7.24      3.05 0.00276     7.77     36.4 
3 obq             7.25      2.91      2.49 0.0141      1.49     13.0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(soc_anx_obq_lm, <span class="at">standardize =</span> <span class="st">"refit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.160</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tosca</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">3.052</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">obq</td>
<td style="text-align: right;">0.213</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">2.489</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>anova(soc_anx_lm, soc_anx_obq_lm) |&gt;
broom::tidy()</code></pre>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error message
</div>
</div>
<div class="callout-body-container callout-body">
<p>Error in anova.lmlist(object, â€¦) : models were not all fitted to the same size of dataset</p>
<ul>
<li><p>as of this writing (Mar-04-24), there is a solution listed in the <code>discovr_08</code> tutorial to start by finding the error with <code>soc_anx_tib |&gt; dplyr::summarise( across(.fns = list(valid = ~sum(!is.na(.x)), missing = ~sum(is.na(.x))), .names = "{.col}_{.fn}") )</code></p>
<ul>
<li>The output from running this function in the tutorial is a table showing that there are missing values in <code>obq</code>. this means that <code>spai</code> and <code>tosca</code> have 134 values and <code>obq</code> has 132 values, so they are not the same size.</li>
</ul></li>
<li><p>However, the output above in my own .qmd file throws a <code>deprecated</code> error in <code>dplyr 1.1.4</code> that the use of <code>across</code> without <code>.cols</code> is deprecated since <code>dplyr 1.1.1</code></p></li>
<li><p>this means that I canâ€™t currently generate the table showing the sizes of the datasets with the code provided</p></li>
<li><p>the workaround to the problem is normally to use <code>multiple imputation</code> to estimate the missing values, which is beyond the scope of this tutorial, so Field recommends a <code>very bad practice</code>, which is to omit the missing values.</p></li>
<li><p>Iâ€™ve <a href="https://github.com/profandyfield/discovr/issues/17">filed an issue in the <code>discover.rocks</code> repo</a></p></li>
<li><p><a href="https://github.com/profandyfield/discovr/issues/17#issuecomment-1976799279">Fixâ€™t</a></p></li>
</ul>
</div>
</div>
<p>Here is the fixed code, adding <code>.cols = everything()</code>, and the intended output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>soc_anx_tib <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(), <span class="at">.fns =</span> <span class="fu">list</span>(<span class="at">valid =</span> <span class="sc">~</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(.x)), <span class="at">missing =</span> <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))), <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 8
  spai_valid spai_missing iii_valid iii_missing obq_valid obq_missing
       &lt;int&gt;        &lt;int&gt;     &lt;int&gt;       &lt;int&gt;     &lt;int&gt;       &lt;int&gt;
1        134            0       129           5       132           2
# â„¹ 2 more variables: tosca_valid &lt;int&gt;, tosca_missing &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>soc_anx_lm <span class="ot">&lt;-</span> soc_anx_tib <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>iii) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(spai <span class="sc">~</span> tosca, <span class="at">data =</span> _)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(soc_anx_lm, soc_anx_obq_lm) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">spai ~ tosca</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">113813.1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">spai ~ tosca + obq</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">108599.6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5213.423</td>
<td style="text-align: right;">6.193</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How much variance in social anxiety do OCD and shame account for?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>14.8%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The confidence interval for shame ranges from 7.77 to 36.42. What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 7.77 and 36.42.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As shame increases by 1 unit, by how much does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>22.10 units</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
As OCD increases by 1 standard deviation, by how many standard deviations does social anxiety change?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>0.213</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The p-value for OCD is 0.014, what does this mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The probability of getting a value of t at least as big as 2.49 if the value of b were, in fact, zero is 0.014. Iâ€™m going to assume, therefore, that b isnâ€™t zero (i.e.&nbsp;OCD significantly predicts social anxiety.)</p>
</div>
</div>
</div>
</section>
</section>
<section id="the-beast-of-bias" class="level2">
<h2 class="anchored" data-anchor-id="the-beast-of-bias">The Beast of Bias</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the most important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Linearity and additivity</p>
<p>This assumption is the most important because if it is not met then the phenomenon youâ€™re trying to model is not well represented by the model you are trying to fit</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which of these assumptions of the linear model is the least important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Normality of errors</p>
<p>This assumption is the least important because even with non-normal errors the parameter estimates (using ordinary least squares methods) of the model will be unbiased (they match the expected population value) and optimal (they minimize the squared error).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What does homoscedasticity mean?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The variance in errors from the (population) model is constant at all levels of the predictor variable(s)</p>
</div>
</div>
</div>
<section id="diagnostic-plots" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h3>
<p>Use <code>plot()</code> function</p>
<p><code>plot(my_model, which = numbers_of_the_plots_you_want)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(album_full_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>plot()</code> function can produce 6 plots (below) - default is to produce 1,2,3,5.</p>
<ol type="1">
<li>predicted values from the model (x-axis) against the residuals (y-axis). Use to look for linearity and homoscedasticity.</li>
<li>A Q-Q plot of standardised residuals to look for normality of residuals</li>
<li>predicted values from the model(x-axis) against the square root of the standardized residuals (y-axis). This is a variant of plot 1 and is used to look for linearity and homoscedasticity.</li>
<li>Case number (x-axis) against the Cooks distance (y-axis). This plot can help identify influential cases (large values of Cooks distance).</li>
<li>The leverage value for each case (x-axis) against the standardised residual (y-axis). Used to identify influential cases and outliers. Leverage values indicate the influence of an individual case on the model and are related to the Cooks distance.</li>
<li>The leverage value for each case (x-axis) against the corresponing Cooks distance (y-axis). Used to identify influential cases and outliers.</li>
</ol>
<p>To get plot #1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(album_full_lm, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To get plot #1 and #2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(album_full_lm, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To get all six, use <code>which = 1:6</code></p>
</div>
</div>
<p>Plots below show the patterns of dots we want (random = assumptions met)</p>
<ul>
<li>curvature indicates lack of linearity</li>
<li>funnel shape indicates heteroscedasticity</li>
<li>curvature and funnel shape indicate non-linearity and heteroscedasticity</li>
<li></li>
</ul>
<p><strong>Figure 2</strong> <img src="dsr2_fig_06_29_pred_resid.png" class="img-fluid" alt="Examples of residual plots from Field (2023)"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(album_full_lm, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If both assumptions of linearity and homoscedasticity are met, then these plots should look like a random array of dots and the red trend line should be flat.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparing the plot to those in Figure 2, how would you interpret it?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No problems. random array of dots, no funnels, no bananas.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(album_full_lm, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Based on the Q-Q plot, can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes, the dots line up along the diagonal, indicating a normal distribution.</p>
</div>
</div>
</div>
</section>
<section id="pretty-residual-plots" class="level3">
<h3 class="anchored" data-anchor-id="pretty-residual-plots">Pretty residual plots</h3>
<p>with <code>ggfortify</code>, we can use <code>ggplot2::autoplot()</code> to produce nicely formatted plots that are <code>ggplot2</code> objects, including themes</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using <code>GGfortify</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>for <code>autoplot()</code> function to work, the <code>ggfortify</code> package must be loaded. We canâ€™t use verbose code because <code>ggfortify</code> adds functionality to <code>ggplot2</code> rather than to itself. Need to include <code>library(ggfortify)</code> at the beginning of the document.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(album_full_lm,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour =</span> <span class="st">"#440154"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smooth.colour =</span> <span class="st">"#5ec962"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="influential-cases-and-outliers-plots" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-plots">Influential cases and outliers: plots</h2>
<ul>
<li>use Cookâ€™s distance to identify influential cases and</li>
<li>use standardized residuals to check for outliers</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>in an average sample,
<ul>
<li>95% of standardized residuals should lie between <span class="math inline">\(\pm1.96\)</span> and</li>
<li>99% should lie between <span class="math inline">\(\pm2.58\)</span>, and</li>
<li>any case for which absolute value of the standardized residual is 3 or more, is likely to be an outlier</li>
</ul></li>
<li>Cookâ€™s distance measure the influence of a single case on model as a whole.
<ul>
<li>absolute values greater than 1 may be cause for concern</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(album_full_lm,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour =</span> <span class="st">"#440154"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smooth.colour =</span> <span class="st">"#5ec962"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>First plot show Cookâ€™s distance and labels cases with largest values (1, 164, 169), but largest values are in the region of 0.06, well below the threshold of 1.</li>
<li>second shows leverage values plotted against standardized residuals
<ul>
<li>we want the green trend line to be flat and lie along zero, which is the case here</li>
<li>if the trend line deviates substantially from horizontal, then it indicates one of the assumptions of the model has been violated</li>
<li>this plot usually also has red dashed lines indicating values of Cookâ€™s distance of 0.5 and 1. this plot has none, indicating all values of Cookâ€™s distance are well below thresholds.</li>
</ul></li>
<li>Final plot shows leverage, Cookâ€™s distance, and the standardized residual on the same plot.
<ul>
<li>can be used to identify cases that have high leverage, high Cookâ€™s distance, large residual, or some combination of all three.</li>
<li>e.g.&nbsp;across the plots, case 164 has a standardized residual between -2.5 and -3 and the largest Cookâ€™s distance (although still only around 0.7)</li>
</ul></li>
</ul>
</section>
<section id="influential-cases-and-outliers-numbers" class="level2">
<h2 class="anchored" data-anchor-id="influential-cases-and-outliers-numbers">Influential cases and outliers: numbers</h2>
<p>For a more precise look, we can see values for Cookâ€™s distance and standardized residuals using <code>broom::augment()</code>. All we need to do is pass the lm object into the function and save the results as a new tibble. also useful to save the case number as a variable so that you can identify cases should you need to.</p>
<ul>
<li>create a new tibble called <code>album_full_rsd</code> (rsd for <code>residuals</code>) by
<ul>
<li>piping model into <code>broom::augment()</code> to get residuals, then</li>
<li>into <code>tibble::row_id_to_column()</code> to create a variable that contains the row number</li>
</ul></li>
<li>the <code>var = "case_no"</code> tells the function to name the variable containing the numbers <code>case_no</code></li>
<li>the result is a tibble called <code>album_full_rsd</code> that contains the case number, the original data to which the model was fitted, and various diagnostic statistics.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
De-bug: residuals when you have missing values
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have missing values in the data and used <code>na.action = na.exclude</code> when fitting the model, you must also tell <code>augment()</code> where to find the original data so it can map the residuals to the original cases.</p>
<p>In this case: <code>album_full_rsd &lt;- album_full_lm |&gt;    broom::augment(data = album_tib)</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>album_full_rsd <span class="ot">&lt;-</span> album_full_lm <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">"case_no"</span>) </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(album_full_rsd) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">glimpse</span>() <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ sales      &lt;dbl&gt; 330, 120, 360, 270, 220, 170
$ adverts    &lt;dbl&gt; 10.256, 985.685, 1445.563, 1188.193, 574.513, 568.954
$ airplay    &lt;dbl&gt; 43, 28, 35, 33, 44, 19
$ image      &lt;dbl&gt; 10, 7, 7, 7, 5, 5
$ .fitted    &lt;dbl&gt; 229.9203, 228.9490, 291.5576, 262.9760, 225.7529, 141.0954
$ .resid     &lt;dbl&gt; 100.079745, -108.948992, 68.442368, 7.024026, -5.752861, 28â€¦
$ .hat       &lt;dbl&gt; 0.047190526, 0.008006536, 0.020700427, 0.012560946, 0.02606â€¦
$ .sigma     &lt;dbl&gt; 46.63346, 46.55347, 46.94739, 47.20520, 47.20607, 47.16186
$ .cooksd    &lt;dbl&gt; 5.870388e-02, 1.088943e-02, 1.140066e-02, 7.166478e-05, 1.0â€¦
$ .std.resid &lt;dbl&gt; 2.1774041, -2.3230828, 1.4688016, 0.1501160, -0.1237983, 0.â€¦</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">sales</th>
<th style="text-align: right;">adverts</th>
<th style="text-align: right;">airplay</th>
<th style="text-align: right;">image</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">10.26</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">229.92</td>
<td style="text-align: right;">100.08</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">46.63</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">2.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">985.68</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">228.95</td>
<td style="text-align: right;">-108.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">46.55</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">1445.56</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">291.56</td>
<td style="text-align: right;">68.44</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">46.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">1188.19</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">262.98</td>
<td style="text-align: right;">7.02</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">574.51</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">225.75</td>
<td style="text-align: right;">-5.75</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">47.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">568.95</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">141.10</td>
<td style="text-align: right;">28.90</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">47.16</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.62</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Standardized residuals are in a variable called <code>.std.resid</code> and the Cookâ€™s distances in <code>.cooksd</code></p>
<p>to see what percentage of standardized residuals fall outside the limits of 1.96 (95%), 2-2.5 (99%) or above 3, we can filter the tibble using the <code>abs()</code> function to return the absolute value (ignoring the plus/minus signs) of the residual</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>album_full_rsd <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">1.96</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 Ã— 3
   case_no .std.resid .resid
     &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
 1     164      -2.63 -121. 
 2      47      -2.46 -115. 
 3      55      -2.46 -114. 
 4      68      -2.36 -110. 
 5       2      -2.32 -109. 
 6     200      -2.09  -97.2
 7     167      -2.00  -93.6
 8     100       2.10   97.3
 9      52       2.10   97.4
10      61       2.10   98.8
11      10       2.13   99.5
12       1       2.18  100. 
13     169       3.09  144. </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>album_full_rsd <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     164      -2.63  -121.
2     169       3.09   144.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>album_full_rsd <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">3.0</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     169       3.09   144.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>13/200 = 6.5%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>2/200 = 1%</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No, the appropriate proportion of cases have standardized residuals in the expected range and no case has a value grossly exceeding 3.</p>
</div>
</div>
</div>
<ul>
<li>Something similar with Cookâ€™s distanceâ€¦we can filter the tibble to look at cases with cooksd&gt;1, or sort the tibble in descending order using <code>arrange()</code></li>
<li>also use <code>select()</code> so we only see Cookâ€™s value and case numbers</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>album_full_rsd <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(.cooksd)) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .cooksd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 Ã— 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1     164  0.0708
 2       1  0.0587
 3     169  0.0509
 4      55  0.0404
 5      52  0.0332
 6     100  0.0314
 7     119  0.0308
 8      99  0.0281
 9     200  0.0251
10      47  0.0241
# â„¹ 190 more rows</code></pre>
</div>
</div>
<ul>
<li>no cooksd&gt;1 so no cases having undue influence on the model as a whole</li>
</ul>
</section>
<section id="robust-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="robust-linear-models">Robust linear models</h2>
<ul>
<li>model appears to be accurate for the sample and generalizable to the population</li>
<li>not always the case though</li>
<li>2 things to do
<ul>
<li>test whether the parameter estimates have been biased</li>
<li>check whether confidence intervals and significance tests have been biased</li>
</ul></li>
</ul>
<section id="robust-parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="robust-parameter-estimates">Robust parameter estimates</h3>
<ul>
<li>use <code>robust::lmRob()</code></li>
<li>used the same way as <code>lm()</code></li>
<li>replace <code>lm()</code> with <code>lmRob()</code></li>
<li>canâ€™t use any <code>broom</code> functions with <code>lmRob()</code>, so text output using <code>summary()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>album_full_rob <span class="ot">&lt;-</span> <span class="fu">lmRob</span>(sales <span class="sc">~</span> adverts <span class="sc">+</span> airplay <span class="sc">+</span> image, <span class="at">data =</span> album_tib, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(album_full_rob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmRob(formula = sales ~ adverts + airplay + image, data = album_tib, 
    na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-124.62  -30.47   -1.76   28.89  141.35 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -31.523201  21.098348  -1.494 0.136756    
adverts       0.085295   0.008501  10.033  &lt; 2e-16 ***
airplay       3.418749   0.339017  10.084  &lt; 2e-16 ***
image        11.771441   2.973559   3.959 0.000105 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44.61 on 196 degrees of freedom
Multiple R-Squared: 0.5785 

Test for Bias:
            statistic p-value
M-estimate      2.299  0.6809
LS-estimate     7.659  0.1049</code></pre>
</div>
</div>
<ul>
<li>bottom of output givessignificance tests of bias</li>
<li>significance tests need to be interpreted within the context of sample size, but these tests suggest that bias in the original model is not problematic
<ul>
<li><span class="math inline">\(p\)</span>-value is not significant</li>
</ul></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Original <span class="math inline">\(\hat{b}\)</span></th>
<th>Robust <span class="math inline">\(\hat{b}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adverts</td>
<td>0.085</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>Airplay</td>
<td>3.37</td>
<td>3.42</td>
</tr>
<tr class="odd">
<td>Image</td>
<td>11.09</td>
<td>11.77</td>
</tr>
</tbody>
</table>
<ul>
<li>estimates are virtually identical to the originals, suggesting the original model is unbiased</li>
</ul>
</section>
</section>
<section id="robust-confidence-intervals-and-significance-tests" class="level2">
<h2 class="anchored" data-anchor-id="robust-confidence-intervals-and-significance-tests">Robust Confidence Intervals and significance tests</h2>
<ul>
<li><p>to test whether confidence intervals and significance tests are biased, we can estimate the model with standard errors designed for heteroscedastic residuals</p></li>
<li><p>if the sample is small, use a bootstrap</p></li>
<li><p>both can be done by placing the model in the <code>parameters::model_parameters()</code> function</p></li>
<li><p>same function to standardize parameter estimates, but three new arguments</p></li>
<li><p>we can obtain models based on robust standard errors by setting <code>vcov = "method"</code> and replacing <code>method</code> with the name of the method we want to use to compute robust standard errors.</p></li>
<li><p><code>vcov = "HC3"</code> willuse HC3 method, though some think <code>HC4</code> is better</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(album_full_lm, <span class="at">vcov =</span> <span class="st">"HC4"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.242</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.645</td>
<td style="text-align: right;">5.419</td>
<td style="text-align: right;">-1.638</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">12.306</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.749</td>
<td style="text-align: right;">3.986</td>
<td style="text-align: right;">10.738</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.260</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.630</td>
<td style="text-align: right;">15.543</td>
<td style="text-align: right;">4.906</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(album_full_lm, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-26.613</td>
<td style="text-align: right;">16.170</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-58.503</td>
<td style="text-align: right;">5.277</td>
<td style="text-align: right;">-1.646</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">12.246</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.367</td>
<td style="text-align: right;">0.315</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.746</td>
<td style="text-align: right;">3.989</td>
<td style="text-align: right;">10.687</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">11.086</td>
<td style="text-align: right;">2.247</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.654</td>
<td style="text-align: right;">15.519</td>
<td style="text-align: right;">4.933</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Values are not much different from the non-robust versions, mainly becasue the original model didnâ€™t violate its assumptions</li>
<li>if a robust model yields the same-ish values as a non-robust model, we know the non-robust model has not been unduly biased.</li>
<li>if the robust estimates are hugely different, then use and report the robust versions</li>
<li>fitting a robust model is a win-win</li>
</ul>
<section id="small-samples" class="level3">
<h3 class="anchored" data-anchor-id="small-samples">Small samples</h3>
<ul>
<li>we might prefer to bootstrap confidence intervals by setting the bootstrap argument in <code>model_parameters()</code> to <code>TRUE</code></li>
<li>by default, 1000 bootstrap samples are used</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(album_full_lm, <span class="at">bootstrap =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-25.979</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-56.605</td>
<td style="text-align: right;">5.837</td>
<td style="text-align: right;">0.112</td>
</tr>
<tr class="even">
<td style="text-align: left;">adverts</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airplay</td>
<td style="text-align: right;">3.379</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.789</td>
<td style="text-align: right;">3.997</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">image</td>
<td style="text-align: right;">10.986</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">6.657</td>
<td style="text-align: right;">15.207</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>these bootstrapped confidence intervals donâ€™t rely on assumptions of normality or homoscedasticity, so they give an accurate estimate of the population value of <span class="math inline">\(b\)</span> for each predictor (assuming our sample is one of the 95% with confidence intervals that contain the population value)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because bootstrapping relies on random sampling from the data, you will get a slightly different estimate each time you bootstrap a model. This is normal.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping is a technique from which the sampling distribution of a statistic is estimated by â€¦
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Taking repeated samples (with replacement) from the data set.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The bootstrap confidence interval for image ranges from 6.63 to 15.45 (the values might not exactly match these). What does this tell us?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If this confidence interval is one of the 95% that contains the population value then the population value of b lies between 6.63 and 15.45.</p>
</div>
</div>
</div>
</section>
</section>
<section id="unguided-example-1" class="level2">
<h2 class="anchored" data-anchor-id="unguided-example-1">Unguided example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(soc_anx_obq_lm, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(soc_anx_obq_lm, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_rsd <span class="ot">&lt;-</span> soc_anx_obq_lm <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(<span class="at">data =</span> soc_anx_tib) <span class="sc">|&gt;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">"case_no"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(soc_anx_obq_rsd) <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">glimpse</span>() <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6
Columns: 11
$ case_no    &lt;int&gt; 1, 2, 3, 4, 5, 6
$ spai       &lt;dbl&gt; 26, 51, 33, 106, 25, 109
$ iii        &lt;dbl&gt; 56.45161, 16.12903, 37.41935, 16.67742, 5.16129, 36.03226
$ obq        &lt;dbl&gt; 4.425287, 2.034483, 2.586207, 4.839080, 1.758621, 2.126437
$ tosca      &lt;dbl&gt; 4.181818, 4.204545, 3.250000, 4.068182, 3.795455, 4.250000
$ .fitted    &lt;dbl&gt; 71.21490, 54.38582, 37.29426, 71.70370, 43.34703, 56.05675
$ .resid     &lt;dbl&gt; -45.214901, -3.385823, -4.294257, 34.296304, -18.347028, 52â€¦
$ .hat       &lt;dbl&gt; 0.03290194, 0.01449059, 0.06325813, 0.05273344, 0.02419968,â€¦
$ .sigma     &lt;dbl&gt; 28.84302, 29.12634, 29.12526, 28.96090, 29.08160, 28.74430
$ .cooksd    &lt;dbl&gt; 2.847631e-02, 6.772251e-05, 5.263717e-04, 2.737010e-02, 3.3â€¦
$ .std.resid &lt;dbl&gt; -1.5846267, -0.1175478, -0.1529180, 1.2144842, -0.6401266, â€¦</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">case_no</th>
<th style="text-align: right;">spai</th>
<th style="text-align: right;">iii</th>
<th style="text-align: right;">obq</th>
<th style="text-align: right;">tosca</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">56.45</td>
<td style="text-align: right;">4.43</td>
<td style="text-align: right;">4.18</td>
<td style="text-align: right;">71.21</td>
<td style="text-align: right;">-45.21</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">28.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-1.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">54.39</td>
<td style="text-align: right;">-3.39</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">37.42</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">37.29</td>
<td style="text-align: right;">-4.29</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">29.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">16.68</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">71.70</td>
<td style="text-align: right;">34.30</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">28.96</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">1.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">5.16</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">43.35</td>
<td style="text-align: right;">-18.35</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">29.08</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">36.03</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">4.25</td>
<td style="text-align: right;">56.06</td>
<td style="text-align: right;">52.94</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">28.74</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">1.84</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_rsd <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">1.96</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1      49      -2.26  -65.1
2      16      -2.13  -61.1
3     127      -1.98  -56.7
4     120       2.18   62.9
5       8       2.61   74.6
6      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_rsd <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  case_no .std.resid .resid
    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1       8       2.61   74.6
2      45       2.64   75.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_rsd <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="fl">3.0</span>) <span class="sc">|&gt;</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .std.resid, .resid) <span class="sc">|&gt;</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(.std.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 Ã— 3
# â„¹ 3 variables: case_no &lt;int&gt;, .std.resid &lt;dbl&gt;, .resid &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>soc_anx_obq_rsd <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(.cooksd)) <span class="sc">|&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(case_no, .cooksd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 Ã— 2
   case_no .cooksd
     &lt;int&gt;   &lt;dbl&gt;
 1       8  0.0724
 2      45  0.0497
 3      14  0.0397
 4      40  0.0373
 5      16  0.0330
 6      87  0.0304
 7     127  0.0289
 8       1  0.0285
 9       4  0.0274
10      12  0.0268
# â„¹ 124 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How would you interpret the plot of ZPRED vs ZRESID?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I canâ€™t see any problems</p>
<p>The dots look like a random, evenly-dispersed pattern. No funnel shapes, no banana shapes, so all is fine.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Can we assume normality of the residuals?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes The distribution is fairly normal: the dots in the P-P plot lie close to the diagonal.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 1.96?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>4.55% 6 cases from 132 have standardized residuals with absolute values greater than 1.96, and <span class="math inline">\(\frac{6}{132}Ã—100=4.55\)</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What percentage of cases have standardized residuals with absolute values greater than 2.5?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>1.51% 2 cases from 132 have standardized residuals with absolute values greater than 2.5, and <span class="math inline">\(\frac{2}{132}Ã—100=1.51\)</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
All things considered do you think there are outliers?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The appropriate proportion of cases have standardized residuals in the expected range and no case has a value exceeding 3.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are there any Cookâ€™s distances greater than 1?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No The fact there are no Cookâ€™s distances greater than 1 suggests that no cases are having undue influence on the model as a whole.</p>
</div>
</div>
</div>
</section>
<section id="bayesian-approaches" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-approaches">Bayesian Approaches</h2>
<ul>
<li>2 possible things to do
<ul>
<li>compare models using Bayes factors</li>
<li>estimate model parameters using Bayesian methods</li>
</ul></li>
</ul>
<section id="bayes-factors" class="level3">
<h3 class="anchored" data-anchor-id="bayes-factors">Bayes factors</h3>
<ul>
<li>compare models using a Bayes factor using <code>regressionBF()</code> funtion in the <code>BayesFactor</code> package</li>
<li>compare models against each other hierarchically to see which model has the largest Bayes factor, and to evaluate the strength of evidence that this Bayes factor suggests that a particular model predicts the outcome better than the intercept alone (i.e.&nbsp;a model with no predictors).</li>
</ul>
<p><code>model_bf &lt;- BayesFactor::regressionBF(formula, rscaleCont = "medium", data = tibble)</code></p>
<ul>
<li>creates an object called <code>model_bf</code> based onthe same type of formula we put in the <code>lm()</code> function to specify the model</li>
<li>the argument <code>rscaleCont</code> sets the scale of the prior distribution for the distribution for the standardized <span class="math inline">\(\hat{b}s\)</span> in the model.</li>
<li>arguemnt can be set as a numeric value or one of three pre-defined values</li>
<li>default value is <code>medium</code>, corresponding to a value of about <span class="math inline">\(\frac{\sqrt{2}}{4}\)</span>, or about 0.354</li>
<li>example uses the default to illustrate, but consider what value is appropriate for a given model</li>
</ul>
<p>Fitting the model with Bayes factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>album_bf <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">regressionBF</span>(sales <span class="sc">~</span> adverts <span class="sc">+</span> airplay <span class="sc">+</span> image, <span class="at">rscaleCont =</span> <span class="st">"medium"</span>, <span class="at">data =</span> album_tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>album_bf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts                   : 1.320123e+16 Â±0%
[2] airplay                   : 4.723817e+17 Â±0.01%
[3] image                     : 6039.289     Â±0%
[4] adverts + airplay         : 5.65038e+39  Â±0%
[5] adverts + image           : 2.65494e+20  Â±0%
[6] airplay + image           : 1.034464e+20 Â±0%
[7] adverts + airplay + image : 7.746101e+42 Â±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>Output shows Bayes factors for all potential models we can get from our predictor variables (7 in total)</li>
<li>each model is compared to a model that contains only the intercept</li>
<li>all models have huge Bayes factors suggesting they all provide strong evidence for the hypothesis that the model predicts the outcome better than the intercept alone</li>
<li>best model is the one with the largest Bayes factor, which is model 7, which includes all three predictors - it has a Bayes factor of <span class="math inline">\(7.75Ã—10^{42}\)</span></li>
</ul>
</section>
</section>
<section id="bayesian-parameter-estimates" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-parameter-estimates">Bayesian parameter estimates</h2>
<ul>
<li>knowing model is best ( we know this from the nonBayesian model) we can estimate the parameters using the <code>lmBF()</code> function</li>
<li>same format as <code>regressionBF()</code></li>
<li><code>lmBF()</code> fits only the model we specify</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>album_full_bf <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">lmBF</span>(sales <span class="sc">~</span> adverts <span class="sc">+</span> airplay <span class="sc">+</span> image, <span class="at">rscaleCont =</span> <span class="st">"medium"</span>, <span class="at">data =</span> album_tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data coerced from tibble to data frame</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>album_full_bf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] adverts + airplay + image : 7.746101e+42 Â±0%

Against denominator:
  Intercept only 
---
Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
</div>
<ul>
<li>same result in the previous output</li>
<li>but we can extract <span class="math inline">\(\hat{b}\)</span>-values derived from Bayesian estimaten and their credible intervals using the <code>posterior()</code> function
<ul>
<li>enter the name of the model we just created <code>album_full_bf</code> into â€™posterior()` function in which we also set the number of iterations to 10000</li>
<li>samples taken from the posterios distribution of the <code>album_full_bf</code> model and stored in an object called <code>album_full_post</code></li>
<li>place posterios samples into <code>summary()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>album_full_post <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">posterior</span>(album_full_bf, <span class="at">iterations =</span> <span class="dv">10000</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(album_full_post) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1:10000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

             Mean        SD  Naive SE Time-series SE
mu       193.2322 3.396e+00 3.396e-02      3.428e-02
adverts    0.0840 6.973e-03 6.973e-05      7.103e-05
airplay    3.3327 2.789e-01 2.789e-03      2.789e-03
image     10.9754 2.412e+00 2.412e-02      2.412e-02
sig2    2247.6232 2.299e+02 2.299e+00      2.408e+00
g          0.9925 1.688e+00 1.688e-02      1.716e-02

2. Quantiles for each variable:

             2.5%       25%       50%       75%     97.5%
mu      1.865e+02 1.910e+02  193.2424 1.955e+02 1.998e+02
adverts 7.046e-02 7.934e-02    0.0840 8.873e-02 9.771e-02
airplay 2.782e+00 3.148e+00    3.3360 3.517e+00 3.880e+00
image   6.294e+00 9.359e+00   10.9517 1.259e+01 1.572e+01
sig2    1.845e+03 2.086e+03 2233.1282 2.388e+03 2.747e+03
g       1.767e-01 3.703e-01    0.6016 1.052e+00 4.081e+00</code></pre>
</div>
</div>
<ul>
<li>Bayesian estimate of <span class="math inline">\(\hat{b}\)</span> can be found in the column labeled <code>Mean</code>
<ul>
<li>0.084 for adverts</li>
<li>3.34 for airplay</li>
<li>10.96 for image</li>
</ul></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Predictor</th>
<th>Bayesian estimate of <span class="math inline">\(\hat{b}\)</span></th>
<th>non-Bayesian estimate of <span class="math inline">\(\hat{b}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>adverts</td>
<td>0.084</td>
<td>0.085</td>
</tr>
<tr class="even">
<td>airplay</td>
<td>3.34</td>
<td>3.37</td>
</tr>
<tr class="odd">
<td>image</td>
<td>10.96</td>
<td>11.09</td>
</tr>
</tbody>
</table>
<ul>
<li>most useful are the <code>credible intervals</code> for these parameters
<ul>
<li>if we want the 95% credible interval, then we read the values from columns labelled 2.5% and 97.5% in the table of quantiles</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unlike confidence intervals, credible intervals contain the population value with a probability of 0.95 (95%)</p>
</div>
</div>
<ul>
<li><p>there is a 95% probability that the population value of <span class="math inline">\(\hat{b}\)</span> lies between | Predictor | 2.5% | 97.5% | | â€” | â€” | â€” | | adverts | 0.07 | 0.097 | | airplay | 2.78 | 3.87 | | image |6.26 | 15.86 |</p></li>
<li><p>these intervals are constructed assuming that an effect exists, so you cannot use them to test the hypothesis that the null is exactly 0, only to establish plausible population values of the <span class="math inline">\(b\)</span>s in the model.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/cmadland\.github\.io\/blog");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>