<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Colin Madland">
<meta name="dcterms.date" content="2024-02-18">

<title>Simple Regression – Learning | Assessment | Technology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-79bb3942e891885f9f7af119cd221462.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-99e42d58961487636930fdd71fdb3421.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Learning | Assessment | Technology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cmadland/blog"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/cmad.land"> <i class="bi bi-bluesky" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Simple Regression</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">505</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Colin Madland </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 18, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="regression-equation">Regression Equation</h2>
<p>Linear regression expresses the relationship between two variables, <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span>.</p>
<p>The <span class="math inline">\(_i\)</span> refers to the cases in the dataset, so if there are 1000 cases, then <span class="math inline">\(_i\)</span> is 1-1000. Each <span class="math inline">\(_i\)</span> refers to a ‘student’.</p>
<p><span class="math display">\[Y_i=b_0+{b_1}{X_i}+\epsilon_i\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(b_1\)</span> is the slope or regression coefficient (how much <span class="math inline">\(Y\)</span> will change when <span class="math inline">\(X\)</span> increases by 1)<br>
</li>
<li><span class="math inline">\(b_0\)</span> is the <span class="math inline">\(Y\)</span>-intercept, where the regression line crosses the <span class="math inline">\(Y\)</span> axis</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term</li>
</ul>
<p>or</p>
<p><span class="math display">\[\hat{Y}=b_0+{b_1}{X_i}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{Y}\)</span> is the predicted value of <span class="math inline">\(Y\)</span></li>
</ul>
<p>Notes:</p>
<p>Larger values of <span class="math inline">\(b_1\)</span> indicate a steeper regression line</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="slope.png" class="img-fluid figure-img"></p>
<figcaption>examples of slope and intercept</figcaption>
</figure>
</div>
<ul>
<li>left image, red is positive slope and green is negative slope (negative correlation; when predictor increases, outcome decreases)</li>
<li>right image, all slopes positive</li>
</ul>
</section>
<section id="calculating-regression" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression">Calculating Regression</h2>
<ul>
<li>any dataset is made up of points, and regression finds the best fitting straight line for the dataset</li>
</ul>
</section>
<section id="best-fit" class="level2">
<h2 class="anchored" data-anchor-id="best-fit">Best Fit</h2>
<ul>
<li>need to define mathematically the distance between each data point and the regression line<br>
</li>
<li>for every <span class="math inline">\(X\)</span> value in the data, the linear equation can determine the <span class="math inline">\(Y\)</span> value on the line - called <strong>predicted <span class="math inline">\(Y\)</span></strong>, or <span class="math inline">\(\hat{Y}\)</span></li>
<li>this distance measures the error between the line and the data</li>
<li>if all data points were on the line, then the line ‘fits’ the data perfectly</li>
<li><span class="math inline">\(\hat{Y}\)</span> should be close to actual <span class="math inline">\(Y\)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="predicted.png" class="img-fluid figure-img"></p>
<figcaption>graph showing the difference between predicted and actual values of <span class="math inline">\(Y\)</span></figcaption>
</figure>
</div>
<ul>
<li>green dots = <span class="math inline">\(\hat{Y}\)</span></li>
<li>blue dots = <span class="math inline">\(Y\)</span></li>
<li>distance between the green and blue dots is the prediction error - need to minimize</li>
<li>some are positive (above the line) and some are negative (below the line)<br>
</li>
<li>since some are positive and some are negative, if we want to add the error values together, we need to get rid of the signs by squaring the distance and adding the squared error</li>
</ul>
<p><span class="math display">\[total \space squared \space error ={\sum^n_{i=1}}({Y_i}-{\hat{Y_i}})^2\]</span></p>
<ul>
<li>for each poissible line, we can calculate the total squared error, then choose the line with the lowest total squared error, which is the regression line</li>
<li>this minimizes the difference between the line and the observed data</li>
<li>this line is called the <em>least squared error</em> solution</li>
<li>this method is inefficient due to the infinite number of lines possible</li>
<li>calculus is a mathematical technique to find the maxima or minima of a mathematical expression.</li>
<li>Using this method, the regression coefficients (slope (<span class="math inline">\(b_1\)</span>) and intercept (<span class="math inline">\(b_0\)</span>)) that produce the minimum errors can be calculated.</li>
</ul>
</section>
<section id="calculating-regression-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="calculating-regression-coefficients">Calculating Regression Coefficients</h2>
<p><span class="math display">\[\hat{Y}_i=b_0+b_1X_i\]</span></p>
<p><span class="math display">\[\hat{b_1}=r\frac{S_Y}{S_X}\]</span></p>
<p><span class="math display">\[\hat{b_0}=M_Y-\hat{b_1}M_x\]</span></p>
<p>Where</p>
<p><span class="math inline">\(r\)</span> is the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span><br>
<span class="math inline">\(S_X\)</span> and <span class="math inline">\(S_Y\)</span> are sample standard deviations for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span><br>
<span class="math inline">\(M_X\)</span> and <span class="math inline">\(M_Y\)</span> are sample means for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p>
<p>These are <em>raw regression coefficients</em> (<span class="math inline">\(b_1\)</span>): the change in outcome is associated with a change in the predictor</p>
<section id="standardized-regression-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="standardized-regression-coefficients">Standardized regression coefficients</h3>
<ul>
<li>tell us the same thing, except expressed as standard deviations</li>
<li>if both variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have been standardized by transforming tehm into <em>Z-scores</em> before calculating the regression coefficients, then the regression coefficients become *standardized coefficients</li>
</ul>
<p><span class="math display">\[\hat{Z_{Y_i}}=\beta{Z_{X_i}}\]</span></p>
<p><span class="math display">\[\beta=r\]</span></p>
<p>Where</p>
<p><span class="math inline">\(\hat{Z_{Y_i}}\)</span> is the standard deviation of <span class="math inline">\(Y\)</span><br>
<span class="math inline">\(\hat{Z_{X_i}}\)</span> is the styandard deviation of <span class="math inline">\(X\)</span><br>
<span class="math inline">\(\beta\)</span> is the correlation coefficient</p>
<p>Standardizing <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> puts the variables on the same scale - when <span class="math inline">\(X\)</span> increases by 1SD, <span class="math inline">\(Y\)</span> increases by 1SD</p>
</section>
</section>
<section id="analysis-of-regression" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-regression">Analysis of regression</h2>
<ul>
<li>regression line is only a model based on the data</li>
<li>process of testing the significance of a regression equation is called <em>analysis of regression</em></li>
<li>null hypothesis in the analysis of regression states that the equation does not account for a significant proportion of the variance in <span class="math inline">\(Y\)</span> scores</li>
<li>analysis of regression is similar to ANOVA</li>
</ul>
<p><img src="anoreg.png" class="img-fluid"></p>
<p>Sum Square Total (<span class="math inline">\(SS_T\)</span> (left plot)) is <span class="math inline">\(\sum(Y-\bar{Y})^2\)</span></p>
<p>Sum Square Residual (<span class="math inline">\(SS_R\)</span> (right plot)) is <span class="math inline">\(\sum(Y-\hat{Y})^2\)</span></p>
<ul>
<li>prediction error - squared distance between the data and the regression line</li>
<li>needs to be minimized</li>
<li>this is the variability that is not explained by the regression equation</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ssm.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Sum Square model (<span class="math inline">\(SS_M\)</span>) is <span class="math inline">\(\sum(\hat{Y}-\bar{Y})^2\)</span></p>
<ul>
<li><p>in this equation, <span class="math inline">\(\hat{Y}=b_0+b_1X\)</span></p></li>
<li><p><span class="math inline">\(SS_T\)</span>: total variability is the variability between the scores and the mean<br>
</p></li>
<li><p><span class="math inline">\(SS_R\)</span>: sum squared residual is the residual or error variability between the regression model and the data<br>
</p></li>
<li><p><span class="math inline">\(SS_M\)</span> or sum square regression: Model variability - difference in variability between the model and the mean.<span class="math inline">\(Y\)</span> are determined by the value of <span class="math inline">\(X\)</span><br>
</p></li>
<li><p><span class="math inline">\(SS_T\)</span> is the sum of <span class="math inline">\(SS_R\)</span> and <span class="math inline">\(SS_M\)</span></p>
<ul>
<li>part of the variability is residual - we don’t know what is causing<br>
</li>
<li>part of it is due to the model - the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span></li>
</ul></li>
</ul>
<p>The proportion of variability in <span class="math inline">\(Y\)</span> that is predicted by its relationship with <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[\frac{SS_{regression}}{SS_T}=r^2\]</span></p>
<p><span class="math inline">\(r^2\)</span> is an effect size that tells us the proportion of variability that is accounted for by the model</p>
<p>The proportion of the variability that is not accounted for is</p>
<p><span class="math display">\[\frac{SS_{residual}}{SS_T}=1-r^2\]</span></p>
<p><span class="math inline">\(r^2\)</span> is very mieaningful</p>
<p>if <span class="math inline">\(R^2\)</span> is 20%, then the amount of the variability in <span class="math inline">\(Y\)</span> that is accounted for by the model is 20%, which is quite large.</p>
<p>Therefore</p>
<p><span class="math display">\[SS_{regression}=r^2SS_T\]</span></p>
<p><span class="math display">\[SS_{residual}=(1-r^2)SS_Y\]</span></p>
<p><span class="math inline">\(SS_Y\)</span> is the same thing as <span class="math inline">\(SS_T\)</span></p>
<p><span class="math inline">\(r^2\)</span> is the Pearson Correlation Coefficient squared</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="components.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>Total variability is partitioned into two - sum squared regression (explained by the model) and sum squared residual (not explained by the model).</p>
<p>Same for degrees of freedom</p>
<p>Sums of squares are total values and can be expressed as averages called <em>Mean Squares</em>, or <span class="math inline">\(MS\)</span> AKA <em>variance</em></p>
<p><span class="math display">\[MS_{regression}=\frac{SS_{regression}}{df_{regression}}\]</span></p>
<ul>
<li>mean square variance is the variance accounted for in the model</li>
</ul>
<p><span class="math display">\[MS_{residual}=\frac{SS_{residual}}{df_{residual}}\]</span></p>
<ul>
<li>mean square residual is the variance not accounted for in the model</li>
</ul>
<p>An <span class="math inline">\(F\)</span>-ratio can be used to compare these two mean squares</p>
<p><span class="math display">\[F=\frac{MS_{regression}}{MS_{residual}} \text{with}\: df=1,n-2\]</span></p>
<ul>
<li>if the mean square regression is small compared to the mean square residual, then the model does not account for much variance<br>
</li>
<li>if the mean square regression is larger than the mean square residual, then the model accounts for more variance</li>
</ul>
</section>
<section id="an-example-fields" class="level2">
<h2 class="anchored" data-anchor-id="an-example-fields">An Example (Fields)</h2>
<ul>
<li>record company boss interested in predicting album sales from advertising bsed on 200 different album releases<br>
</li>
<li>outcome variable: sales of CDs and downloads in the week after release<br>
</li>
<li>predictor variable: amount in GBP spent promoting the album before release</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="album-sales.png" class="img-fluid figure-img"></p>
<figcaption>scatterplot of album sales by advertising budget</figcaption>
</figure>
</div>
<p><span class="math inline">\(r^2\)</span> = 0.335, so 33.5% of the variability is shared by both variables (cutoffs, 9% - small, 25% - large effect size)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="model-summary.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="anova.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="coefficients.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
</section>
<section id="activities" class="level2">
<h2 class="anchored" data-anchor-id="activities">Activities</h2>
<p>In a survey that included assessment of husband and wife heights, Hodges, Krech and Crutchfield (1975) reported the following results. Let’s treat wife height as the predictor (X) variable and husband as the outcome (Y) variable:<br>
<span class="math inline">\(r_XY\)</span> = .32, <span class="math inline">\(N\)</span> = 1, 296<br>
Wife height: <span class="math inline">\(M_X\)</span> = 64.42, <span class="math inline">\(S_X\)</span> = 2.56<br>
Husband height: <span class="math inline">\(M_Y\)</span> = 70.46, <span class="math inline">\(S_Y\)</span> = 2.87<br>
a. Calculates the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to predict husband height in inches (Y) from wife height in inches (X), and write out this raw score predictive equation</p>
<p><span class="math display">\[\hat{b_1}=r\frac{S_Y}{S_X}\]</span></p>
<p><span class="math display">\[\hat{b_1}=.32\frac{2.87}{2.56}\]</span></p>
<p><span class="math display">\[\hat{b_1}=0.35\]</span></p>
<p><span class="math display">\[b_0=M_Y-\hat{b_1}M_X\]</span></p>
<p><span class="math display">\[b_0=70.46-(0.35*64.42)\]</span></p>
<p><span class="math display">\[b_0=70.46-22.54\]</span></p>
<p><span class="math display">\[b_0=47.91\]</span></p>
<p>Predictive Equation <span class="math display">\[\hat{Y}=b_0+{b_1}{X_i}\]</span> <span class="math display">\[\hat{Y}=47.91+(0.35*{X_i})\]</span></p>
<ol start="2" type="a">
<li>For women: what is your own height? Substitute your own height into the equation from step a, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><span class="math display">\[\hat{Y}=47.91+(0.35*67)\]</span></p>
<p><span class="math display">\[\hat{Y}=71.36\]</span></p>
<ol start="3" type="a">
<li>Now reverse the roles of the variables (i.e., use husband height as the predictor and wife height as the outcome variable). Calculates the values of bb0 and bb1.</li>
</ol>
<p><span class="math display">\[\hat{b_1}=r\frac{S_Y}{S_X}\]</span></p>
<p><span class="math display">\[\hat{b_1}=.32\frac{2.56}{2.87}\]</span></p>
<p><span class="math display">\[\hat{b_1}=.32*.89\]</span></p>
<p><span class="math display">\[\hat{b_1}=.28\]</span></p>
<p><span class="math display">\[b_0=M_Y-\hat{b_1}M_X\]</span></p>
<p><span class="math display">\[b_0=64.42-(0.28*70.46)\]</span></p>
<p><span class="math display">\[b_0=64.42-19.72\]</span></p>
<p><span class="math display">\[b_0=44.7\]</span></p>
<p><span class="math display">\[\hat{Y}=44.7+(0.28*{X_i})\]</span></p>
<ol start="4" type="a">
<li>For men: what is your height in inches? Substitute your own height into the equation from step c, and calculate the predicted height of your present or future spouse.</li>
</ol>
<p><span class="math display">\[\hat{Y}=44.7+(0.28*70)\]</span></p>
<p><span class="math display">\[\hat{Y}=64.3\]</span></p>
<ol start="5" type="a">
<li>What proportion of variance in husband height is predictable from wife height? Test the significance of the regression equation.</li>
</ol>
<p><span class="math display">\[r^2=.10\]</span></p>
<ol start="6" type="a">
<li>If both X and Y have been standardized by transforming into Z scores before calculating the regression coefficients, what would be the values of bb0 and bb1 to predict husband height in inches (Y) from wife height in inches (X)? How does this standardized version of the prediction equation tell us about “regression toward the mean” for predictions?</li>
</ol>
<p><span class="math display">\[\hat{Z_{Y_i}}=\beta{Z_{X_i}}\]</span></p>
<p><span class="math display">\[\hat{2.87}=0.32{2.56}\]</span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/cmadland\.github\.io\/blog");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>